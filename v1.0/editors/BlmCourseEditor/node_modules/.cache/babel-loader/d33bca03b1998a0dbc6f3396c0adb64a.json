{"ast":null,"code":"import { Matrix4, Object3D, Quaternion, Vector3 } from 'three';\n/**\n * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\n */\n\nconst _position = new Vector3();\n\nconst _quaternion = new Quaternion();\n\nconst _scale = new Vector3();\n\nclass CSS3DObject extends Object3D {\n  constructor(element = document.createElement('div')) {\n    super();\n    this.isCSS3DObject = true;\n    this.element = element;\n    this.element.style.position = 'absolute';\n    this.element.style.pointerEvents = 'auto';\n    this.element.style.userSelect = 'none';\n    this.element.setAttribute('draggable', false);\n    this.addEventListener('removed', function () {\n      this.traverse(function (object) {\n        if (object.element instanceof Element && object.element.parentNode !== null) {\n          object.element.parentNode.removeChild(object.element);\n        }\n      });\n    });\n  }\n\n  copy(source, recursive) {\n    super.copy(source, recursive);\n    this.element = source.element.cloneNode(true);\n    return this;\n  }\n\n}\n\nclass CSS3DSprite extends CSS3DObject {\n  constructor(element) {\n    super(element);\n    this.isCSS3DSprite = true;\n    this.rotation2D = 0;\n  }\n\n  copy(source, recursive) {\n    super.copy(source, recursive);\n    this.rotation2D = source.rotation2D;\n    return this;\n  }\n\n} //\n\n\nconst _matrix = new Matrix4();\n\nconst _matrix2 = new Matrix4();\n\nclass CSS3DRenderer {\n  constructor(parameters = {}) {\n    const _this = this;\n\n    let _width, _height;\n\n    let _widthHalf, _heightHalf;\n\n    const cache = {\n      camera: {\n        fov: 0,\n        style: ''\n      },\n      objects: new WeakMap()\n    };\n    const domElement = parameters.element !== undefined ? parameters.element : document.createElement('div');\n    domElement.style.overflow = 'hidden';\n    this.domElement = domElement;\n    const cameraElement = document.createElement('div');\n    cameraElement.style.transformStyle = 'preserve-3d';\n    cameraElement.style.pointerEvents = 'none';\n    domElement.appendChild(cameraElement);\n\n    this.getSize = function () {\n      return {\n        width: _width,\n        height: _height\n      };\n    };\n\n    this.render = function (scene, camera) {\n      const fov = camera.projectionMatrix.elements[5] * _heightHalf;\n\n      if (cache.camera.fov !== fov) {\n        domElement.style.perspective = camera.isPerspectiveCamera ? fov + 'px' : '';\n        cache.camera.fov = fov;\n      }\n\n      if (scene.matrixWorldAutoUpdate === true) scene.updateMatrixWorld();\n      if (camera.parent === null && camera.matrixWorldAutoUpdate === true) camera.updateMatrixWorld();\n      let tx, ty;\n\n      if (camera.isOrthographicCamera) {\n        tx = -(camera.right + camera.left) / 2;\n        ty = (camera.top + camera.bottom) / 2;\n      }\n\n      const cameraCSSMatrix = camera.isOrthographicCamera ? 'scale(' + fov + ')' + 'translate(' + epsilon(tx) + 'px,' + epsilon(ty) + 'px)' + getCameraCSSMatrix(camera.matrixWorldInverse) : 'translateZ(' + fov + 'px)' + getCameraCSSMatrix(camera.matrixWorldInverse);\n      const style = cameraCSSMatrix + 'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)';\n\n      if (cache.camera.style !== style) {\n        cameraElement.style.transform = style;\n        cache.camera.style = style;\n      }\n\n      renderObject(scene, scene, camera, cameraCSSMatrix);\n    };\n\n    this.setSize = function (width, height) {\n      _width = width;\n      _height = height;\n      _widthHalf = _width / 2;\n      _heightHalf = _height / 2;\n      domElement.style.width = width + 'px';\n      domElement.style.height = height + 'px';\n      cameraElement.style.width = width + 'px';\n      cameraElement.style.height = height + 'px';\n    };\n\n    function epsilon(value) {\n      return Math.abs(value) < 1e-10 ? 0 : value;\n    }\n\n    function getCameraCSSMatrix(matrix) {\n      const elements = matrix.elements;\n      return 'matrix3d(' + epsilon(elements[0]) + ',' + epsilon(-elements[1]) + ',' + epsilon(elements[2]) + ',' + epsilon(elements[3]) + ',' + epsilon(elements[4]) + ',' + epsilon(-elements[5]) + ',' + epsilon(elements[6]) + ',' + epsilon(elements[7]) + ',' + epsilon(elements[8]) + ',' + epsilon(-elements[9]) + ',' + epsilon(elements[10]) + ',' + epsilon(elements[11]) + ',' + epsilon(elements[12]) + ',' + epsilon(-elements[13]) + ',' + epsilon(elements[14]) + ',' + epsilon(elements[15]) + ')';\n    }\n\n    function getObjectCSSMatrix(matrix) {\n      const elements = matrix.elements;\n      const matrix3d = 'matrix3d(' + epsilon(elements[0]) + ',' + epsilon(elements[1]) + ',' + epsilon(elements[2]) + ',' + epsilon(elements[3]) + ',' + epsilon(-elements[4]) + ',' + epsilon(-elements[5]) + ',' + epsilon(-elements[6]) + ',' + epsilon(-elements[7]) + ',' + epsilon(elements[8]) + ',' + epsilon(elements[9]) + ',' + epsilon(elements[10]) + ',' + epsilon(elements[11]) + ',' + epsilon(elements[12]) + ',' + epsilon(elements[13]) + ',' + epsilon(elements[14]) + ',' + epsilon(elements[15]) + ')';\n      return 'translate(-50%,-50%)' + matrix3d;\n    }\n\n    function renderObject(object, scene, camera, cameraCSSMatrix) {\n      if (object.isCSS3DObject) {\n        const visible = object.visible === true && object.layers.test(camera.layers) === true;\n        object.element.style.display = visible === true ? '' : 'none';\n\n        if (visible === true) {\n          object.onBeforeRender(_this, scene, camera);\n          let style;\n\n          if (object.isCSS3DSprite) {\n            // http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\n            _matrix.copy(camera.matrixWorldInverse);\n\n            _matrix.transpose();\n\n            if (object.rotation2D !== 0) _matrix.multiply(_matrix2.makeRotationZ(object.rotation2D));\n            object.matrixWorld.decompose(_position, _quaternion, _scale);\n\n            _matrix.setPosition(_position);\n\n            _matrix.scale(_scale);\n\n            _matrix.elements[3] = 0;\n            _matrix.elements[7] = 0;\n            _matrix.elements[11] = 0;\n            _matrix.elements[15] = 1;\n            style = getObjectCSSMatrix(_matrix);\n          } else {\n            style = getObjectCSSMatrix(object.matrixWorld);\n          }\n\n          const element = object.element;\n          const cachedObject = cache.objects.get(object);\n\n          if (cachedObject === undefined || cachedObject.style !== style) {\n            element.style.transform = style;\n            const objectData = {\n              style: style\n            };\n            cache.objects.set(object, objectData);\n          }\n\n          if (element.parentNode !== cameraElement) {\n            cameraElement.appendChild(element);\n          }\n\n          object.onAfterRender(_this, scene, camera);\n        }\n      }\n\n      for (let i = 0, l = object.children.length; i < l; i++) {\n        renderObject(object.children[i], scene, camera, cameraCSSMatrix);\n      }\n    }\n  }\n\n}\n\nexport { CSS3DObject, CSS3DSprite, CSS3DRenderer };","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/node_modules/three/examples/jsm/renderers/CSS3DRenderer.js"],"names":["Matrix4","Object3D","Quaternion","Vector3","_position","_quaternion","_scale","CSS3DObject","constructor","element","document","createElement","isCSS3DObject","style","position","pointerEvents","userSelect","setAttribute","addEventListener","traverse","object","Element","parentNode","removeChild","copy","source","recursive","cloneNode","CSS3DSprite","isCSS3DSprite","rotation2D","_matrix","_matrix2","CSS3DRenderer","parameters","_this","_width","_height","_widthHalf","_heightHalf","cache","camera","fov","objects","WeakMap","domElement","undefined","overflow","cameraElement","transformStyle","appendChild","getSize","width","height","render","scene","projectionMatrix","elements","perspective","isPerspectiveCamera","matrixWorldAutoUpdate","updateMatrixWorld","parent","tx","ty","isOrthographicCamera","right","left","top","bottom","cameraCSSMatrix","epsilon","getCameraCSSMatrix","matrixWorldInverse","transform","renderObject","setSize","value","Math","abs","matrix","getObjectCSSMatrix","matrix3d","visible","layers","test","display","onBeforeRender","transpose","multiply","makeRotationZ","matrixWorld","decompose","setPosition","scale","cachedObject","get","objectData","set","onAfterRender","i","l","children","length"],"mappings":"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","sourcesContent":["import {\n\tMatrix4,\n\tObject3D,\n\tQuaternion,\n\tVector3\n} from 'three';\n\n/**\n * Based on http://www.emagix.net/academic/mscs-project/item/camera-sync-with-css3-and-webgl-threejs\n */\n\nconst _position = new Vector3();\nconst _quaternion = new Quaternion();\nconst _scale = new Vector3();\n\nclass CSS3DObject extends Object3D {\n\n\tconstructor( element = document.createElement( 'div' ) ) {\n\n\t\tsuper();\n\n\t\tthis.isCSS3DObject = true;\n\n\t\tthis.element = element;\n\t\tthis.element.style.position = 'absolute';\n\t\tthis.element.style.pointerEvents = 'auto';\n\t\tthis.element.style.userSelect = 'none';\n\n\t\tthis.element.setAttribute( 'draggable', false );\n\n\t\tthis.addEventListener( 'removed', function () {\n\n\t\t\tthis.traverse( function ( object ) {\n\n\t\t\t\tif ( object.element instanceof Element && object.element.parentNode !== null ) {\n\n\t\t\t\t\tobject.element.parentNode.removeChild( object.element );\n\n\t\t\t\t}\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.element = source.element.cloneNode( true );\n\n\t\treturn this;\n\n\t}\n\n}\n\nclass CSS3DSprite extends CSS3DObject {\n\n\tconstructor( element ) {\n\n\t\tsuper( element );\n\n\t\tthis.isCSS3DSprite = true;\n\n\t\tthis.rotation2D = 0;\n\n\t}\n\n\tcopy( source, recursive ) {\n\n\t\tsuper.copy( source, recursive );\n\n\t\tthis.rotation2D = source.rotation2D;\n\n\t\treturn this;\n\n\t}\n\n}\n\n//\n\nconst _matrix = new Matrix4();\nconst _matrix2 = new Matrix4();\n\nclass CSS3DRenderer {\n\n\tconstructor( parameters = {} ) {\n\n\t\tconst _this = this;\n\n\t\tlet _width, _height;\n\t\tlet _widthHalf, _heightHalf;\n\n\t\tconst cache = {\n\t\t\tcamera: { fov: 0, style: '' },\n\t\t\tobjects: new WeakMap()\n\t\t};\n\n\t\tconst domElement = parameters.element !== undefined ? parameters.element : document.createElement( 'div' );\n\n\t\tdomElement.style.overflow = 'hidden';\n\n\t\tthis.domElement = domElement;\n\n\t\tconst cameraElement = document.createElement( 'div' );\n\n\t\tcameraElement.style.transformStyle = 'preserve-3d';\n\t\tcameraElement.style.pointerEvents = 'none';\n\n\t\tdomElement.appendChild( cameraElement );\n\n\t\tthis.getSize = function () {\n\n\t\t\treturn {\n\t\t\t\twidth: _width,\n\t\t\t\theight: _height\n\t\t\t};\n\n\t\t};\n\n\t\tthis.render = function ( scene, camera ) {\n\n\t\t\tconst fov = camera.projectionMatrix.elements[ 5 ] * _heightHalf;\n\n\t\t\tif ( cache.camera.fov !== fov ) {\n\n\t\t\t\tdomElement.style.perspective = camera.isPerspectiveCamera ? fov + 'px' : '';\n\t\t\t\tcache.camera.fov = fov;\n\n\t\t\t}\n\n\t\t\tif ( scene.matrixWorldAutoUpdate === true ) scene.updateMatrixWorld();\n\t\t\tif ( camera.parent === null && camera.matrixWorldAutoUpdate === true ) camera.updateMatrixWorld();\n\n\t\t\tlet tx, ty;\n\n\t\t\tif ( camera.isOrthographicCamera ) {\n\n\t\t\t\ttx = - ( camera.right + camera.left ) / 2;\n\t\t\t\tty = ( camera.top + camera.bottom ) / 2;\n\n\t\t\t}\n\n\t\t\tconst cameraCSSMatrix = camera.isOrthographicCamera ?\n\t\t\t\t'scale(' + fov + ')' + 'translate(' + epsilon( tx ) + 'px,' + epsilon( ty ) + 'px)' + getCameraCSSMatrix( camera.matrixWorldInverse ) :\n\t\t\t\t'translateZ(' + fov + 'px)' + getCameraCSSMatrix( camera.matrixWorldInverse );\n\n\t\t\tconst style = cameraCSSMatrix +\n\t\t\t\t'translate(' + _widthHalf + 'px,' + _heightHalf + 'px)';\n\n\t\t\tif ( cache.camera.style !== style ) {\n\n\t\t\t\tcameraElement.style.transform = style;\n\n\t\t\t\tcache.camera.style = style;\n\n\t\t\t}\n\n\t\t\trenderObject( scene, scene, camera, cameraCSSMatrix );\n\n\t\t};\n\n\t\tthis.setSize = function ( width, height ) {\n\n\t\t\t_width = width;\n\t\t\t_height = height;\n\t\t\t_widthHalf = _width / 2;\n\t\t\t_heightHalf = _height / 2;\n\n\t\t\tdomElement.style.width = width + 'px';\n\t\t\tdomElement.style.height = height + 'px';\n\n\t\t\tcameraElement.style.width = width + 'px';\n\t\t\tcameraElement.style.height = height + 'px';\n\n\t\t};\n\n\t\tfunction epsilon( value ) {\n\n\t\t\treturn Math.abs( value ) < 1e-10 ? 0 : value;\n\n\t\t}\n\n\t\tfunction getCameraCSSMatrix( matrix ) {\n\n\t\t\tconst elements = matrix.elements;\n\n\t\t\treturn 'matrix3d(' +\n\t\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\t\tepsilon( - elements[ 1 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 4 ] ) + ',' +\n\t\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 6 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 7 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\t\tepsilon( - elements[ 9 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\t\tepsilon( - elements[ 13 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 15 ] ) +\n\t\t\t')';\n\n\t\t}\n\n\t\tfunction getObjectCSSMatrix( matrix ) {\n\n\t\t\tconst elements = matrix.elements;\n\t\t\tconst matrix3d = 'matrix3d(' +\n\t\t\t\tepsilon( elements[ 0 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 1 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 2 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 3 ] ) + ',' +\n\t\t\t\tepsilon( - elements[ 4 ] ) + ',' +\n\t\t\t\tepsilon( - elements[ 5 ] ) + ',' +\n\t\t\t\tepsilon( - elements[ 6 ] ) + ',' +\n\t\t\t\tepsilon( - elements[ 7 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 8 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 9 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 10 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 11 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 12 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 13 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 14 ] ) + ',' +\n\t\t\t\tepsilon( elements[ 15 ] ) +\n\t\t\t')';\n\n\t\t\treturn 'translate(-50%,-50%)' + matrix3d;\n\n\t\t}\n\n\t\tfunction renderObject( object, scene, camera, cameraCSSMatrix ) {\n\n\t\t\tif ( object.isCSS3DObject ) {\n\n\t\t\t\tconst visible = ( object.visible === true ) && ( object.layers.test( camera.layers ) === true );\n\t\t\t\tobject.element.style.display = ( visible === true ) ? '' : 'none';\n\n\t\t\t\tif ( visible === true ) {\n\n\t\t\t\t\tobject.onBeforeRender( _this, scene, camera );\n\n\t\t\t\t\tlet style;\n\n\t\t\t\t\tif ( object.isCSS3DSprite ) {\n\n\t\t\t\t\t\t// http://swiftcoder.wordpress.com/2008/11/25/constructing-a-billboard-matrix/\n\n\t\t\t\t\t\t_matrix.copy( camera.matrixWorldInverse );\n\t\t\t\t\t\t_matrix.transpose();\n\n\t\t\t\t\t\tif ( object.rotation2D !== 0 ) _matrix.multiply( _matrix2.makeRotationZ( object.rotation2D ) );\n\n\t\t\t\t\t\tobject.matrixWorld.decompose( _position, _quaternion, _scale );\n\t\t\t\t\t\t_matrix.setPosition( _position );\n\t\t\t\t\t\t_matrix.scale( _scale );\n\n\t\t\t\t\t\t_matrix.elements[ 3 ] = 0;\n\t\t\t\t\t\t_matrix.elements[ 7 ] = 0;\n\t\t\t\t\t\t_matrix.elements[ 11 ] = 0;\n\t\t\t\t\t\t_matrix.elements[ 15 ] = 1;\n\n\t\t\t\t\t\tstyle = getObjectCSSMatrix( _matrix );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tstyle = getObjectCSSMatrix( object.matrixWorld );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tconst element = object.element;\n\t\t\t\t\tconst cachedObject = cache.objects.get( object );\n\n\t\t\t\t\tif ( cachedObject === undefined || cachedObject.style !== style ) {\n\n\t\t\t\t\t\telement.style.transform = style;\n\n\t\t\t\t\t\tconst objectData = { style: style };\n\t\t\t\t\t\tcache.objects.set( object, objectData );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( element.parentNode !== cameraElement ) {\n\n\t\t\t\t\t\tcameraElement.appendChild( element );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tobject.onAfterRender( _this, scene, camera );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, l = object.children.length; i < l; i ++ ) {\n\n\t\t\t\trenderObject( object.children[ i ], scene, camera, cameraCSSMatrix );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nexport { CSS3DObject, CSS3DSprite, CSS3DRenderer };\n"]},"metadata":{},"sourceType":"module"}