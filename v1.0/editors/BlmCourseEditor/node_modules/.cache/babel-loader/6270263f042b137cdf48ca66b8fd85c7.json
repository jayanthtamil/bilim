{"ast":null,"code":"import { BackgroundOptionTypes } from \"editor-constants\";\nimport { getElementBySelector, isImage, toggleAttributeInString, toJSONObject, toJSONString, createRGBA } from \"utils\";\nexport const setTemplateActionHTML = (template, data, view) => {\n  const {\n    html,\n    options\n  } = template;\n  const rootElement = getElementBySelector(html, \".outercontainer\");\n\n  if (rootElement) {\n    var _toJSONString;\n\n    const options = createOptions(data, template === null || template === void 0 ? void 0 : template.options, view);\n    const editorOptions = createEditorOptions(data, toJSONObject(rootElement.getAttribute(\"blm-editor-options\")), view);\n    const attrs = {\n      \"blm-options\": toJSONString(options),\n      \"blm-editor-options\": (_toJSONString = toJSONString(editorOptions)) !== null && _toJSONString !== void 0 ? _toJSONString : undefined\n    };\n    return [toggleAttributeInString(html, attrs, \".outercontainer\"), options];\n  }\n\n  return [html, options];\n};\n\nconst createSimpleContent = action => {\n  const {\n    checked,\n    always,\n    simpleContentId: id,\n    option,\n    display\n  } = action;\n  return {\n    checked: id ? checked : false,\n    always,\n    id,\n    option,\n    display\n  };\n};\n\nconst createBackground = action => {\n  const {\n    checked,\n    always,\n    background\n  } = action;\n  const result = {\n    checked: (background === null || background === void 0 ? void 0 : background.main) ? checked : false,\n    always\n  };\n\n  if (background) {\n    const {\n      main,\n      webm,\n      image,\n      tint,\n      option,\n      optionValue,\n      option2,\n      restore = false\n    } = background;\n\n    if (main) {\n      result.path = main.url;\n      result.tint = createRGBA(tint.color, tint.alpha);\n      result.option1 = option;\n      result.restore = restore;\n\n      if (isImage(main.type)) {\n        result.parallaxe = option === BackgroundOptionTypes.Parallax ? optionValue : undefined;\n        result.option2 = option2;\n      } else {\n        result.pathwebm = webm === null || webm === void 0 ? void 0 : webm.url;\n        result.paththumbnaill = image === null || image === void 0 ? void 0 : image.url;\n        result.loop = Boolean(optionValue);\n      }\n    }\n  }\n\n  return result;\n};\n\nconst createSound = action => {\n  var _sound$subtitle, _sound$marker;\n\n  const {\n    checked,\n    always,\n    sound\n  } = action;\n  return {\n    checked: sound ? checked : false,\n    always,\n    path: sound === null || sound === void 0 ? void 0 : sound.url,\n    subtitle: sound === null || sound === void 0 ? void 0 : (_sound$subtitle = sound.subtitle) === null || _sound$subtitle === void 0 ? void 0 : _sound$subtitle.url,\n    marker: sound === null || sound === void 0 ? void 0 : (_sound$marker = sound.marker) === null || _sound$marker === void 0 ? void 0 : _sound$marker.url\n  };\n};\n\nconst createLoadSound = action => {\n  var _sound$subtitle2, _sound$marker2;\n\n  const {\n    checked,\n    always,\n    sound\n  } = action;\n  return {\n    checked: sound ? checked : false,\n    always,\n    path: sound === null || sound === void 0 ? void 0 : sound.url,\n    subtitle: sound === null || sound === void 0 ? void 0 : (_sound$subtitle2 = sound.subtitle) === null || _sound$subtitle2 === void 0 ? void 0 : _sound$subtitle2.url,\n    marker: sound === null || sound === void 0 ? void 0 : (_sound$marker2 = sound.marker) === null || _sound$marker2 === void 0 ? void 0 : _sound$marker2.url\n  };\n};\n\nconst createSoundBackground = action => {\n  var _backgroundsounds$sub, _backgroundsounds$mar;\n\n  const {\n    checked,\n    always,\n    backgroundsounds\n  } = action;\n  return {\n    checked: backgroundsounds ? checked : false,\n    always,\n    path: backgroundsounds === null || backgroundsounds === void 0 ? void 0 : backgroundsounds.url,\n    subtitle: backgroundsounds === null || backgroundsounds === void 0 ? void 0 : (_backgroundsounds$sub = backgroundsounds.subtitle) === null || _backgroundsounds$sub === void 0 ? void 0 : _backgroundsounds$sub.url,\n    marker: backgroundsounds === null || backgroundsounds === void 0 ? void 0 : (_backgroundsounds$mar = backgroundsounds.marker) === null || _backgroundsounds$mar === void 0 ? void 0 : _backgroundsounds$mar.url\n  };\n};\n\nconst stopSound = action => {\n  const {\n    always,\n    unChecked\n  } = action;\n  return {\n    checked: unChecked !== null && unChecked !== void 0 ? unChecked : false,\n    always\n  };\n};\n\nconst createOptions = (data, options, view) => {\n  const {\n    load,\n    complete\n  } = data;\n  const newOptions = { ...options,\n    onload: {},\n    oncomplete: view.complete ? {} : undefined\n  };\n  const {\n    onload,\n    oncomplete\n  } = newOptions;\n\n  if (onload) {\n    if (view.load.navigation) {\n      onload.always = load.navigation.always;\n      onload.hidenext = load.navigation.next;\n      onload.hideprevious = load.navigation.previous;\n      onload.hidehome = load.navigation.home;\n    }\n\n    if (view.load.background) {\n      onload.changebackground = createBackground(load.background);\n    }\n\n    if (view.load.simpleContent) {\n      onload.opensimplecontent = createSimpleContent(load.simpleContent);\n    }\n\n    if (view.load.sound) {\n      onload.playsound = createLoadSound(load.sound);\n    }\n\n    if (view.load.sound && view.load.background && view.load.simpleContent) {\n      onload.stopsound = stopSound(load.sound);\n    }\n\n    if (view.load.backgroundSound) {\n      onload.playbackgroundsound = createSoundBackground(load.backgroundSound);\n      onload.stopbackgroundsound = stopSound(load.backgroundSound);\n    }\n  }\n\n  if (view && oncomplete) {\n    var _view$complete;\n\n    if ((_view$complete = view.complete) === null || _view$complete === void 0 ? void 0 : _view$complete.navigation) {\n      oncomplete.keepnextkidden = complete.navigation.next;\n      oncomplete.showprevious = complete.navigation.previous;\n      oncomplete.showhome = complete.navigation.home;\n    }\n\n    oncomplete.opensimplecontent = createSimpleContent(complete.simpleContent);\n    oncomplete.changebackground = createBackground(complete.background);\n    oncomplete.playsound = createSound(complete.sound);\n  }\n\n  return newOptions;\n};\n\nconst createEditorOptions = (data, options, view) => {\n  var _view$complete2, _view$complete3;\n\n  const {\n    load,\n    complete\n  } = data;\n  const {\n    onLoad = {},\n    onComplete = {},\n    ...others\n  } = options || {};\n  const newOptions = { ...others\n  };\n\n  if (view.load.background) {\n    onLoad.background = createEditorBackground(load.background.background);\n  }\n\n  if (view.load.sound) {\n    onLoad.sound = createEditorSound(load.sound);\n  }\n\n  if (view.load.backgroundSound) {\n    onLoad.backgroundsounds = createEditorBackgroundSound(load.backgroundSound);\n  }\n\n  if ((_view$complete2 = view.complete) === null || _view$complete2 === void 0 ? void 0 : _view$complete2.background) {\n    onComplete.background = createEditorBackground(complete.background.background);\n  }\n\n  if ((_view$complete3 = view.complete) === null || _view$complete3 === void 0 ? void 0 : _view$complete3.sound) {\n    onComplete.sound = createEditorSound(complete.sound);\n  }\n\n  if (onLoad.background || onLoad.sound || onLoad.backgroundsounds) {\n    newOptions.onLoad = onLoad;\n  }\n\n  if (onComplete.background || onComplete.sound) {\n    newOptions.onComplete = onComplete;\n  }\n\n  return Object.keys(newOptions).length ? newOptions : null;\n};\n\nconst createEditorBackground = background => {\n  if (background === null || background === void 0 ? void 0 : background.main) {\n    const {\n      main,\n      webm,\n      image\n    } = background;\n    return isImage(main.type) ? {\n      main\n    } : {\n      main,\n      webm,\n      image\n    };\n  }\n};\n\nconst createEditorSound = sound => {\n  return sound === null || sound === void 0 ? void 0 : sound.sound;\n};\n\nconst createEditorBackgroundSound = sound => {\n  return sound === null || sound === void 0 ? void 0 : sound.backgroundsounds;\n};","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/src/template-builders/html/action/index.ts"],"names":["BackgroundOptionTypes","getElementBySelector","isImage","toggleAttributeInString","toJSONObject","toJSONString","createRGBA","setTemplateActionHTML","template","data","view","html","options","rootElement","createOptions","editorOptions","createEditorOptions","getAttribute","attrs","undefined","createSimpleContent","action","checked","always","simpleContentId","id","option","display","createBackground","background","result","main","webm","image","tint","optionValue","option2","restore","path","url","color","alpha","option1","type","parallaxe","Parallax","pathwebm","paththumbnaill","loop","Boolean","createSound","sound","subtitle","marker","createLoadSound","createSoundBackground","backgroundsounds","stopSound","unChecked","load","complete","newOptions","onload","oncomplete","navigation","hidenext","next","hideprevious","previous","hidehome","home","changebackground","simpleContent","opensimplecontent","playsound","stopsound","backgroundSound","playbackgroundsound","stopbackgroundsound","keepnextkidden","showprevious","showhome","onLoad","onComplete","others","createEditorBackground","createEditorSound","createEditorBackgroundSound","Object","keys","length"],"mappings":"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","sourcesContent":["import {\r\n  TemplateOptionsJSON,\r\n  CourseElementTemplate,\r\n  ContentTemplateAction,\r\n  TemplateSimpleContentAction,\r\n  TemplateBackgroundAction,\r\n  TemplateSoundAction,\r\n  TemplateBackgroundJSON,\r\n  TemplateEditorOptionsJSON,\r\n  BackgroundMedia,\r\n  TempalteActionView,\r\n  TemplateBackgroundSoundAction,\r\n} from \"types\";\r\nimport { BackgroundOptionTypes } from \"editor-constants\";\r\nimport {\r\n  getElementBySelector,\r\n  isImage,\r\n  toggleAttributeInString,\r\n  toJSONObject,\r\n  toJSONString,\r\n  createRGBA,\r\n} from \"utils\";\r\n\r\nexport const setTemplateActionHTML = (\r\n  template: CourseElementTemplate,\r\n  data: ContentTemplateAction,\r\n  view: TempalteActionView\r\n): [string, TemplateOptionsJSON | null] => {\r\n  const { html, options } = template;\r\n  const rootElement = getElementBySelector(html, \".outercontainer\");\r\n\r\n  if (rootElement) {\r\n        const options = createOptions(data, template?.options, view);\r\n            const editorOptions = createEditorOptions(\r\n      data,\r\n      toJSONObject(rootElement.getAttribute(\"blm-editor-options\")),\r\n      view\r\n    );\r\n    const attrs = {\r\n      \"blm-options\": toJSONString(options),\r\n      \"blm-editor-options\": toJSONString(editorOptions) ?? undefined,\r\n    };\r\n\r\n    return [toggleAttributeInString(html, attrs, \".outercontainer\"), options];\r\n  }\r\n\r\n  return [html, options];\r\n};\r\n\r\nconst createSimpleContent = (action: TemplateSimpleContentAction) => {\r\n  const { checked, always, simpleContentId: id, option, display } = action;\r\n\r\n  return { checked: id ? checked : false, always, id, option, display };\r\n};\r\n\r\nconst createBackground = (action: TemplateBackgroundAction) => {\r\n  const { checked, always, background } = action;\r\n  const result: TemplateBackgroundJSON = { checked: background?.main ? checked : false, always };\r\n\r\n  if (background) {\r\n    const { main, webm, image, tint, option, optionValue, option2, restore = false } = background;\r\n\r\n    if (main) {\r\n      result.path = main.url;\r\n      result.tint = createRGBA(tint.color, tint.alpha);\r\n      result.option1 = option;\r\n      result.restore = restore;\r\n\r\n      if (isImage(main.type)) {\r\n        result.parallaxe =\r\n          option === BackgroundOptionTypes.Parallax ? (optionValue as number) : undefined;\r\n        result.option2 = option2;\r\n      } else {\r\n        result.pathwebm = webm?.url;\r\n        result.paththumbnaill = image?.url;\r\n        result.loop = Boolean(optionValue);\r\n      }\r\n    }\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nconst createSound = (action: TemplateSoundAction) => {\r\n  const { checked, always, sound } = action;\r\n\r\n  return {\r\n    checked: sound ? checked : false,\r\n    always,\r\n    path: sound?.url,\r\n    subtitle: sound?.subtitle?.url,\r\n    marker: sound?.marker?.url,\r\n  };\r\n};\r\n\r\nconst createLoadSound = (action: TemplateSoundAction) => {\r\n  const { checked, always, sound } = action;\r\n\r\n  return {\r\n    checked: sound ? checked : false,\r\n    always,\r\n    path: sound?.url,\r\n    subtitle: sound?.subtitle?.url,\r\n    marker: sound?.marker?.url,\r\n  };\r\n};\r\n\r\nconst createSoundBackground = (action: TemplateBackgroundSoundAction) => {\r\n  const { checked, always, backgroundsounds } = action;\r\n  return {\r\n    checked: backgroundsounds ? checked : false,\r\n    always,\r\n    path: backgroundsounds?.url,\r\n    subtitle: backgroundsounds?.subtitle?.url,\r\n    marker: backgroundsounds?.marker?.url,\r\n  };\r\n};\r\n\r\nconst stopSound = (action: TemplateSoundAction) => {\r\n  const { always, unChecked } = action;\r\n  return {\r\n    checked: unChecked ?? false,\r\n    always,\r\n  };\r\n};\r\n\r\nconst createOptions = (\r\n  data: ContentTemplateAction,\r\n  options: TemplateOptionsJSON | null,\r\n  view: TempalteActionView\r\n) => {\r\n  const { load, complete } = data;\r\n  const newOptions = {\r\n    ...options,\r\n    onload: {},\r\n    oncomplete: view.complete ? {} : undefined,\r\n  } as TemplateOptionsJSON;\r\n  const { onload, oncomplete } = newOptions;\r\n  \r\n  if (onload) {\r\n    if (view.load.navigation) {\r\n      onload.always = load.navigation.always;\r\n      onload.hidenext = load.navigation.next;\r\n      onload.hideprevious = load.navigation.previous;\r\n      onload.hidehome = load.navigation.home;\r\n    }\r\n\r\n    if (view.load.background) {\r\n      onload.changebackground = createBackground(load.background);\r\n    }\r\n\r\n    if (view.load.simpleContent) {\r\n      onload.opensimplecontent = createSimpleContent(load.simpleContent);\r\n    }\r\n\r\n    if (view.load.sound) {\r\n      onload.playsound = createLoadSound(load.sound);\r\n    }\r\n\r\n    if (view.load.sound && view.load.background && view.load.simpleContent) {\r\n      onload.stopsound = stopSound(load.sound);\r\n    }\r\n    if (view.load.backgroundSound) {\r\n      onload.playbackgroundsound = createSoundBackground(load.backgroundSound);\r\n      onload.stopbackgroundsound = stopSound(load.backgroundSound);\r\n    }\r\n      }\r\n\r\n  if (view && oncomplete) {\r\n    if (view.complete?.navigation) {\r\n      oncomplete.keepnextkidden = complete.navigation.next;\r\n      oncomplete.showprevious = complete.navigation.previous;\r\n      oncomplete.showhome = complete.navigation.home;\r\n    }\r\n    oncomplete.opensimplecontent = createSimpleContent(complete.simpleContent);\r\n    oncomplete.changebackground = createBackground(complete.background);\r\n    oncomplete.playsound = createSound(complete.sound);\r\n  }\r\n\r\n  return newOptions;\r\n};\r\n\r\nconst createEditorOptions = (\r\n  data: ContentTemplateAction,\r\n  options: TemplateEditorOptionsJSON | null,\r\n  view: TempalteActionView\r\n) => {\r\n  const { load, complete } = data;\r\n  const { onLoad = {}, onComplete = {}, ...others } = options || {};\r\n  const newOptions: TemplateEditorOptionsJSON = { ...others };\r\n\r\n  if (view.load.background) {\r\n    onLoad.background = createEditorBackground(load.background.background);\r\n  }\r\n\r\n  if (view.load.sound) {\r\n    onLoad.sound = createEditorSound(load.sound);\r\n  }\r\n\r\n  if (view.load.backgroundSound) {\r\n    onLoad.backgroundsounds = createEditorBackgroundSound(load.backgroundSound);\r\n  }\r\n\r\n  if (view.complete?.background) {\r\n    onComplete.background = createEditorBackground(complete.background.background);\r\n  }\r\n\r\n  if (view.complete?.sound) {\r\n    onComplete.sound = createEditorSound(complete.sound);\r\n  }\r\n\r\n  if (onLoad.background || onLoad.sound || onLoad.backgroundsounds) {\r\n    newOptions.onLoad = onLoad;\r\n  }\r\n\r\n  if (onComplete.background || onComplete.sound) {\r\n    newOptions.onComplete = onComplete;\r\n  }\r\n\r\n  return Object.keys(newOptions).length ? newOptions : null;\r\n};\r\n\r\nconst createEditorBackground = (background?: BackgroundMedia) => {\r\n  if (background?.main) {\r\n    const { main, webm, image } = background;\r\n\r\n    return isImage(main.type) ? { main } : { main, webm, image };\r\n  }\r\n};\r\n\r\nconst createEditorSound = (sound?: TemplateSoundAction) => {\r\n  return sound?.sound;\r\n};\r\n\r\nconst createEditorBackgroundSound = (sound?: TemplateBackgroundSoundAction) => {\r\n  return sound?.backgroundsounds;\r\n};\r\n"]},"metadata":{},"sourceType":"module"}