{"ast":null,"code":"/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n * @oncall draft_js\n */\n'use strict';\n\nvar _knownListItemDepthCl;\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    enumerableOnly && (symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    })), keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = null != arguments[i] ? arguments[i] : {};\n    i % 2 ? ownKeys(Object(source), !0).forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) {\n      Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar CharacterMetadata = require(\"./CharacterMetadata\");\n\nvar ContentBlock = require(\"./ContentBlock\");\n\nvar ContentBlockNode = require(\"./ContentBlockNode\");\n\nvar ContentState = require(\"./ContentState\");\n\nvar DefaultDraftBlockRenderMap = require(\"./DefaultDraftBlockRenderMap\");\n\nvar URI = require(\"fbjs/lib/URI\");\n\nvar cx = require(\"fbjs/lib/cx\");\n\nvar generateRandomKey = require(\"./generateRandomKey\");\n\nvar getSafeBodyFromHTML = require(\"./getSafeBodyFromHTML\");\n\nvar gkx = require(\"./gkx\");\n\nvar _require = require(\"immutable\"),\n    List = _require.List,\n    Map = _require.Map,\n    OrderedSet = _require.OrderedSet;\n\nvar isHTMLAnchorElement = require(\"./isHTMLAnchorElement\");\n\nvar isHTMLBRElement = require(\"./isHTMLBRElement\");\n\nvar isHTMLElement = require(\"./isHTMLElement\");\n\nvar isHTMLImageElement = require(\"./isHTMLImageElement\");\n\nvar experimentalTreeDataSupport = gkx('draft_tree_data_support');\nvar allowPastingAltText = gkx('draftjs_paste_emojis');\nvar NBSP = '&nbsp;';\nvar SPACE = ' '; // used for replacing characters in HTML\n\nvar REGEX_CR = new RegExp('\\r', 'g');\nvar REGEX_LF = new RegExp('\\n', 'g');\nvar REGEX_LEADING_LF = new RegExp('^\\n', 'g');\nvar REGEX_NBSP = new RegExp(NBSP, 'g');\nvar REGEX_CARRIAGE = new RegExp('&#13;?', 'g');\nvar REGEX_ZWS = new RegExp('&#8203;?', 'g'); // https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight\n\nvar boldValues = ['bold', 'bolder', '500', '600', '700', '800', '900'];\nvar notBoldValues = ['light', 'lighter', 'normal', '100', '200', '300', '400'];\nvar anchorAttr = ['className', 'href', 'rel', 'target', 'title'];\nvar imgAttr = ['alt', 'className', 'height', 'src', 'width'];\nvar knownListItemDepthClasses = (_knownListItemDepthCl = {}, _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth0'), 0), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth1'), 1), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth2'), 2), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth3'), 3), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth4'), 4), _knownListItemDepthCl);\nvar HTMLTagToRawInlineStyleMap = Map({\n  b: 'BOLD',\n  code: 'CODE',\n  del: 'STRIKETHROUGH',\n  em: 'ITALIC',\n  i: 'ITALIC',\n  s: 'STRIKETHROUGH',\n  strike: 'STRIKETHROUGH',\n  strong: 'BOLD',\n  u: 'UNDERLINE',\n  mark: 'HIGHLIGHT'\n});\n/**\n * Build a mapping from HTML tags to draftjs block types\n * out of a BlockRenderMap.\n *\n * The BlockTypeMap for the default BlockRenderMap looks like this:\n *   Map({\n *     h1: 'header-one',\n *     h2: 'header-two',\n *     h3: 'header-three',\n *     h4: 'header-four',\n *     h5: 'header-five',\n *     h6: 'header-six',\n *     blockquote: 'blockquote',\n *     figure: 'atomic',\n *     pre: ['code-block'],\n *     div: 'unstyled',\n *     p: 'unstyled',\n *     li: ['ordered-list-item', 'unordered-list-item'],\n *   })\n */\n\nvar buildBlockTypeMap = function buildBlockTypeMap(blockRenderMap) {\n  var blockTypeMap = {};\n  blockRenderMap.mapKeys(function (blockType, desc) {\n    var elements = [desc.element];\n\n    if (desc.aliasedElements !== undefined) {\n      elements.push.apply(elements, desc.aliasedElements);\n    }\n\n    elements.forEach(function (element) {\n      if (blockTypeMap[element] === undefined) {\n        blockTypeMap[element] = blockType;\n      } else if (typeof blockTypeMap[element] === 'string') {\n        blockTypeMap[element] = [blockTypeMap[element], blockType];\n      } else {\n        blockTypeMap[element].push(blockType);\n      }\n    });\n  });\n  return Map(blockTypeMap);\n};\n\nvar detectInlineStyle = function detectInlineStyle(node) {\n  if (isHTMLElement(node)) {\n    var element = node; // Currently only used to detect preformatted inline code\n\n    if (element.style.fontFamily.includes('monospace')) {\n      return 'CODE';\n    }\n  }\n\n  return null;\n};\n/**\n * If we're pasting from one DraftEditor to another we can check to see if\n * existing list item depth classes are being used and preserve this style\n */\n\n\nvar getListItemDepth = function getListItemDepth(node) {\n  var depth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  Object.keys(knownListItemDepthClasses).some(function (depthClass) {\n    if (node.classList.contains(depthClass)) {\n      depth = knownListItemDepthClasses[depthClass];\n    }\n  });\n  return depth;\n};\n/**\n * Return true if the provided HTML Element can be used to build a\n * Draftjs-compatible link.\n */\n\n\nvar isValidAnchor = function isValidAnchor(node) {\n  if (!isHTMLAnchorElement(node)) {\n    return false;\n  }\n\n  var anchorNode = node;\n\n  if (!anchorNode.href || anchorNode.protocol !== 'http:' && anchorNode.protocol !== 'https:' && anchorNode.protocol !== 'mailto:' && anchorNode.protocol !== 'tel:') {\n    return false;\n  }\n\n  try {\n    // Just checking whether we can actually create a URI\n    var _ = new URI(anchorNode.href);\n\n    return true;\n  } catch (_unused) {\n    return false;\n  }\n};\n/**\n * Return true if the provided HTML Element can be used to build a\n * Draftjs-compatible image.\n */\n\n\nvar isValidImage = function isValidImage(node) {\n  if (!isHTMLImageElement(node)) {\n    return false;\n  }\n\n  var imageNode = node;\n  return !!(imageNode.attributes.getNamedItem('src') && imageNode.attributes.getNamedItem('src').value);\n};\n/**\n * Try to guess the inline style of an HTML element based on its css\n * styles (font-weight, font-style and text-decoration).\n */\n\n\nvar styleFromNodeAttributes = function styleFromNodeAttributes(node, style) {\n  if (!isHTMLElement(node)) {\n    return style;\n  }\n\n  var htmlElement = node;\n  var fontWeight = htmlElement.style.fontWeight;\n  var fontStyle = htmlElement.style.fontStyle;\n  var textDecoration = htmlElement.style.textDecoration;\n  return style.withMutations(function (style) {\n    if (boldValues.indexOf(fontWeight) >= 0) {\n      style.add('BOLD');\n    } else if (notBoldValues.indexOf(fontWeight) >= 0) {\n      style.remove('BOLD');\n    }\n\n    if (fontStyle === 'italic') {\n      style.add('ITALIC');\n    } else if (fontStyle === 'normal') {\n      style.remove('ITALIC');\n    }\n\n    if (textDecoration === 'underline') {\n      style.add('UNDERLINE');\n    }\n\n    if (textDecoration === 'line-through') {\n      style.add('STRIKETHROUGH');\n    }\n\n    if (textDecoration === 'none') {\n      style.remove('UNDERLINE');\n      style.remove('STRIKETHROUGH');\n    }\n  });\n};\n/**\n * Determine if a nodeName is a list type, 'ul' or 'ol'\n */\n\n\nvar isListNode = function isListNode(nodeName) {\n  return nodeName === 'ul' || nodeName === 'ol';\n};\n/**\n *  ContentBlockConfig is a mutable data structure that holds all\n *  the information required to build a ContentBlock and an array of\n *  all the child nodes (childConfigs).\n *  It is being used a temporary data structure by the\n *  ContentBlocksBuilder class.\n */\n\n/**\n * ContentBlocksBuilder builds a list of ContentBlocks and an Entity Map\n * out of one (or several) HTMLElement(s).\n *\n * The algorithm has two passes: first it builds a tree of ContentBlockConfigs\n * by walking through the HTML nodes and their children, then it walks the\n * ContentBlockConfigs tree to compute parents/siblings and create\n * the actual ContentBlocks.\n *\n * Typical usage is:\n *     new ContentBlocksBuilder()\n *        .addDOMNode(someHTMLNode)\n *        .addDOMNode(someOtherHTMLNode)\n *       .getContentBlocks();\n *\n */\n\n\nvar ContentBlocksBuilder = /*#__PURE__*/function () {\n  // Most of the method in the class depend on the state of the content builder\n  // (i.e. currentBlockType, currentDepth, currentEntity etc.). Though it may\n  // be confusing at first, it made the code simpler than the alternative which\n  // is to pass those values around in every call.\n  // The following attributes are used to accumulate text and styles\n  // as we are walking the HTML node tree.\n  // Describes the future ContentState as a tree of content blocks\n  // The content blocks generated from the blockConfigs\n  // Entity map use to store links and images found in the HTML nodes\n  // Map HTML tags to draftjs block types and disambiguation function\n  function ContentBlocksBuilder(blockTypeMap, disambiguate) {\n    _defineProperty(this, \"characterList\", List());\n\n    _defineProperty(this, \"currentBlockType\", 'unstyled');\n\n    _defineProperty(this, \"currentDepth\", 0);\n\n    _defineProperty(this, \"currentEntity\", null);\n\n    _defineProperty(this, \"currentText\", '');\n\n    _defineProperty(this, \"wrapper\", null);\n\n    _defineProperty(this, \"blockConfigs\", []);\n\n    _defineProperty(this, \"contentBlocks\", []);\n\n    _defineProperty(this, \"contentState\", ContentState.createFromText(''));\n\n    _defineProperty(this, \"blockTypeMap\", void 0);\n\n    _defineProperty(this, \"disambiguate\", void 0);\n\n    this.clear();\n    this.blockTypeMap = blockTypeMap;\n    this.disambiguate = disambiguate;\n  }\n  /**\n   * Clear the internal state of the ContentBlocksBuilder\n   */\n\n\n  var _proto = ContentBlocksBuilder.prototype;\n\n  _proto.clear = function clear() {\n    this.characterList = List();\n    this.blockConfigs = [];\n    this.currentBlockType = 'unstyled';\n    this.currentDepth = 0;\n    this.currentEntity = null;\n    this.currentText = '';\n    this.contentState = ContentState.createFromText('');\n    this.wrapper = null;\n    this.contentBlocks = [];\n  }\n  /**\n   * Add an HTMLElement to the ContentBlocksBuilder\n   */\n  ;\n\n  _proto.addDOMNode = function addDOMNode(node) {\n    var _this$blockConfigs;\n\n    this.contentBlocks = [];\n    this.currentDepth = 0; // Converts the HTML node to block config\n\n    (_this$blockConfigs = this.blockConfigs).push.apply(_this$blockConfigs, this._toBlockConfigs([node], OrderedSet())); // There might be some left over text in the builder's\n    // internal state, if so make a ContentBlock out of it.\n\n\n    this._trimCurrentText();\n\n    if (this.currentText !== '') {\n      this.blockConfigs.push(this._makeBlockConfig());\n    } // for chaining\n\n\n    return this;\n  }\n  /**\n   * Return the ContentBlocks and the EntityMap that corresponds\n   * to the previously added HTML nodes.\n   */\n  ;\n\n  _proto.getContentBlocks = function getContentBlocks() {\n    if (this.contentBlocks.length === 0) {\n      if (experimentalTreeDataSupport) {\n        this._toContentBlocks(this.blockConfigs);\n      } else {\n        this._toFlatContentBlocks(this.blockConfigs);\n      }\n    }\n\n    return {\n      contentBlocks: this.contentBlocks,\n      entityMap: this.contentState.getEntityMap()\n    };\n  } // ***********************************WARNING******************************\n  // The methods below this line are private - don't call them directly.\n\n  /**\n   * Generate a new ContentBlockConfig out of the current internal state\n   * of the builder, then clears the internal state.\n   */\n  ;\n\n  _proto._makeBlockConfig = function _makeBlockConfig() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var key = config.key || generateRandomKey();\n\n    var block = _objectSpread({\n      key: key,\n      type: this.currentBlockType,\n      text: this.currentText,\n      characterList: this.characterList,\n      depth: this.currentDepth,\n      parent: null,\n      children: List(),\n      prevSibling: null,\n      nextSibling: null,\n      childConfigs: []\n    }, config);\n\n    this.characterList = List();\n    this.currentBlockType = 'unstyled';\n    this.currentText = '';\n    return block;\n  }\n  /**\n   * Converts an array of HTML elements to a multi-root tree of content\n   * block configs. Some text content may be left in the builders internal\n   * state to enable chaining sucessive calls.\n   */\n  ;\n\n  _proto._toBlockConfigs = function _toBlockConfigs(nodes, style) {\n    var blockConfigs = [];\n\n    for (var i = 0; i < nodes.length; i++) {\n      var node = nodes[i];\n      var nodeName = node.nodeName.toLowerCase();\n\n      if (nodeName === 'body' || isListNode(nodeName)) {\n        // body, ol and ul are 'block' type nodes so create a block config\n        // with the text accumulated so far (if any)\n        this._trimCurrentText();\n\n        if (this.currentText !== '') {\n          blockConfigs.push(this._makeBlockConfig());\n        } // body, ol and ul nodes are ignored, but their children are inlined in\n        // the parent block config.\n\n\n        var wasCurrentDepth = this.currentDepth;\n        var wasWrapper = this.wrapper;\n\n        if (isListNode(nodeName)) {\n          this.wrapper = nodeName;\n\n          if (isListNode(wasWrapper)) {\n            this.currentDepth++;\n          }\n        }\n\n        blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), style));\n        this.currentDepth = wasCurrentDepth;\n        this.wrapper = wasWrapper;\n        continue;\n      }\n\n      var blockType = this.blockTypeMap.get(nodeName);\n\n      if (blockType !== undefined) {\n        // 'block' type node means we need to create a block config\n        // with the text accumulated so far (if any)\n        this._trimCurrentText();\n\n        if (this.currentText !== '') {\n          blockConfigs.push(this._makeBlockConfig());\n        }\n\n        var _wasCurrentDepth = this.currentDepth;\n        var _wasWrapper = this.wrapper;\n        this.wrapper = nodeName === 'pre' ? 'pre' : this.wrapper;\n\n        if (typeof blockType !== 'string') {\n          blockType = this.disambiguate(nodeName, this.wrapper) || blockType[0] || 'unstyled';\n        }\n\n        if (!experimentalTreeDataSupport && isHTMLElement(node) && (blockType === 'unordered-list-item' || blockType === 'ordered-list-item')) {\n          var htmlElement = node;\n          this.currentDepth = getListItemDepth(htmlElement, this.currentDepth);\n        }\n\n        var key = generateRandomKey();\n\n        var childConfigs = this._toBlockConfigs(Array.from(node.childNodes), style);\n\n        this._trimCurrentText();\n\n        blockConfigs.push(this._makeBlockConfig({\n          key: key,\n          childConfigs: childConfigs,\n          type: blockType\n        }));\n        this.currentDepth = _wasCurrentDepth;\n        this.wrapper = _wasWrapper;\n        continue;\n      }\n\n      if (nodeName === '#text') {\n        this._addTextNode(node, style);\n\n        continue;\n      }\n\n      if (nodeName === 'br') {\n        this._addBreakNode(node, style);\n\n        continue;\n      }\n\n      if (isValidImage(node)) {\n        this._addImgNode(node, style);\n\n        continue;\n      }\n\n      if (isValidAnchor(node)) {\n        this._addAnchorNode(node, blockConfigs, style);\n\n        continue;\n      }\n\n      var newStyle = style;\n\n      if (HTMLTagToRawInlineStyleMap.has(nodeName)) {\n        newStyle = newStyle.add(HTMLTagToRawInlineStyleMap.get(nodeName));\n      }\n\n      newStyle = styleFromNodeAttributes(node, newStyle);\n      var inlineStyle = detectInlineStyle(node);\n\n      if (inlineStyle != null) {\n        newStyle = newStyle.add(inlineStyle);\n      }\n\n      blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), newStyle));\n    }\n\n    return blockConfigs;\n  }\n  /**\n   * Append a string of text to the internal buffer.\n   */\n  ;\n\n  _proto._appendText = function _appendText(text, style) {\n    var _this$characterList;\n\n    this.currentText += text;\n    var characterMetadata = CharacterMetadata.create({\n      style: style,\n      entity: this.currentEntity\n    });\n    this.characterList = (_this$characterList = this.characterList).push.apply(_this$characterList, Array(text.length).fill(characterMetadata));\n  }\n  /**\n   * Trim the text in the internal buffer.\n   */\n  ;\n\n  _proto._trimCurrentText = function _trimCurrentText() {\n    var l = this.currentText.length;\n    var begin = l - this.currentText.trimLeft().length;\n    var end = this.currentText.trimRight().length; // We should not trim whitespaces for which an entity is defined.\n\n    var entity = this.characterList.findEntry(function (characterMetadata) {\n      return characterMetadata.getEntity() !== null;\n    });\n    begin = entity !== undefined ? Math.min(begin, entity[0]) : begin;\n    entity = this.characterList.reverse().findEntry(function (characterMetadata) {\n      return characterMetadata.getEntity() !== null;\n    });\n    end = entity !== undefined ? Math.max(end, l - entity[0]) : end;\n\n    if (begin > end) {\n      this.currentText = '';\n      this.characterList = List();\n    } else {\n      this.currentText = this.currentText.slice(begin, end);\n      this.characterList = this.characterList.slice(begin, end);\n    }\n  }\n  /**\n   * Add the content of an HTML text node to the internal state\n   */\n  ;\n\n  _proto._addTextNode = function _addTextNode(node, style) {\n    var text = node.textContent;\n    var trimmedText = text.trim(); // If we are not in a pre block and the trimmed content is empty,\n    // normalize to a single space.\n\n    if (trimmedText === '' && this.wrapper !== 'pre') {\n      text = ' ';\n    }\n\n    if (this.wrapper !== 'pre') {\n      // Trim leading line feed, which is invisible in HTML\n      text = text.replace(REGEX_LEADING_LF, ''); // Can't use empty string because MSWord\n\n      text = text.replace(REGEX_LF, SPACE);\n    }\n\n    this._appendText(text, style);\n  };\n\n  _proto._addBreakNode = function _addBreakNode(node, style) {\n    if (!isHTMLBRElement(node)) {\n      return;\n    }\n\n    this._appendText('\\n', style);\n  }\n  /**\n   * Add the content of an HTML img node to the internal state\n   */\n  ;\n\n  _proto._addImgNode = function _addImgNode(node, style) {\n    if (!isHTMLImageElement(node)) {\n      return;\n    }\n\n    var image = node;\n    var entityConfig = {};\n    imgAttr.forEach(function (attr) {\n      var imageAttribute = image.getAttribute(attr);\n\n      if (imageAttribute) {\n        entityConfig[attr] = imageAttribute;\n      }\n    });\n    this.contentState = this.contentState.createEntity('IMAGE', 'IMMUTABLE', entityConfig);\n    this.currentEntity = this.contentState.getLastCreatedEntityKey(); // The child text node cannot just have a space or return as content (since\n    // we strip those out)\n\n    var alt = image.getAttribute('alt');\n\n    if (allowPastingAltText && alt != null && alt.length > 0) {\n      this._appendText(alt, style);\n    } else {\n      this._appendText(\"\\uD83D\\uDCF7\", style);\n    }\n\n    this.currentEntity = null;\n  }\n  /**\n   * Add the content of an HTML 'a' node to the internal state. Child nodes\n   * (if any) are converted to Block Configs and appended to the provided\n   * blockConfig array.\n   */\n  ;\n\n  _proto._addAnchorNode = function _addAnchorNode(node, blockConfigs, style) {\n    // The check has already been made by isValidAnchor but\n    // we have to do it again to keep flow happy.\n    if (!isHTMLAnchorElement(node)) {\n      return;\n    }\n\n    var anchor = node;\n    var entityConfig = {};\n    anchorAttr.forEach(function (attr) {\n      var anchorAttribute = anchor.getAttribute(attr);\n\n      if (anchorAttribute) {\n        entityConfig[attr] = anchorAttribute;\n      }\n    });\n    entityConfig.url = new URI(anchor.href).toString();\n    this.contentState = this.contentState.createEntity('LINK', 'MUTABLE', entityConfig || {});\n    this.currentEntity = this.contentState.getLastCreatedEntityKey();\n    blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), style));\n    this.currentEntity = null;\n  }\n  /**\n   * Walk the BlockConfig tree, compute parent/children/siblings,\n   * and generate the corresponding ContentBlockNode\n   */\n  ;\n\n  _proto._toContentBlocks = function _toContentBlocks(blockConfigs) {\n    var parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var l = blockConfigs.length - 1;\n\n    for (var i = 0; i <= l; i++) {\n      var config = blockConfigs[i];\n      config.parent = parent;\n      config.prevSibling = i > 0 ? blockConfigs[i - 1].key : null;\n      config.nextSibling = i < l ? blockConfigs[i + 1].key : null;\n      config.children = List(config.childConfigs.map(function (child) {\n        return child.key;\n      }));\n      this.contentBlocks.push(new ContentBlockNode(_objectSpread({}, config)));\n\n      this._toContentBlocks(config.childConfigs, config.key);\n    }\n  }\n  /**\n   * Remove 'useless' container nodes from the block config hierarchy, by\n   * replacing them with their children.\n   */\n  ;\n\n  _proto._hoistContainersInBlockConfigs = function _hoistContainersInBlockConfigs(blockConfigs) {\n    var _this = this;\n\n    var hoisted = List(blockConfigs).flatMap(function (blockConfig) {\n      // Don't mess with useful blocks\n      if (blockConfig.type !== 'unstyled' || blockConfig.text !== '') {\n        return [blockConfig];\n      }\n\n      return _this._hoistContainersInBlockConfigs(blockConfig.childConfigs);\n    });\n    return hoisted;\n  } // ***********************************************************************\n  // The two methods below are used for backward compatibility when\n  // experimentalTreeDataSupport is disabled.\n\n  /**\n   * Same as _toContentBlocks but replaces nested blocks by their\n   * text content.\n   */\n  ;\n\n  _proto._toFlatContentBlocks = function _toFlatContentBlocks(blockConfigs) {\n    var _this2 = this;\n\n    var cleanConfigs = this._hoistContainersInBlockConfigs(blockConfigs);\n\n    cleanConfigs.forEach(function (config) {\n      var _this2$_extractTextFr = _this2._extractTextFromBlockConfigs(config.childConfigs),\n          text = _this2$_extractTextFr.text,\n          characterList = _this2$_extractTextFr.characterList;\n\n      _this2.contentBlocks.push(new ContentBlock(_objectSpread(_objectSpread({}, config), {}, {\n        text: config.text + text,\n        characterList: config.characterList.concat(characterList)\n      })));\n    });\n  }\n  /**\n   * Extract the text and the associated inline styles form an\n   * array of content block configs.\n   */\n  ;\n\n  _proto._extractTextFromBlockConfigs = function _extractTextFromBlockConfigs(blockConfigs) {\n    var l = blockConfigs.length - 1;\n    var text = '';\n    var characterList = List();\n\n    for (var i = 0; i <= l; i++) {\n      var config = blockConfigs[i];\n      text += config.text;\n      characterList = characterList.concat(config.characterList);\n\n      if (text !== '' && config.type !== 'unstyled') {\n        text += '\\n';\n        characterList = characterList.push(characterList.last());\n      }\n\n      var children = this._extractTextFromBlockConfigs(config.childConfigs);\n\n      text += children.text;\n      characterList = characterList.concat(children.characterList);\n    }\n\n    return {\n      text: text,\n      characterList: characterList\n    };\n  };\n\n  return ContentBlocksBuilder;\n}();\n/**\n * Converts an HTML string to an array of ContentBlocks and an EntityMap\n * suitable to initialize the internal state of a Draftjs component.\n */\n\n\nvar convertFromHTMLToContentBlocks = function convertFromHTMLToContentBlocks(html) {\n  var DOMBuilder = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getSafeBodyFromHTML;\n  var blockRenderMap = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : DefaultDraftBlockRenderMap; // Be ABSOLUTELY SURE that the dom builder you pass here won't execute\n  // arbitrary code in whatever environment you're running this in. For an\n  // example of how we try to do this in-browser, see getSafeBodyFromHTML.\n  // Remove funky characters from the HTML string\n\n  html = html.trim().replace(REGEX_CR, '').replace(REGEX_NBSP, SPACE).replace(REGEX_CARRIAGE, '').replace(REGEX_ZWS, ''); // Build a DOM tree out of the HTML string\n\n  var safeBody = DOMBuilder(html);\n\n  if (!safeBody) {\n    return null;\n  } // Build a BlockTypeMap out of the BlockRenderMap\n\n\n  var blockTypeMap = buildBlockTypeMap(blockRenderMap); // Select the proper block type for the cases where the blockRenderMap\n  // uses multiple block types for the same html tag.\n\n  var disambiguate = function disambiguate(tag, wrapper) {\n    if (tag === 'li') {\n      return wrapper === 'ol' ? 'ordered-list-item' : 'unordered-list-item';\n    }\n\n    return null;\n  };\n\n  return new ContentBlocksBuilder(blockTypeMap, disambiguate).addDOMNode(safeBody).getContentBlocks();\n};\n\nmodule.exports = convertFromHTMLToContentBlocks;","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/node_modules/draft-js/lib/convertFromHTMLToContentBlocks.js"],"names":["_knownListItemDepthCl","ownKeys","object","enumerableOnly","keys","Object","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","i","arguments","length","source","forEach","key","_defineProperty","getOwnPropertyDescriptors","defineProperties","defineProperty","obj","value","configurable","writable","CharacterMetadata","require","ContentBlock","ContentBlockNode","ContentState","DefaultDraftBlockRenderMap","URI","cx","generateRandomKey","getSafeBodyFromHTML","gkx","_require","List","Map","OrderedSet","isHTMLAnchorElement","isHTMLBRElement","isHTMLElement","isHTMLImageElement","experimentalTreeDataSupport","allowPastingAltText","NBSP","SPACE","REGEX_CR","RegExp","REGEX_LF","REGEX_LEADING_LF","REGEX_NBSP","REGEX_CARRIAGE","REGEX_ZWS","boldValues","notBoldValues","anchorAttr","imgAttr","knownListItemDepthClasses","HTMLTagToRawInlineStyleMap","b","code","del","em","s","strike","strong","u","mark","buildBlockTypeMap","blockRenderMap","blockTypeMap","mapKeys","blockType","desc","elements","element","aliasedElements","undefined","detectInlineStyle","node","style","fontFamily","includes","getListItemDepth","depth","some","depthClass","classList","contains","isValidAnchor","anchorNode","href","protocol","_","_unused","isValidImage","imageNode","attributes","getNamedItem","styleFromNodeAttributes","htmlElement","fontWeight","fontStyle","textDecoration","withMutations","indexOf","add","remove","isListNode","nodeName","ContentBlocksBuilder","disambiguate","createFromText","clear","_proto","prototype","characterList","blockConfigs","currentBlockType","currentDepth","currentEntity","currentText","contentState","wrapper","contentBlocks","addDOMNode","_this$blockConfigs","_toBlockConfigs","_trimCurrentText","_makeBlockConfig","getContentBlocks","_toContentBlocks","_toFlatContentBlocks","entityMap","getEntityMap","config","block","type","text","parent","children","prevSibling","nextSibling","childConfigs","nodes","toLowerCase","wasCurrentDepth","wasWrapper","Array","from","childNodes","get","_wasCurrentDepth","_wasWrapper","_addTextNode","_addBreakNode","_addImgNode","_addAnchorNode","newStyle","has","inlineStyle","_appendText","_this$characterList","characterMetadata","create","entity","fill","l","begin","trimLeft","end","trimRight","findEntry","getEntity","Math","min","reverse","max","slice","textContent","trimmedText","trim","replace","image","entityConfig","attr","imageAttribute","getAttribute","createEntity","getLastCreatedEntityKey","alt","anchor","anchorAttribute","url","toString","map","child","_hoistContainersInBlockConfigs","_this","hoisted","flatMap","blockConfig","_this2","cleanConfigs","_this2$_extractTextFr","_extractTextFromBlockConfigs","concat","last","convertFromHTMLToContentBlocks","html","DOMBuilder","safeBody","tag","module","exports"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n * \n * @format\n * @oncall draft_js\n */\n'use strict';\n\nvar _knownListItemDepthCl;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar CharacterMetadata = require(\"./CharacterMetadata\");\n\nvar ContentBlock = require(\"./ContentBlock\");\n\nvar ContentBlockNode = require(\"./ContentBlockNode\");\n\nvar ContentState = require(\"./ContentState\");\n\nvar DefaultDraftBlockRenderMap = require(\"./DefaultDraftBlockRenderMap\");\n\nvar URI = require(\"fbjs/lib/URI\");\n\nvar cx = require(\"fbjs/lib/cx\");\n\nvar generateRandomKey = require(\"./generateRandomKey\");\n\nvar getSafeBodyFromHTML = require(\"./getSafeBodyFromHTML\");\n\nvar gkx = require(\"./gkx\");\n\nvar _require = require(\"immutable\"),\n    List = _require.List,\n    Map = _require.Map,\n    OrderedSet = _require.OrderedSet;\n\nvar isHTMLAnchorElement = require(\"./isHTMLAnchorElement\");\n\nvar isHTMLBRElement = require(\"./isHTMLBRElement\");\n\nvar isHTMLElement = require(\"./isHTMLElement\");\n\nvar isHTMLImageElement = require(\"./isHTMLImageElement\");\n\nvar experimentalTreeDataSupport = gkx('draft_tree_data_support');\nvar allowPastingAltText = gkx('draftjs_paste_emojis');\nvar NBSP = '&nbsp;';\nvar SPACE = ' '; // used for replacing characters in HTML\n\nvar REGEX_CR = new RegExp('\\r', 'g');\nvar REGEX_LF = new RegExp('\\n', 'g');\nvar REGEX_LEADING_LF = new RegExp('^\\n', 'g');\nvar REGEX_NBSP = new RegExp(NBSP, 'g');\nvar REGEX_CARRIAGE = new RegExp('&#13;?', 'g');\nvar REGEX_ZWS = new RegExp('&#8203;?', 'g'); // https://developer.mozilla.org/en-US/docs/Web/CSS/font-weight\n\nvar boldValues = ['bold', 'bolder', '500', '600', '700', '800', '900'];\nvar notBoldValues = ['light', 'lighter', 'normal', '100', '200', '300', '400'];\nvar anchorAttr = ['className', 'href', 'rel', 'target', 'title'];\nvar imgAttr = ['alt', 'className', 'height', 'src', 'width'];\nvar knownListItemDepthClasses = (_knownListItemDepthCl = {}, _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth0'), 0), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth1'), 1), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth2'), 2), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth3'), 3), _defineProperty(_knownListItemDepthCl, cx('public/DraftStyleDefault/depth4'), 4), _knownListItemDepthCl);\nvar HTMLTagToRawInlineStyleMap = Map({\n  b: 'BOLD',\n  code: 'CODE',\n  del: 'STRIKETHROUGH',\n  em: 'ITALIC',\n  i: 'ITALIC',\n  s: 'STRIKETHROUGH',\n  strike: 'STRIKETHROUGH',\n  strong: 'BOLD',\n  u: 'UNDERLINE',\n  mark: 'HIGHLIGHT'\n});\n\n/**\n * Build a mapping from HTML tags to draftjs block types\n * out of a BlockRenderMap.\n *\n * The BlockTypeMap for the default BlockRenderMap looks like this:\n *   Map({\n *     h1: 'header-one',\n *     h2: 'header-two',\n *     h3: 'header-three',\n *     h4: 'header-four',\n *     h5: 'header-five',\n *     h6: 'header-six',\n *     blockquote: 'blockquote',\n *     figure: 'atomic',\n *     pre: ['code-block'],\n *     div: 'unstyled',\n *     p: 'unstyled',\n *     li: ['ordered-list-item', 'unordered-list-item'],\n *   })\n */\nvar buildBlockTypeMap = function buildBlockTypeMap(blockRenderMap) {\n  var blockTypeMap = {};\n  blockRenderMap.mapKeys(function (blockType, desc) {\n    var elements = [desc.element];\n\n    if (desc.aliasedElements !== undefined) {\n      elements.push.apply(elements, desc.aliasedElements);\n    }\n\n    elements.forEach(function (element) {\n      if (blockTypeMap[element] === undefined) {\n        blockTypeMap[element] = blockType;\n      } else if (typeof blockTypeMap[element] === 'string') {\n        blockTypeMap[element] = [blockTypeMap[element], blockType];\n      } else {\n        blockTypeMap[element].push(blockType);\n      }\n    });\n  });\n  return Map(blockTypeMap);\n};\n\nvar detectInlineStyle = function detectInlineStyle(node) {\n  if (isHTMLElement(node)) {\n    var element = node; // Currently only used to detect preformatted inline code\n\n    if (element.style.fontFamily.includes('monospace')) {\n      return 'CODE';\n    }\n  }\n\n  return null;\n};\n/**\n * If we're pasting from one DraftEditor to another we can check to see if\n * existing list item depth classes are being used and preserve this style\n */\n\n\nvar getListItemDepth = function getListItemDepth(node) {\n  var depth = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  Object.keys(knownListItemDepthClasses).some(function (depthClass) {\n    if (node.classList.contains(depthClass)) {\n      depth = knownListItemDepthClasses[depthClass];\n    }\n  });\n  return depth;\n};\n/**\n * Return true if the provided HTML Element can be used to build a\n * Draftjs-compatible link.\n */\n\n\nvar isValidAnchor = function isValidAnchor(node) {\n  if (!isHTMLAnchorElement(node)) {\n    return false;\n  }\n\n  var anchorNode = node;\n\n  if (!anchorNode.href || anchorNode.protocol !== 'http:' && anchorNode.protocol !== 'https:' && anchorNode.protocol !== 'mailto:' && anchorNode.protocol !== 'tel:') {\n    return false;\n  }\n\n  try {\n    // Just checking whether we can actually create a URI\n    var _ = new URI(anchorNode.href);\n\n    return true;\n  } catch (_unused) {\n    return false;\n  }\n};\n/**\n * Return true if the provided HTML Element can be used to build a\n * Draftjs-compatible image.\n */\n\n\nvar isValidImage = function isValidImage(node) {\n  if (!isHTMLImageElement(node)) {\n    return false;\n  }\n\n  var imageNode = node;\n  return !!(imageNode.attributes.getNamedItem('src') && imageNode.attributes.getNamedItem('src').value);\n};\n/**\n * Try to guess the inline style of an HTML element based on its css\n * styles (font-weight, font-style and text-decoration).\n */\n\n\nvar styleFromNodeAttributes = function styleFromNodeAttributes(node, style) {\n  if (!isHTMLElement(node)) {\n    return style;\n  }\n\n  var htmlElement = node;\n  var fontWeight = htmlElement.style.fontWeight;\n  var fontStyle = htmlElement.style.fontStyle;\n  var textDecoration = htmlElement.style.textDecoration;\n  return style.withMutations(function (style) {\n    if (boldValues.indexOf(fontWeight) >= 0) {\n      style.add('BOLD');\n    } else if (notBoldValues.indexOf(fontWeight) >= 0) {\n      style.remove('BOLD');\n    }\n\n    if (fontStyle === 'italic') {\n      style.add('ITALIC');\n    } else if (fontStyle === 'normal') {\n      style.remove('ITALIC');\n    }\n\n    if (textDecoration === 'underline') {\n      style.add('UNDERLINE');\n    }\n\n    if (textDecoration === 'line-through') {\n      style.add('STRIKETHROUGH');\n    }\n\n    if (textDecoration === 'none') {\n      style.remove('UNDERLINE');\n      style.remove('STRIKETHROUGH');\n    }\n  });\n};\n/**\n * Determine if a nodeName is a list type, 'ul' or 'ol'\n */\n\n\nvar isListNode = function isListNode(nodeName) {\n  return nodeName === 'ul' || nodeName === 'ol';\n};\n/**\n *  ContentBlockConfig is a mutable data structure that holds all\n *  the information required to build a ContentBlock and an array of\n *  all the child nodes (childConfigs).\n *  It is being used a temporary data structure by the\n *  ContentBlocksBuilder class.\n */\n\n\n/**\n * ContentBlocksBuilder builds a list of ContentBlocks and an Entity Map\n * out of one (or several) HTMLElement(s).\n *\n * The algorithm has two passes: first it builds a tree of ContentBlockConfigs\n * by walking through the HTML nodes and their children, then it walks the\n * ContentBlockConfigs tree to compute parents/siblings and create\n * the actual ContentBlocks.\n *\n * Typical usage is:\n *     new ContentBlocksBuilder()\n *        .addDOMNode(someHTMLNode)\n *        .addDOMNode(someOtherHTMLNode)\n *       .getContentBlocks();\n *\n */\nvar ContentBlocksBuilder = /*#__PURE__*/function () {\n  // Most of the method in the class depend on the state of the content builder\n  // (i.e. currentBlockType, currentDepth, currentEntity etc.). Though it may\n  // be confusing at first, it made the code simpler than the alternative which\n  // is to pass those values around in every call.\n  // The following attributes are used to accumulate text and styles\n  // as we are walking the HTML node tree.\n  // Describes the future ContentState as a tree of content blocks\n  // The content blocks generated from the blockConfigs\n  // Entity map use to store links and images found in the HTML nodes\n  // Map HTML tags to draftjs block types and disambiguation function\n  function ContentBlocksBuilder(blockTypeMap, disambiguate) {\n    _defineProperty(this, \"characterList\", List());\n\n    _defineProperty(this, \"currentBlockType\", 'unstyled');\n\n    _defineProperty(this, \"currentDepth\", 0);\n\n    _defineProperty(this, \"currentEntity\", null);\n\n    _defineProperty(this, \"currentText\", '');\n\n    _defineProperty(this, \"wrapper\", null);\n\n    _defineProperty(this, \"blockConfigs\", []);\n\n    _defineProperty(this, \"contentBlocks\", []);\n\n    _defineProperty(this, \"contentState\", ContentState.createFromText(''));\n\n    _defineProperty(this, \"blockTypeMap\", void 0);\n\n    _defineProperty(this, \"disambiguate\", void 0);\n\n    this.clear();\n    this.blockTypeMap = blockTypeMap;\n    this.disambiguate = disambiguate;\n  }\n  /**\n   * Clear the internal state of the ContentBlocksBuilder\n   */\n\n\n  var _proto = ContentBlocksBuilder.prototype;\n\n  _proto.clear = function clear() {\n    this.characterList = List();\n    this.blockConfigs = [];\n    this.currentBlockType = 'unstyled';\n    this.currentDepth = 0;\n    this.currentEntity = null;\n    this.currentText = '';\n    this.contentState = ContentState.createFromText('');\n    this.wrapper = null;\n    this.contentBlocks = [];\n  }\n  /**\n   * Add an HTMLElement to the ContentBlocksBuilder\n   */\n  ;\n\n  _proto.addDOMNode = function addDOMNode(node) {\n    var _this$blockConfigs;\n\n    this.contentBlocks = [];\n    this.currentDepth = 0; // Converts the HTML node to block config\n\n    (_this$blockConfigs = this.blockConfigs).push.apply(_this$blockConfigs, this._toBlockConfigs([node], OrderedSet())); // There might be some left over text in the builder's\n    // internal state, if so make a ContentBlock out of it.\n\n\n    this._trimCurrentText();\n\n    if (this.currentText !== '') {\n      this.blockConfigs.push(this._makeBlockConfig());\n    } // for chaining\n\n\n    return this;\n  }\n  /**\n   * Return the ContentBlocks and the EntityMap that corresponds\n   * to the previously added HTML nodes.\n   */\n  ;\n\n  _proto.getContentBlocks = function getContentBlocks() {\n    if (this.contentBlocks.length === 0) {\n      if (experimentalTreeDataSupport) {\n        this._toContentBlocks(this.blockConfigs);\n      } else {\n        this._toFlatContentBlocks(this.blockConfigs);\n      }\n    }\n\n    return {\n      contentBlocks: this.contentBlocks,\n      entityMap: this.contentState.getEntityMap()\n    };\n  } // ***********************************WARNING******************************\n  // The methods below this line are private - don't call them directly.\n\n  /**\n   * Generate a new ContentBlockConfig out of the current internal state\n   * of the builder, then clears the internal state.\n   */\n  ;\n\n  _proto._makeBlockConfig = function _makeBlockConfig() {\n    var config = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var key = config.key || generateRandomKey();\n\n    var block = _objectSpread({\n      key: key,\n      type: this.currentBlockType,\n      text: this.currentText,\n      characterList: this.characterList,\n      depth: this.currentDepth,\n      parent: null,\n      children: List(),\n      prevSibling: null,\n      nextSibling: null,\n      childConfigs: []\n    }, config);\n\n    this.characterList = List();\n    this.currentBlockType = 'unstyled';\n    this.currentText = '';\n    return block;\n  }\n  /**\n   * Converts an array of HTML elements to a multi-root tree of content\n   * block configs. Some text content may be left in the builders internal\n   * state to enable chaining sucessive calls.\n   */\n  ;\n\n  _proto._toBlockConfigs = function _toBlockConfigs(nodes, style) {\n    var blockConfigs = [];\n\n    for (var i = 0; i < nodes.length; i++) {\n      var node = nodes[i];\n      var nodeName = node.nodeName.toLowerCase();\n\n      if (nodeName === 'body' || isListNode(nodeName)) {\n        // body, ol and ul are 'block' type nodes so create a block config\n        // with the text accumulated so far (if any)\n        this._trimCurrentText();\n\n        if (this.currentText !== '') {\n          blockConfigs.push(this._makeBlockConfig());\n        } // body, ol and ul nodes are ignored, but their children are inlined in\n        // the parent block config.\n\n\n        var wasCurrentDepth = this.currentDepth;\n        var wasWrapper = this.wrapper;\n\n        if (isListNode(nodeName)) {\n          this.wrapper = nodeName;\n\n          if (isListNode(wasWrapper)) {\n            this.currentDepth++;\n          }\n        }\n\n        blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), style));\n        this.currentDepth = wasCurrentDepth;\n        this.wrapper = wasWrapper;\n        continue;\n      }\n\n      var blockType = this.blockTypeMap.get(nodeName);\n\n      if (blockType !== undefined) {\n        // 'block' type node means we need to create a block config\n        // with the text accumulated so far (if any)\n        this._trimCurrentText();\n\n        if (this.currentText !== '') {\n          blockConfigs.push(this._makeBlockConfig());\n        }\n\n        var _wasCurrentDepth = this.currentDepth;\n        var _wasWrapper = this.wrapper;\n        this.wrapper = nodeName === 'pre' ? 'pre' : this.wrapper;\n\n        if (typeof blockType !== 'string') {\n          blockType = this.disambiguate(nodeName, this.wrapper) || blockType[0] || 'unstyled';\n        }\n\n        if (!experimentalTreeDataSupport && isHTMLElement(node) && (blockType === 'unordered-list-item' || blockType === 'ordered-list-item')) {\n          var htmlElement = node;\n          this.currentDepth = getListItemDepth(htmlElement, this.currentDepth);\n        }\n\n        var key = generateRandomKey();\n\n        var childConfigs = this._toBlockConfigs(Array.from(node.childNodes), style);\n\n        this._trimCurrentText();\n\n        blockConfigs.push(this._makeBlockConfig({\n          key: key,\n          childConfigs: childConfigs,\n          type: blockType\n        }));\n        this.currentDepth = _wasCurrentDepth;\n        this.wrapper = _wasWrapper;\n        continue;\n      }\n\n      if (nodeName === '#text') {\n        this._addTextNode(node, style);\n\n        continue;\n      }\n\n      if (nodeName === 'br') {\n        this._addBreakNode(node, style);\n\n        continue;\n      }\n\n      if (isValidImage(node)) {\n        this._addImgNode(node, style);\n\n        continue;\n      }\n\n      if (isValidAnchor(node)) {\n        this._addAnchorNode(node, blockConfigs, style);\n\n        continue;\n      }\n\n      var newStyle = style;\n\n      if (HTMLTagToRawInlineStyleMap.has(nodeName)) {\n        newStyle = newStyle.add(HTMLTagToRawInlineStyleMap.get(nodeName));\n      }\n\n      newStyle = styleFromNodeAttributes(node, newStyle);\n      var inlineStyle = detectInlineStyle(node);\n\n      if (inlineStyle != null) {\n        newStyle = newStyle.add(inlineStyle);\n      }\n\n      blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), newStyle));\n    }\n\n    return blockConfigs;\n  }\n  /**\n   * Append a string of text to the internal buffer.\n   */\n  ;\n\n  _proto._appendText = function _appendText(text, style) {\n    var _this$characterList;\n\n    this.currentText += text;\n    var characterMetadata = CharacterMetadata.create({\n      style: style,\n      entity: this.currentEntity\n    });\n    this.characterList = (_this$characterList = this.characterList).push.apply(_this$characterList, Array(text.length).fill(characterMetadata));\n  }\n  /**\n   * Trim the text in the internal buffer.\n   */\n  ;\n\n  _proto._trimCurrentText = function _trimCurrentText() {\n    var l = this.currentText.length;\n    var begin = l - this.currentText.trimLeft().length;\n    var end = this.currentText.trimRight().length; // We should not trim whitespaces for which an entity is defined.\n\n    var entity = this.characterList.findEntry(function (characterMetadata) {\n      return characterMetadata.getEntity() !== null;\n    });\n    begin = entity !== undefined ? Math.min(begin, entity[0]) : begin;\n    entity = this.characterList.reverse().findEntry(function (characterMetadata) {\n      return characterMetadata.getEntity() !== null;\n    });\n    end = entity !== undefined ? Math.max(end, l - entity[0]) : end;\n\n    if (begin > end) {\n      this.currentText = '';\n      this.characterList = List();\n    } else {\n      this.currentText = this.currentText.slice(begin, end);\n      this.characterList = this.characterList.slice(begin, end);\n    }\n  }\n  /**\n   * Add the content of an HTML text node to the internal state\n   */\n  ;\n\n  _proto._addTextNode = function _addTextNode(node, style) {\n    var text = node.textContent;\n    var trimmedText = text.trim(); // If we are not in a pre block and the trimmed content is empty,\n    // normalize to a single space.\n\n    if (trimmedText === '' && this.wrapper !== 'pre') {\n      text = ' ';\n    }\n\n    if (this.wrapper !== 'pre') {\n      // Trim leading line feed, which is invisible in HTML\n      text = text.replace(REGEX_LEADING_LF, ''); // Can't use empty string because MSWord\n\n      text = text.replace(REGEX_LF, SPACE);\n    }\n\n    this._appendText(text, style);\n  };\n\n  _proto._addBreakNode = function _addBreakNode(node, style) {\n    if (!isHTMLBRElement(node)) {\n      return;\n    }\n\n    this._appendText('\\n', style);\n  }\n  /**\n   * Add the content of an HTML img node to the internal state\n   */\n  ;\n\n  _proto._addImgNode = function _addImgNode(node, style) {\n    if (!isHTMLImageElement(node)) {\n      return;\n    }\n\n    var image = node;\n    var entityConfig = {};\n    imgAttr.forEach(function (attr) {\n      var imageAttribute = image.getAttribute(attr);\n\n      if (imageAttribute) {\n        entityConfig[attr] = imageAttribute;\n      }\n    });\n    this.contentState = this.contentState.createEntity('IMAGE', 'IMMUTABLE', entityConfig);\n    this.currentEntity = this.contentState.getLastCreatedEntityKey(); // The child text node cannot just have a space or return as content (since\n    // we strip those out)\n\n    var alt = image.getAttribute('alt');\n\n    if (allowPastingAltText && alt != null && alt.length > 0) {\n      this._appendText(alt, style);\n    } else {\n      this._appendText(\"\\uD83D\\uDCF7\", style);\n    }\n\n    this.currentEntity = null;\n  }\n  /**\n   * Add the content of an HTML 'a' node to the internal state. Child nodes\n   * (if any) are converted to Block Configs and appended to the provided\n   * blockConfig array.\n   */\n  ;\n\n  _proto._addAnchorNode = function _addAnchorNode(node, blockConfigs, style) {\n    // The check has already been made by isValidAnchor but\n    // we have to do it again to keep flow happy.\n    if (!isHTMLAnchorElement(node)) {\n      return;\n    }\n\n    var anchor = node;\n    var entityConfig = {};\n    anchorAttr.forEach(function (attr) {\n      var anchorAttribute = anchor.getAttribute(attr);\n\n      if (anchorAttribute) {\n        entityConfig[attr] = anchorAttribute;\n      }\n    });\n    entityConfig.url = new URI(anchor.href).toString();\n    this.contentState = this.contentState.createEntity('LINK', 'MUTABLE', entityConfig || {});\n    this.currentEntity = this.contentState.getLastCreatedEntityKey();\n    blockConfigs.push.apply(blockConfigs, this._toBlockConfigs(Array.from(node.childNodes), style));\n    this.currentEntity = null;\n  }\n  /**\n   * Walk the BlockConfig tree, compute parent/children/siblings,\n   * and generate the corresponding ContentBlockNode\n   */\n  ;\n\n  _proto._toContentBlocks = function _toContentBlocks(blockConfigs) {\n    var parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n    var l = blockConfigs.length - 1;\n\n    for (var i = 0; i <= l; i++) {\n      var config = blockConfigs[i];\n      config.parent = parent;\n      config.prevSibling = i > 0 ? blockConfigs[i - 1].key : null;\n      config.nextSibling = i < l ? blockConfigs[i + 1].key : null;\n      config.children = List(config.childConfigs.map(function (child) {\n        return child.key;\n      }));\n      this.contentBlocks.push(new ContentBlockNode(_objectSpread({}, config)));\n\n      this._toContentBlocks(config.childConfigs, config.key);\n    }\n  }\n  /**\n   * Remove 'useless' container nodes from the block config hierarchy, by\n   * replacing them with their children.\n   */\n  ;\n\n  _proto._hoistContainersInBlockConfigs = function _hoistContainersInBlockConfigs(blockConfigs) {\n    var _this = this;\n\n    var hoisted = List(blockConfigs).flatMap(function (blockConfig) {\n      // Don't mess with useful blocks\n      if (blockConfig.type !== 'unstyled' || blockConfig.text !== '') {\n        return [blockConfig];\n      }\n\n      return _this._hoistContainersInBlockConfigs(blockConfig.childConfigs);\n    });\n    return hoisted;\n  } // ***********************************************************************\n  // The two methods below are used for backward compatibility when\n  // experimentalTreeDataSupport is disabled.\n\n  /**\n   * Same as _toContentBlocks but replaces nested blocks by their\n   * text content.\n   */\n  ;\n\n  _proto._toFlatContentBlocks = function _toFlatContentBlocks(blockConfigs) {\n    var _this2 = this;\n\n    var cleanConfigs = this._hoistContainersInBlockConfigs(blockConfigs);\n\n    cleanConfigs.forEach(function (config) {\n      var _this2$_extractTextFr = _this2._extractTextFromBlockConfigs(config.childConfigs),\n          text = _this2$_extractTextFr.text,\n          characterList = _this2$_extractTextFr.characterList;\n\n      _this2.contentBlocks.push(new ContentBlock(_objectSpread(_objectSpread({}, config), {}, {\n        text: config.text + text,\n        characterList: config.characterList.concat(characterList)\n      })));\n    });\n  }\n  /**\n   * Extract the text and the associated inline styles form an\n   * array of content block configs.\n   */\n  ;\n\n  _proto._extractTextFromBlockConfigs = function _extractTextFromBlockConfigs(blockConfigs) {\n    var l = blockConfigs.length - 1;\n    var text = '';\n    var characterList = List();\n\n    for (var i = 0; i <= l; i++) {\n      var config = blockConfigs[i];\n      text += config.text;\n      characterList = characterList.concat(config.characterList);\n\n      if (text !== '' && config.type !== 'unstyled') {\n        text += '\\n';\n        characterList = characterList.push(characterList.last());\n      }\n\n      var children = this._extractTextFromBlockConfigs(config.childConfigs);\n\n      text += children.text;\n      characterList = characterList.concat(children.characterList);\n    }\n\n    return {\n      text: text,\n      characterList: characterList\n    };\n  };\n\n  return ContentBlocksBuilder;\n}();\n/**\n * Converts an HTML string to an array of ContentBlocks and an EntityMap\n * suitable to initialize the internal state of a Draftjs component.\n */\n\n\nvar convertFromHTMLToContentBlocks = function convertFromHTMLToContentBlocks(html) {\n  var DOMBuilder = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getSafeBodyFromHTML;\n  var blockRenderMap = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : DefaultDraftBlockRenderMap;\n  // Be ABSOLUTELY SURE that the dom builder you pass here won't execute\n  // arbitrary code in whatever environment you're running this in. For an\n  // example of how we try to do this in-browser, see getSafeBodyFromHTML.\n  // Remove funky characters from the HTML string\n  html = html.trim().replace(REGEX_CR, '').replace(REGEX_NBSP, SPACE).replace(REGEX_CARRIAGE, '').replace(REGEX_ZWS, ''); // Build a DOM tree out of the HTML string\n\n  var safeBody = DOMBuilder(html);\n\n  if (!safeBody) {\n    return null;\n  } // Build a BlockTypeMap out of the BlockRenderMap\n\n\n  var blockTypeMap = buildBlockTypeMap(blockRenderMap); // Select the proper block type for the cases where the blockRenderMap\n  // uses multiple block types for the same html tag.\n\n  var disambiguate = function disambiguate(tag, wrapper) {\n    if (tag === 'li') {\n      return wrapper === 'ol' ? 'ordered-list-item' : 'unordered-list-item';\n    }\n\n    return null;\n  };\n\n  return new ContentBlocksBuilder(blockTypeMap, disambiguate).addDOMNode(safeBody).getContentBlocks();\n};\n\nmodule.exports = convertFromHTMLToContentBlocks;"]},"metadata":{},"sourceType":"script"}