{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Rajesh\\\\Downloads\\\\bilim (2)\\\\bilim\\\\v1.0\\\\editors\\\\BlmCourseEditor\\\\src\\\\components\\\\shared\\\\media-editor\\\\components\\\\main-timeline\\\\cue\\\\BlmMainCue.tsx\";\nimport React, { useMemo } from \"react\";\nimport clamp from \"lodash/clamp\";\nimport clsx from \"clsx\";\nimport { BlmTransformComponent, DragGeometry, MovementConstraint, SizeConstraint } from \"shared\";\nimport { convertTimeToXPos, convertXPosToTime } from \"../../../utils\";\nimport { useMediaEditorContext } from \"../../context\";\nimport \"./styles.scss\";\n\nfunction BlmMainCue(props) {\n  const {\n    data,\n    index,\n    wavesurfer,\n    minTime,\n    maxTime,\n    selected,\n    invalid,\n    onChange,\n    onDelete,\n    onTimeChange,\n    onContextMenu\n  } = props;\n  const {\n    mainOffset,\n    mainMinWidth\n  } = useMediaEditorContext();\n  const {\n    startTime,\n    endTime,\n    text\n  } = data;\n  const {\n    scrollTime,\n    duration,\n    pxPerSec\n  } = wavesurfer;\n  const minimum = minTime !== undefined ? minTime + mainOffset : 0;\n  const maximum = maxTime !== undefined ? maxTime - mainOffset : duration;\n  const model = useMemo(() => {\n    const startX = convertTimeToXPos(startTime, pxPerSec, scrollTime);\n    const endX = convertTimeToXPos(endTime, pxPerSec, scrollTime);\n    const result = new DragGeometry(startX, 38, endX - startX, 141);\n    return result;\n  }, [startTime, endTime, pxPerSec, scrollTime]);\n  const constraints = useMemo(() => {\n    const move = new MovementConstraint(NaN, 38, NaN, 38);\n    const size = new SizeConstraint();\n    move.minX = convertTimeToXPos(minimum, pxPerSec, scrollTime);\n    move.maxX = convertTimeToXPos(maximum, pxPerSec, scrollTime);\n    size.minWidth = convertTimeToXPos(mainMinWidth, pxPerSec);\n    return [move, size];\n  }, [minimum, maximum, mainMinWidth, pxPerSec, scrollTime]);\n\n  const updateChange = newData => {\n    if (onChange) {\n      onChange(data, newData);\n    }\n  };\n\n  const updateTime = time => {\n    if (onTimeChange) {\n      onTimeChange(time);\n    }\n  };\n\n  const updateDelete = () => {\n    if (onDelete) {\n      onDelete(data);\n    }\n  };\n\n  const handleChange = newModel => {\n    const {\n      x,\n      width\n    } = newModel;\n    const newData = { ...data\n    };\n    newData.startTime = convertXPosToTime(x, pxPerSec, scrollTime);\n    newData.endTime = convertXPosToTime(x + width, pxPerSec, scrollTime);\n    updateChange(newData);\n  };\n\n  const handleClick = () => {\n    updateTime(startTime + 0.001);\n  };\n\n  const handleDoubleClick = () => {\n    const newData = { ...data,\n      startTime: minTime ? minimum : startTime,\n      endTime: maxTime ? maximum : endTime\n    };\n    updateChange(newData);\n  };\n\n  const handleKeyDown = event => {\n    const keyCode = event.keyCode;\n\n    switch (keyCode) {\n      case 37:\n        updateChange({ ...data,\n          startTime: clamp(startTime - 0.1, minimum, maximum),\n          endTime: clamp(endTime - 0.1, minimum, maximum)\n        });\n        updateTime(startTime - 0.1);\n        break;\n\n      case 39:\n        updateChange({ ...data,\n          startTime: clamp(startTime + 0.1, minimum, maximum),\n          endTime: clamp(endTime + 0.1, minimum, maximum)\n        });\n        updateTime(startTime + 0.1);\n        break;\n\n      case 8:\n      case 46:\n        updateDelete();\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  const handleContextMenu = event => {\n    if (onContextMenu) {\n      onContextMenu(event, data);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(BlmTransformComponent, {\n    tabIndex: index,\n    data: model,\n    hanldes: \"w,e\",\n    constraints: constraints,\n    className: clsx(\"main-cue-wrapper\", {\n      selected,\n      invalid\n    }),\n    onChange: handleChange,\n    onClick: handleClick,\n    onDoubleClick: handleDoubleClick,\n    onKeyDown: handleKeyDown,\n    onContextMenu: handleContextMenu,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"main-cue-lbl\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }\n  }, text));\n}\n\nexport default BlmMainCue;","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/src/components/shared/media-editor/components/main-timeline/cue/BlmMainCue.tsx"],"names":["React","useMemo","clamp","clsx","BlmTransformComponent","DragGeometry","MovementConstraint","SizeConstraint","convertTimeToXPos","convertXPosToTime","useMediaEditorContext","BlmMainCue","props","data","index","wavesurfer","minTime","maxTime","selected","invalid","onChange","onDelete","onTimeChange","onContextMenu","mainOffset","mainMinWidth","startTime","endTime","text","scrollTime","duration","pxPerSec","minimum","undefined","maximum","model","startX","endX","result","constraints","move","NaN","size","minX","maxX","minWidth","updateChange","newData","updateTime","time","updateDelete","handleChange","newModel","x","width","handleClick","handleDoubleClick","handleKeyDown","event","keyCode","handleContextMenu"],"mappings":"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","sourcesContent":["import React, { useMemo, KeyboardEvent, MouseEvent } from \"react\";\r\nimport clamp from \"lodash/clamp\";\r\nimport clsx from \"clsx\";\r\n\r\nimport { MediaTrackCue, MediaWavesurfer } from \"types\";\r\nimport { BlmTransformComponent, DragGeometry, MovementConstraint, SizeConstraint } from \"shared\";\r\nimport { convertTimeToXPos, convertXPosToTime } from \"../../../utils\";\r\nimport { useMediaEditorContext } from \"../../context\";\r\nimport \"./styles.scss\";\r\n\r\nexport interface MainCueProps {\r\n  data: MediaTrackCue;\r\n  index: number;\r\n  wavesurfer: MediaWavesurfer;\r\n  minTime?: number;\r\n  maxTime?: number;\r\n  selected?: boolean;\r\n  invalid?: boolean;\r\n  onChange?: (oldData: MediaTrackCue, newData: MediaTrackCue) => void;\r\n  onDelete?: (data: MediaTrackCue) => void;\r\n  onTimeChange?: (time: number) => void;\r\n  onContextMenu?: (event: MouseEvent, data: MediaTrackCue) => void;\r\n}\r\n\r\nfunction BlmMainCue(props: MainCueProps) {\r\n  const {\r\n    data,\r\n    index,\r\n    wavesurfer,\r\n    minTime,\r\n    maxTime,\r\n    selected,\r\n    invalid,\r\n    onChange,\r\n    onDelete,\r\n    onTimeChange,\r\n    onContextMenu,\r\n  } = props;\r\n  const { mainOffset, mainMinWidth } = useMediaEditorContext();\r\n  const { startTime, endTime, text } = data;\r\n  const { scrollTime, duration, pxPerSec } = wavesurfer;\r\n  const minimum = minTime !== undefined ? minTime + mainOffset : 0;\r\n  const maximum = maxTime !== undefined ? maxTime - mainOffset : duration;\r\n\r\n  const model = useMemo(() => {\r\n    const startX = convertTimeToXPos(startTime, pxPerSec, scrollTime);\r\n    const endX = convertTimeToXPos(endTime, pxPerSec, scrollTime);\r\n    const result = new DragGeometry(startX, 38, endX - startX, 141);\r\n\r\n    return result;\r\n  }, [startTime, endTime, pxPerSec, scrollTime]);\r\n\r\n  const constraints = useMemo(() => {\r\n    const move = new MovementConstraint(NaN, 38, NaN, 38);\r\n    const size = new SizeConstraint();\r\n\r\n    move.minX = convertTimeToXPos(minimum, pxPerSec, scrollTime);\r\n    move.maxX = convertTimeToXPos(maximum, pxPerSec, scrollTime);\r\n\r\n    size.minWidth = convertTimeToXPos(mainMinWidth, pxPerSec);\r\n\r\n    return [move, size];\r\n  }, [minimum, maximum, mainMinWidth, pxPerSec, scrollTime]);\r\n\r\n  const updateChange = (newData: MediaTrackCue) => {\r\n    if (onChange) {\r\n      onChange(data, newData);\r\n    }\r\n  };\r\n\r\n  const updateTime = (time: number) => {\r\n    if (onTimeChange) {\r\n      onTimeChange(time);\r\n    }\r\n  };\r\n\r\n  const updateDelete = () => {\r\n    if (onDelete) {\r\n      onDelete(data);\r\n    }\r\n  };\r\n\r\n  const handleChange = (newModel: DragGeometry) => {\r\n    const { x, width } = newModel;\r\n    const newData = { ...data };\r\n\r\n    newData.startTime = convertXPosToTime(x, pxPerSec, scrollTime);\r\n    newData.endTime = convertXPosToTime(x + width, pxPerSec, scrollTime);\r\n\r\n    updateChange(newData);\r\n  };\r\n\r\n  const handleClick = () => {\r\n    updateTime(startTime + 0.001);\r\n  };\r\n\r\n  const handleDoubleClick = () => {\r\n    const newData = {\r\n      ...data,\r\n      startTime: minTime ? minimum : startTime,\r\n      endTime: maxTime ? maximum : endTime,\r\n    };\r\n\r\n    updateChange(newData);\r\n  };\r\n\r\n  const handleKeyDown = (event: KeyboardEvent) => {\r\n    const keyCode = event.keyCode;\r\n\r\n    switch (keyCode) {\r\n      case 37:\r\n        updateChange({\r\n          ...data,\r\n          startTime: clamp(startTime - 0.1, minimum, maximum),\r\n          endTime: clamp(endTime - 0.1, minimum, maximum),\r\n        });\r\n        updateTime(startTime - 0.1);\r\n        break;\r\n      case 39:\r\n        updateChange({\r\n          ...data,\r\n          startTime: clamp(startTime + 0.1, minimum, maximum),\r\n          endTime: clamp(endTime + 0.1, minimum, maximum),\r\n        });\r\n        updateTime(startTime + 0.1);\r\n        break;\r\n      case 8:\r\n      case 46:\r\n        updateDelete();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  const handleContextMenu = (event: MouseEvent) => {\r\n    if (onContextMenu) {\r\n      onContextMenu(event, data);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <BlmTransformComponent\r\n      tabIndex={index}\r\n      data={model}\r\n      hanldes=\"w,e\"\r\n      constraints={constraints}\r\n      className={clsx(\"main-cue-wrapper\", { selected, invalid })}\r\n      onChange={handleChange}\r\n      onClick={handleClick}\r\n      onDoubleClick={handleDoubleClick}\r\n      onKeyDown={handleKeyDown}\r\n      onContextMenu={handleContextMenu}\r\n    >\r\n      <div className=\"main-cue-lbl\">{text}</div>\r\n    </BlmTransformComponent>\r\n  );\r\n}\r\n\r\nexport default BlmMainCue;\r\n"]},"metadata":{},"sourceType":"module"}