{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Rajesh\\\\Downloads\\\\bilim (2)\\\\bilim\\\\v1.0\\\\editors\\\\BlmCourseEditor\\\\src\\\\components\\\\content-editor\\\\components\\\\media\\\\hotspot\\\\360\\\\BlmHotspot360.tsx\";\nimport React, { Fragment, useMemo, useState } from \"react\";\nimport { Tabs, Tab } from \"@material-ui/core\";\nimport { useTranslation } from \"react-i18next\";\nimport { MediaHotspot } from \"types\";\nimport { createShortUUID, findObject, isGoto360Action, updateObject, validateHotspot, validateHotspotItem } from \"utils\";\nimport { useContentEditorCtx } from \"components/content-editor/core\";\nimport { updateMedia360Option, updateMediaComponent } from \"components/content-editor/reducers\";\nimport BlmHotspotHeader from \"../header\";\nimport BlmHotspotPicker from \"../picker\";\nimport BlmHotspotItemProps from \"../properties\";\nimport { BlmHotspot360Provider } from \"./context\";\nimport \"./styles.scss\";\nimport BlmHotspot360Options from \"./BlmHotspot360Options\";\n\nfunction BlmHotspot360(props) {\n  const {\n    data,\n    openDialog,\n    openConfirmDialog,\n    openModal,\n    onClose,\n    onSave\n  } = props;\n  const [hotspotId, setHotspotId] = useState();\n  const [itemId, setItemdId] = useState();\n  const [name, setName] = useState();\n  const {\n    element,\n    template,\n    dispatch\n  } = useContentEditorCtx();\n  const {\n    t\n  } = useTranslation(\"content-editor\");\n  const {\n    value\n  } = data;\n  const {\n    items\n  } = value;\n  const selectedHotspot = useMemo(() => hotspotId && items && findObject(items, hotspotId, \"id\") || (items === null || items === void 0 ? void 0 : items[0]), [items, hotspotId]);\n  const selectedIndex = useMemo(() => {\n    var _ref;\n\n    return (_ref = items && selectedHotspot && items.indexOf(selectedHotspot)) !== null && _ref !== void 0 ? _ref : 0;\n  }, [items, selectedHotspot]);\n  const selectedItem = useMemo(() => {\n    if (selectedHotspot) {\n      const {\n        items\n      } = selectedHotspot;\n      return itemId && items && findObject(items, itemId, \"id\") || (items === null || items === void 0 ? void 0 : items[0]);\n    }\n  }, [selectedHotspot, itemId]);\n  const isLinkedMedia = useMemo(() => {\n    if (selectedHotspot.media) {\n      return items.findIndex(item => {\n        var _item$media, _selectedHotspot$medi;\n\n        return item.id !== selectedHotspot.id && ((_item$media = item.media) === null || _item$media === void 0 ? void 0 : _item$media.id) === ((_selectedHotspot$medi = selectedHotspot.media) === null || _selectedHotspot$medi === void 0 ? void 0 : _selectedHotspot$medi.id);\n      }) !== -1;\n    }\n\n    return false;\n  }, [items, selectedHotspot]);\n  const isLinkedItem = useMemo(() => {\n    if (selectedItem && selectedItem.media) {\n      return items.findIndex(item => {\n        return item.items.findIndex(item2 => {\n          var _item2$media, _selectedItem$media;\n\n          return item2.id !== selectedItem.id && ((_item2$media = item2.media) === null || _item2$media === void 0 ? void 0 : _item2$media.id) === ((_selectedItem$media = selectedItem.media) === null || _selectedItem$media === void 0 ? void 0 : _selectedItem$media.id);\n        }) !== -1;\n      }) !== -1;\n    }\n\n    return false;\n  }, [items, selectedItem]);\n\n  const updateChange = newValue => {\n    const newData = { ...data,\n      value: newValue\n    };\n\n    if (dispatch) {\n      dispatch(updateMediaComponent(newData));\n    }\n  };\n\n  const update360Options = newValue => {\n    const newData = { ...data,\n      options2: newValue\n    };\n\n    if (dispatch) {\n      dispatch(updateMedia360Option(newData));\n    }\n  };\n\n  const updateHotspot = newHotspot => {\n    const newValue = { ...data.value,\n      items: updateObject(items, \"id\", selectedHotspot.id, newHotspot)\n    };\n    updateChange(newValue);\n  };\n\n  const duplicateHotspot = hotspot => {\n    const newInd = items.indexOf(hotspot);\n    const newItems = [...items];\n    const newHotspot = { ...hotspot\n    };\n\n    const cloneAction = action => {\n      return action && { ...action,\n        value: action.value && { ...action.value\n        }\n      };\n    };\n\n    newHotspot.id = createShortUUID();\n    newHotspot.name = newHotspot.name + \"-copy\";\n    newHotspot.groups = { ...newHotspot.groups,\n      items: newHotspot.groups.items.map(group => {\n        return { ...group\n        };\n      })\n    };\n    newHotspot.items = newHotspot.items.map(item => {\n      const {\n        clickAction,\n        overAction\n      } = item;\n      return { ...item,\n        id: createShortUUID(),\n        clickAction: cloneAction(clickAction),\n        overAction: cloneAction(overAction)\n      };\n    });\n    newItems.splice(newInd + 1, 0, newHotspot);\n    updateChange({ ...value,\n      items: newItems\n    });\n  };\n\n  const deleteHotspot = hotspot => {\n    const newItemes = items.filter(item => item.id !== hotspot.id);\n\n    const updateAction = action => {\n      var _action$value;\n\n      if (action && isGoto360Action(action) && ((_action$value = action.value) === null || _action$value === void 0 ? void 0 : _action$value.gotoId) === hotspot.id) {\n        action.value.gotoId = undefined;\n      }\n    };\n\n    newItemes.forEach(item => {\n      item.items.forEach(item2 => {\n        updateAction(item2.clickAction);\n        updateAction(item2.overAction);\n      });\n    });\n    updateChange({ ...value,\n      items: newItemes\n    });\n  };\n\n  const validateHotspot360 = (hotspot, callback) => {\n    if (hotspot) {\n      try {\n        if (template) {\n          validateHotspot(hotspot, template);\n          callback();\n        }\n      } catch (error) {\n        if (openDialog) {\n          openDialog(t(\"alert.warning\"), error.message);\n        }\n      }\n    }\n  };\n\n  const validateItem = (item, callback) => {\n    if (item && selectedHotspot) {\n      try {\n        template && validateHotspotItem(item, selectedHotspot, template);\n      } catch (error) {\n        openDialog && openDialog(t(\"alert.warning\"), error.message);\n        return;\n      }\n    }\n\n    callback();\n  };\n\n  const handleTabsChange = (event, newValue) => {\n    if (newValue >= 0 && newValue < items.length) {\n      validateHotspot360(selectedHotspot, () => {\n        setHotspotId(items[newValue].id);\n      });\n    }\n  };\n\n  const handleChange = newHotspot => {\n    updateHotspot(newHotspot);\n  };\n\n  const handleItemChange = event => {\n    if (!selectedHotspot) {\n      return;\n    }\n\n    const {\n      name,\n      value\n    } = event.target;\n    const {\n      items\n    } = selectedHotspot;\n    const item = value.id !== (selectedItem === null || selectedItem === void 0 ? void 0 : selectedItem.id) ? selectedItem : undefined;\n    validateItem(item, () => {\n      const newHotspot = { ...selectedHotspot\n      };\n\n      if (name === \"add\") {\n        newHotspot.items = [...items, value];\n      } else if (name === \"delete\") {\n        newHotspot.items = items.filter(item => item.id !== value.id);\n      } else if (name === \"move\") {\n        newHotspot.items = items.map(item => item.id === value.id ? value : item);\n      }\n\n      if (name !== \"delete\") {\n        setItemdId(value.id);\n      } else if (itemId === value.id) {\n        var _items$;\n\n        setItemdId((_items$ = items[0]) === null || _items$ === void 0 ? void 0 : _items$.id);\n      }\n\n      updateHotspot(newHotspot);\n    });\n  };\n\n  const handleAddClick = () => {\n    const newHotspot = new MediaHotspot();\n    newHotspot.id = createShortUUID();\n    newHotspot.name = \"360-\" + String.fromCharCode((items.length + 1) % 26 + 64).toLowerCase();\n    updateChange({ ...value,\n      items: [...items, newHotspot]\n    });\n  };\n\n  const handleDuplicateClick = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (selectedHotspot) {\n      validateHotspot360(selectedHotspot, () => {\n        duplicateHotspot(selectedHotspot);\n      });\n    }\n  };\n\n  const handleDeleteClick = event => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    if (items.length > 1) {\n      openConfirmDialog(t(\"alert.warning\"), t(\"hotspot360.delete_confirm\", {\n        name: selectedHotspot.name\n      }), () => {\n        if (selectedHotspot) {\n          deleteHotspot(selectedHotspot);\n        }\n      });\n    } else {\n      openDialog(t(\"alert.warning\"), t(\"hotspot360.delete_error\", {\n        name: selectedHotspot.name\n      }));\n    }\n  };\n\n  const handleLblDoubleClick = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    setName(selectedHotspot.name);\n  };\n\n  const handleTxtChange = event => {\n    const {\n      value\n    } = event.target;\n    setName(value);\n  };\n\n  const handleTxtBlur = () => {\n    if (name && name.trim() !== \"\") {\n      const newHotspot = { ...selectedHotspot,\n        name\n      };\n      updateHotspot(newHotspot);\n    }\n\n    setName(undefined);\n  };\n\n  return /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 314,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Tabs, {\n    variant: \"scrollable\",\n    value: selectedIndex,\n    className: \"hotspot-360-tabs\",\n    onChange: handleTabsChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 7\n    }\n  }, items.map((item, ind) => /*#__PURE__*/React.createElement(Tab, {\n    key: item.id,\n    label: name !== undefined && ind === selectedIndex ? /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      value: name,\n      className: \"hotspot-360-tab-txt\",\n      onChange: handleTxtChange,\n      onBlur: handleTxtBlur,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 17\n      }\n    }) : /*#__PURE__*/React.createElement(\"span\", {\n      className: \"hotspot-360-tab-lbl\",\n      onDoubleClick: handleLblDoubleClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 17\n      }\n    }, item.name),\n    icon: /*#__PURE__*/React.createElement(\"div\", {\n      className: \"hotspot-360-tab-btns-wrapper\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"hotspot-360-tab-duplicate-btn\",\n      onClick: handleDuplicateClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"hotspot-360-tab-divider\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"hotspot-360-tab-delete-btn\",\n      onClick: handleDeleteClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 17\n      }\n    })),\n    disableRipple: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 322,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Tab, {\n    label: \"+\",\n    disableRipple: true,\n    onClick: handleAddClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 349,\n      columnNumber: 9\n    }\n  })), selectedHotspot && /*#__PURE__*/React.createElement(BlmHotspot360Provider, {\n    selectedId: selectedHotspot.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 352,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(BlmHotspotHeader, {\n    type: \"panorama\",\n    data: selectedHotspot,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 353,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(BlmHotspotPicker, {\n    type: \"panorama\",\n    elementId: element.id,\n    data: selectedHotspot,\n    isLinked: isLinkedMedia,\n    selectedItem: selectedItem,\n    onChange: handleChange,\n    onItemChange: handleItemChange,\n    options2: data.options2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 354,\n      columnNumber: 11\n    }\n  }), selectedItem && /*#__PURE__*/React.createElement(BlmHotspotItemProps, {\n    type: \"panorama\",\n    data: selectedHotspot,\n    item: selectedItem,\n    isLinked: isLinkedItem,\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 365,\n      columnNumber: 13\n    }\n  })), /*#__PURE__*/React.createElement(BlmHotspot360Options, {\n    open: openModal,\n    onSave: onSave,\n    onClose: onClose,\n    data: data,\n    onChange: update360Options,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 7\n    }\n  }));\n}\n\nexport default BlmHotspot360;","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/src/components/content-editor/components/media/hotspot/360/BlmHotspot360.tsx"],"names":["React","Fragment","useMemo","useState","Tabs","Tab","useTranslation","MediaHotspot","createShortUUID","findObject","isGoto360Action","updateObject","validateHotspot","validateHotspotItem","useContentEditorCtx","updateMedia360Option","updateMediaComponent","BlmHotspotHeader","BlmHotspotPicker","BlmHotspotItemProps","BlmHotspot360Provider","BlmHotspot360Options","BlmHotspot360","props","data","openDialog","openConfirmDialog","openModal","onClose","onSave","hotspotId","setHotspotId","itemId","setItemdId","name","setName","element","template","dispatch","t","value","items","selectedHotspot","selectedIndex","indexOf","selectedItem","isLinkedMedia","media","findIndex","item","id","isLinkedItem","item2","updateChange","newValue","newData","update360Options","options2","updateHotspot","newHotspot","duplicateHotspot","hotspot","newInd","newItems","cloneAction","action","groups","map","group","clickAction","overAction","splice","deleteHotspot","newItemes","filter","updateAction","gotoId","undefined","forEach","validateHotspot360","callback","error","message","validateItem","handleTabsChange","event","length","handleChange","handleItemChange","target","handleAddClick","String","fromCharCode","toLowerCase","handleDuplicateClick","preventDefault","stopPropagation","handleDeleteClick","handleLblDoubleClick","handleTxtChange","handleTxtBlur","trim","ind"],"mappings":"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","sourcesContent":["import React, { ChangeEvent, Fragment, useMemo, useState, MouseEvent } from \"react\";\r\nimport { Tabs, Tab } from \"@material-ui/core\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport {\r\n  ComponentAction,\r\n  CustomChangeEvent,\r\n  MediaComponent,\r\n  MediaConfigOptions,\r\n  MediaHotspot,\r\n  MediaHotspot360,\r\n  MediaHotspotItem,\r\n} from \"types\";\r\nimport {\r\n  createShortUUID,\r\n  findObject,\r\n  isGoto360Action,\r\n  updateObject,\r\n  validateHotspot,\r\n  validateHotspotItem,\r\n} from \"utils\";\r\nimport { useContentEditorCtx } from \"components/content-editor/core\";\r\nimport { updateMedia360Option, updateMediaComponent } from \"components/content-editor/reducers\";\r\nimport BlmHotspotHeader from \"../header\";\r\nimport BlmHotspotPicker from \"../picker\";\r\nimport BlmHotspotItemProps from \"../properties\";\r\nimport { BlmHotspot360Provider } from \"./context\";\r\nimport { ContainerProps } from \"./container\";\r\nimport \"./styles.scss\";\r\nimport BlmHotspot360Options from \"./BlmHotspot360Options\";\r\n\r\nexport interface HotspotClassicProps extends ContainerProps {\r\n  data: MediaComponent & { value: MediaHotspot360 };\r\n  openModal: boolean;\r\n  onSave: () => void;\r\n  onClose: () => void;\r\n}\r\n\r\nfunction BlmHotspot360(props: HotspotClassicProps) {\r\n  const { data, openDialog, openConfirmDialog, openModal, onClose, onSave } = props;\r\n  const [hotspotId, setHotspotId] = useState<string>();\r\n  const [itemId, setItemdId] = useState<string>();\r\n  const [name, setName] = useState<string>();\r\n  const { element, template, dispatch } = useContentEditorCtx();\r\n  const { t } = useTranslation(\"content-editor\");\r\n  const { value } = data;\r\n  const { items } = value;\r\n\r\n  const selectedHotspot = useMemo(\r\n    () => (hotspotId && items && findObject(items, hotspotId, \"id\")) || items?.[0],\r\n    [items, hotspotId]\r\n  );\r\n\r\n  const selectedIndex = useMemo(\r\n    () => (items && selectedHotspot && items.indexOf(selectedHotspot)) ?? 0,\r\n    [items, selectedHotspot]\r\n  );\r\n\r\n  const selectedItem = useMemo(() => {\r\n    if (selectedHotspot) {\r\n      const { items } = selectedHotspot;\r\n\r\n      return (itemId && items && findObject(items, itemId, \"id\")) || items?.[0];\r\n    }\r\n  }, [selectedHotspot, itemId]);\r\n\r\n  const isLinkedMedia = useMemo(() => {\r\n    if (selectedHotspot.media) {\r\n      return (\r\n        items.findIndex(\r\n          (item) => item.id !== selectedHotspot.id && item.media?.id === selectedHotspot.media?.id\r\n        ) !== -1\r\n      );\r\n    }\r\n\r\n    return false;\r\n  }, [items, selectedHotspot]);\r\n\r\n  const isLinkedItem = useMemo(() => {\r\n    if (selectedItem && selectedItem.media) {\r\n      return (\r\n        items.findIndex((item) => {\r\n          return (\r\n            item.items.findIndex(\r\n              (item2) => item2.id !== selectedItem.id && item2.media?.id === selectedItem.media?.id\r\n            ) !== -1\r\n          );\r\n        }) !== -1\r\n      );\r\n    }\r\n\r\n    return false;\r\n  }, [items, selectedItem]);\r\n\r\n  const updateChange = (newValue: MediaHotspot360) => {\r\n    const newData = {\r\n      ...data,\r\n      value: newValue,\r\n    };\r\n\r\n    if (dispatch) {\r\n      dispatch(updateMediaComponent(newData));\r\n    }\r\n  };\r\n\r\n  const update360Options = (newValue: MediaConfigOptions) => {\r\n    const newData = {\r\n      ...data,\r\n      options2: newValue,\r\n    };\r\n\r\n    if (dispatch) {\r\n      dispatch(updateMedia360Option(newData));\r\n    }\r\n  };\r\n\r\n  const updateHotspot = (newHotspot: MediaHotspot) => {\r\n    const newValue = {\r\n      ...data.value,\r\n      items: updateObject(items, \"id\", selectedHotspot.id, newHotspot),\r\n    };\r\n\r\n    updateChange(newValue);\r\n  };\r\n\r\n  const duplicateHotspot = (hotspot: MediaHotspot) => {\r\n    const newInd = items.indexOf(hotspot);\r\n    const newItems = [...items];\r\n    const newHotspot = { ...hotspot };\r\n    const cloneAction = (action: ComponentAction) => {\r\n      return (\r\n        action && {\r\n          ...action,\r\n          value: action.value && { ...action.value },\r\n        }\r\n      );\r\n    };\r\n\r\n    newHotspot.id = createShortUUID();\r\n    newHotspot.name = newHotspot.name + \"-copy\";\r\n\r\n    newHotspot.groups = {\r\n      ...newHotspot.groups,\r\n      items: newHotspot.groups.items.map((group) => {\r\n        return { ...group };\r\n      }),\r\n    };\r\n\r\n    newHotspot.items = newHotspot.items.map((item) => {\r\n      const { clickAction, overAction } = item;\r\n\r\n      return {\r\n        ...item,\r\n        id: createShortUUID(),\r\n        clickAction: cloneAction(clickAction),\r\n        overAction: cloneAction(overAction),\r\n      };\r\n    });\r\n\r\n    newItems.splice(newInd + 1, 0, newHotspot);\r\n\r\n    updateChange({ ...value, items: newItems });\r\n  };\r\n\r\n  const deleteHotspot = (hotspot: MediaHotspot) => {\r\n    const newItemes = items.filter((item) => item.id !== hotspot.id);\r\n    const updateAction = (action: ComponentAction) => {\r\n      if (action && isGoto360Action(action) && action.value?.gotoId === hotspot.id) {\r\n        action.value.gotoId = undefined;\r\n      }\r\n    };\r\n\r\n    newItemes.forEach((item) => {\r\n      item.items.forEach((item2) => {\r\n        updateAction(item2.clickAction);\r\n        updateAction(item2.overAction);\r\n      });\r\n    });\r\n\r\n    updateChange({ ...value, items: newItemes });\r\n  };\r\n\r\n  const validateHotspot360 = (hotspot: MediaHotspot, callback: Function) => {\r\n    if (hotspot) {\r\n      try {\r\n        if (template) {\r\n          validateHotspot(hotspot, template);\r\n          callback();\r\n        }\r\n      } catch (error) {\r\n        if (openDialog) {\r\n          openDialog(t(\"alert.warning\"), (error as Error).message);\r\n        }\r\n      }\r\n    }\r\n  };\r\n\r\n  const validateItem = (item: MediaHotspotItem | undefined, callback: Function) => {\r\n    if (item && selectedHotspot) {\r\n      try {\r\n        template && validateHotspotItem(item, selectedHotspot, template);\r\n      } catch (error) {\r\n        openDialog && openDialog(t(\"alert.warning\"), (error as Error).message);\r\n        return;\r\n      }\r\n    }\r\n\r\n    callback();\r\n  };\r\n\r\n  const handleTabsChange = (event: ChangeEvent<{}>, newValue: number) => {\r\n    if (newValue >= 0 && newValue < items.length) {\r\n      validateHotspot360(selectedHotspot, () => {\r\n        setHotspotId(items[newValue].id);\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleChange = (newHotspot: MediaHotspot) => {\r\n    updateHotspot(newHotspot);\r\n  };\r\n\r\n  const handleItemChange = (event: CustomChangeEvent<MediaHotspotItem>) => {\r\n    if (!selectedHotspot) {\r\n      return;\r\n    }\r\n\r\n    const { name, value } = event.target;\r\n    const { items } = selectedHotspot;\r\n    const item = value.id !== selectedItem?.id ? selectedItem : undefined;\r\n\r\n    validateItem(item, () => {\r\n      const newHotspot = { ...selectedHotspot };\r\n\r\n      if (name === \"add\") {\r\n        newHotspot.items = [...items, value];\r\n      } else if (name === \"delete\") {\r\n        newHotspot.items = items.filter((item) => item.id !== value.id);\r\n      } else if (name === \"move\") {\r\n        newHotspot.items = items.map((item) => (item.id === value.id ? value : item));\r\n      }\r\n\r\n      if (name !== \"delete\") {\r\n        setItemdId(value.id);\r\n      } else if (itemId === value.id) {\r\n        setItemdId(items[0]?.id);\r\n      }\r\n\r\n      updateHotspot(newHotspot);\r\n    });\r\n  };\r\n\r\n  const handleAddClick = () => {\r\n    const newHotspot = new MediaHotspot();\r\n    newHotspot.id = createShortUUID();\r\n    newHotspot.name = \"360-\" + String.fromCharCode(((items.length + 1) % 26) + 64).toLowerCase();\r\n\r\n    updateChange({ ...value, items: [...items, newHotspot] });\r\n  };\r\n\r\n  const handleDuplicateClick = (event: MouseEvent) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    if (selectedHotspot) {\r\n      validateHotspot360(selectedHotspot, () => {\r\n        duplicateHotspot(selectedHotspot);\r\n      });\r\n    }\r\n  };\r\n\r\n  const handleDeleteClick = (event: MouseEvent) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    if (items.length > 1) {\r\n      openConfirmDialog(\r\n        t(\"alert.warning\"),\r\n        t(\"hotspot360.delete_confirm\", { name: selectedHotspot.name }),\r\n        () => {\r\n          if (selectedHotspot) {\r\n            deleteHotspot(selectedHotspot);\r\n          }\r\n        }\r\n      );\r\n    } else {\r\n      openDialog(t(\"alert.warning\"), t(\"hotspot360.delete_error\", { name: selectedHotspot.name }));\r\n    }\r\n  };\r\n\r\n  const handleLblDoubleClick = (event: MouseEvent) => {\r\n    event.preventDefault();\r\n    event.stopPropagation();\r\n\r\n    setName(selectedHotspot.name);\r\n  };\r\n\r\n  const handleTxtChange = (event: ChangeEvent<HTMLInputElement>) => {\r\n    const { value } = event.target;\r\n\r\n    setName(value);\r\n  };\r\n\r\n  const handleTxtBlur = () => {\r\n    if (name && name.trim() !== \"\") {\r\n      const newHotspot = { ...selectedHotspot, name };\r\n\r\n      updateHotspot(newHotspot);\r\n    }\r\n    setName(undefined);\r\n  };\r\n\r\n  return (\r\n    <Fragment>\r\n      <Tabs\r\n        variant=\"scrollable\"\r\n        value={selectedIndex}\r\n        className=\"hotspot-360-tabs\"\r\n        onChange={handleTabsChange}\r\n      >\r\n        {items.map((item, ind) => (\r\n          <Tab\r\n            key={item.id}\r\n            label={\r\n              name !== undefined && ind === selectedIndex ? (\r\n                <input\r\n                  type=\"text\"\r\n                  value={name}\r\n                  className=\"hotspot-360-tab-txt\"\r\n                  onChange={handleTxtChange}\r\n                  onBlur={handleTxtBlur}\r\n                />\r\n              ) : (\r\n                <span className=\"hotspot-360-tab-lbl\" onDoubleClick={handleLblDoubleClick}>\r\n                  {item.name}\r\n                </span>\r\n              )\r\n            }\r\n            icon={\r\n              <div className=\"hotspot-360-tab-btns-wrapper\">\r\n                <div className=\"hotspot-360-tab-duplicate-btn\" onClick={handleDuplicateClick} />\r\n                <div className=\"hotspot-360-tab-divider\" />\r\n                <div className=\"hotspot-360-tab-delete-btn\" onClick={handleDeleteClick} />\r\n              </div>\r\n            }\r\n            disableRipple={true}\r\n          />\r\n        ))}\r\n        <Tab label=\"+\" disableRipple={true} onClick={handleAddClick} />\r\n      </Tabs>\r\n      {selectedHotspot && (\r\n        <BlmHotspot360Provider selectedId={selectedHotspot.id}>\r\n          <BlmHotspotHeader type=\"panorama\" data={selectedHotspot} onChange={handleChange} />\r\n          <BlmHotspotPicker\r\n            type=\"panorama\"\r\n            elementId={element!.id}\r\n            data={selectedHotspot}\r\n            isLinked={isLinkedMedia}\r\n            selectedItem={selectedItem}\r\n            onChange={handleChange}\r\n            onItemChange={handleItemChange}\r\n            options2={data.options2}\r\n          />\r\n          {selectedItem && (\r\n            <BlmHotspotItemProps\r\n              type=\"panorama\"\r\n              data={selectedHotspot}\r\n              item={selectedItem}\r\n              isLinked={isLinkedItem}\r\n              onChange={handleChange}\r\n            />\r\n          )}\r\n        </BlmHotspot360Provider>\r\n      )}\r\n      <BlmHotspot360Options\r\n        open={openModal}\r\n        onSave={onSave}\r\n        onClose={onClose}\r\n        data={data}\r\n        onChange={update360Options}\r\n      />\r\n    </Fragment>\r\n  );\r\n}\r\n\r\nexport default BlmHotspot360;\r\n"]},"metadata":{},"sourceType":"module"}