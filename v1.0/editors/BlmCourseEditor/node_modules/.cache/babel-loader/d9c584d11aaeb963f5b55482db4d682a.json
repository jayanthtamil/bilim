{"ast":null,"code":"import isEmail from \"validator/lib/isEmail\";\nimport isURL from \"validator/lib/isURL\";\nimport i18next from \"i18next\";\nimport { ComponentActionTypes, GotoActionTypes } from \"editor-constants\";\nimport { GlTemplateBuilderStore } from \"template-builders\";\nimport { isGotoAction, isVideoMarker, isLinkAction, isSimpleContentAction, isReplaceTargetAction, isPopoverAction, isMailAction, isGoto360Action } from \"./actions\";\nimport { getMediaTargets, getVideoMarkerTarget, isMediaButton, isMediaExternalVideo, isMediaStandardVideo, isMediaTarget, isMediaVideo, isMediaSlideshow, isMediaHotspot, isMediaImage, isMediaFlipCard, isMediaHotspot360, isMediaHotspotPlain } from \"./media\";\nimport { getRepeaterComponents, isButtonComponent, isMediaComponent, isSoundComponent } from \"./component\";\nimport { findObject } from \"../core\";\nexport function validateContent(template) {\n  const {\n    medias,\n    buttons,\n    repeater\n  } = template;\n  const allMedias = [...medias, ...getRepeaterComponents(repeater.medias)];\n  const allButtons = [...buttons, ...getRepeaterComponents(repeater.buttons)];\n\n  for (let i = 0; i < allMedias.length; i++) {\n    const media = allMedias[i];\n\n    if (isMediaSlideshow(media)) {\n      const {\n        value: {\n          items\n        }\n      } = media;\n      items.forEach(item => {\n        const {\n          clickAction\n        } = item;\n        validateAction(clickAction, template);\n      });\n    } else if (isMediaButton(media)) {\n      const {\n        value: {\n          clickAction,\n          overAction\n        }\n      } = media;\n      validateAction(clickAction, template);\n      validateAction(overAction, template);\n    } else if (isMediaFlipCard(media)) {\n      const {\n        value: {\n          clickAction,\n          overAction\n        }\n      } = media;\n      validateAction(clickAction, template);\n      validateAction(overAction, template);\n    } else if (isMediaTarget(media)) {\n      const {\n        value: {\n          name,\n          template\n        }\n      } = media;\n\n      if (name.trim() === \"\") {\n        throw new Error(i18next.t(\"utils:alert.enter_target\"));\n      } else if (!template || template.trim() === \"\") {// throw new Error(i18next.t(\"utils:alert.default_temp_target\"));\n      }\n    } else if (isMediaVideo(media)) {\n      throw new Error(i18next.t(\"utils:alert.video_type\"));\n    } else if (isMediaExternalVideo(media)) {\n      const {\n        value: {\n          id\n        }\n      } = media;\n\n      if (!id) {\n        throw new Error(i18next.t(\"utils:alert.youtube_vimeo\"));\n      }\n    } else if (isMediaStandardVideo(media)) {\n      const {\n        value: {\n          main\n        }\n      } = media;\n\n      if (!main) {\n        throw new Error(i18next.t(\"utils:alert.mp4\"));\n      }\n    } else if (isMediaHotspotPlain(media)) {\n      throw new Error(i18next.t(\"utils:alert.hotspot_type\"));\n    } else if (isMediaHotspot(media)) {\n      validateHotspot(media.value, template);\n    } else if (isMediaHotspot360(media)) {\n      validateHotspot360(media.value, template);\n    }\n  }\n\n  for (let i = 0; i < allButtons.length; i++) {\n    const button = allButtons[i];\n    const {\n      value: {\n        clickAction,\n        overAction\n      }\n    } = button;\n    validateAction(clickAction, template);\n    validateAction(overAction, template);\n  }\n}\nexport function validateHotspot(hotspot, template) {\n  const {\n    groups,\n    items\n  } = hotspot;\n  validateHotspotGroups(groups);\n  items.forEach(item => validateHotspotItem(item, hotspot, template));\n}\nexport function validateHotspot360(hotspot, template) {\n  hotspot.items.forEach(hotspot => {\n    validateHotspot(hotspot, template);\n  });\n}\nexport function validateHotspotGroups(groups) {\n  const {\n    enabled,\n    items\n  } = groups;\n\n  if (enabled) {\n    items.forEach(item => {\n      const {\n        name\n      } = item;\n\n      if (name.trim() === \"\") {\n        throw new Error(i18next.t(\"utils:alert.hotspot_group_name\"));\n      }\n    });\n  }\n}\nexport function validateHotspotItem(item, hotspot, template) {\n  const {\n    groups\n  } = hotspot;\n  const {\n    name,\n    groupId,\n    clickAction,\n    overAction\n  } = item;\n\n  if (name.trim() === \"\") {\n    throw new Error(i18next.t(\"utils:alert.hotspot_name\"));\n  } else if (groups.enabled && !groupId) {\n    throw new Error(i18next.t(\"utils:alert.hotspot_group\"));\n  }\n\n  validateAction(clickAction, template);\n  validateAction(overAction, template);\n}\nexport function validateAction(action, template) {\n  if (isSimpleContentAction(action)) {\n    const {\n      simpleContentId,\n      option,\n      display\n    } = action.value || {};\n\n    if (!simpleContentId) {\n      throw new Error(i18next.t(\"utils:alert.simplecontent_element\"));\n    } else if (option === \"popup\" && !display) {\n      throw new Error(i18next.t(\"utils:alert.simplecontent_display\"));\n    } else if (option === \"flap\" && !display) {\n      throw new Error(i18next.t(\"utils:alert.simplecontent_display\"));\n    } else if (option === \"target\" && !display) {\n      throw new Error(i18next.t(\"utils:alert.simplecontent_target\"));\n    }\n  } else if (isLinkAction(action)) {\n    const {\n      url = \"\"\n    } = action.value || {};\n\n    if (!isURL(url)) {\n      throw new Error(i18next.t(\"utils:alert.valid_url\"));\n    }\n  } else if (isMailAction(action)) {\n    const {\n      email = \"\"\n    } = action.value || {};\n\n    if (!isEmail(email)) {\n      throw new Error(i18next.t(\"utils:alert.valid_email\"));\n    }\n  } else if (isReplaceTargetAction(action)) {\n    const {\n      replaceTargetId,\n      replaceId\n    } = action.value || {};\n    const targets = getMediaTargets(template);\n\n    if (!replaceTargetId && targets.length !== 1) {\n      throw new Error(i18next.t(\"utils:alert.select_target\"));\n    } else if (!replaceId) {\n      throw new Error(i18next.t(\"utils:alert.select_simplecontent\"));\n    }\n  } else if (isGotoAction(action)) {\n    const {\n      action: gotoAction,\n      gotoId\n    } = action.value || {};\n\n    if (!gotoAction) {\n      throw new Error(i18next.t(\"utils:alert.select_action_goto\"));\n    } else if (gotoAction === GotoActionTypes.PageScreen && !gotoId) {\n      throw new Error(i18next.t(\"utils:alert.select_element\"));\n    }\n  } else if (isPopoverAction(action)) {\n    validatePopoverAction(action.value, template);\n  } else if (isGoto360Action(action)) {\n    const {\n      gotoId\n    } = action.value || {};\n\n    if (!gotoId) {\n      throw new Error(i18next.t(\"utils:alert.select_360\"));\n    }\n  } else if (isVideoMarker(action)) {\n    const {\n      marker\n    } = action.value || {};\n    const videoMArker = getVideoMarkerTarget(template, action.value);\n\n    if (videoMArker && marker === \"\") {\n      throw new Error(i18next.t(\"utils:alert.marker\"));\n    }\n  }\n}\nexport function validatePopoverAction(action, template) {\n  if (!action) {\n    throw new Error(i18next.t(\"utils:alert.detail_popover\"));\n  } else {\n    const {\n      button\n    } = action;\n\n    if (button) {\n      const {\n        checked,\n        label,\n        action\n      } = button;\n\n      if (checked) {\n        if (!label) {\n          throw new Error(i18next.t(\"utils:alert.label_popover\"));\n        } else if (!action || action.action === ComponentActionTypes.None) {\n          throw new Error(i18next.t(\"utils:alert.action_popover\"));\n        } else {\n          validateAction(action, template);\n        }\n      }\n    }\n  }\n}\n\nfunction isFormatEqual(format1, format2) {\n  return format1.value === format2.value && format1.width === format2.width && format1.height === format2.height;\n}\n\nfunction isTintEqual(tint1, tint2, defaultTint1, defaultTint2) {\n  var _tint1$color, _tint2$color, _ref, _tint1$alpha, _ref2, _tint2$alpha;\n\n  var color1 = (_tint1$color = tint1 === null || tint1 === void 0 ? void 0 : tint1.color) !== null && _tint1$color !== void 0 ? _tint1$color : defaultTint1 === null || defaultTint1 === void 0 ? void 0 : defaultTint1.color;\n  const color2 = (_tint2$color = tint2 === null || tint2 === void 0 ? void 0 : tint2.color) !== null && _tint2$color !== void 0 ? _tint2$color : defaultTint2 === null || defaultTint2 === void 0 ? void 0 : defaultTint2.color;\n  const alpha1 = (_ref = (_tint1$alpha = tint1 === null || tint1 === void 0 ? void 0 : tint1.alpha) !== null && _tint1$alpha !== void 0 ? _tint1$alpha : defaultTint1 === null || defaultTint1 === void 0 ? void 0 : defaultTint1.alpha) !== null && _ref !== void 0 ? _ref : 50;\n  const alpha2 = (_ref2 = (_tint2$alpha = tint2 === null || tint2 === void 0 ? void 0 : tint2.alpha) !== null && _tint2$alpha !== void 0 ? _tint2$alpha : defaultTint2 === null || defaultTint2 === void 0 ? void 0 : defaultTint2.alpha) !== null && _ref2 !== void 0 ? _ref2 : 50;\n  return color1 === color2 && alpha1 === alpha2;\n}\n\nfunction isStyleEqual(style1, style2) {\n  const styleItem1 = style1.style ? GlTemplateBuilderStore.getStyleItem(style1.style) : undefined;\n  const styleItem2 = style2.style ? GlTemplateBuilderStore.getStyleItem(style2.style) : undefined;\n  return style1.style === style2.style && style1.hasLight === style2.hasLight && !style1.hasDarkOut === !style2.hasDarkOut && !style1.hasDarkOver === !style2.hasDarkOver && !style1.isShadow === !style2.isShadow && isTintEqual(style1.tint, style2.tint, styleItem1 === null || styleItem1 === void 0 ? void 0 : styleItem1.tint, styleItem2 === null || styleItem2 === void 0 ? void 0 : styleItem2.tint) && isTintEqual(style1.bgTint, style2.bgTint, styleItem1 === null || styleItem1 === void 0 ? void 0 : styleItem1.bgTint, styleItem2 === null || styleItem2 === void 0 ? void 0 : styleItem2.bgTint) && isTintEqual(style1.tintOut, style2.tintOut, styleItem1 === null || styleItem1 === void 0 ? void 0 : styleItem1.tintOut, styleItem2 === null || styleItem2 === void 0 ? void 0 : styleItem2.tintOut) && isTintEqual(style1.tintOver, style2.tintOver, styleItem1 === null || styleItem1 === void 0 ? void 0 : styleItem1.tintOver, styleItem2 === null || styleItem2 === void 0 ? void 0 : styleItem2.tintOver);\n}\n\nexport function hasSameComponentStyles(template, component) {\n  const {\n    repeaterId\n  } = component;\n  const {\n    medias,\n    buttons,\n    sounds,\n    repeater\n  } = template;\n\n  if (component.hasApplyStyle && isMediaComponent(component)) {\n    var _findObject, _repeater$medias;\n\n    const arr = repeaterId ? (_findObject = findObject((_repeater$medias = repeater.medias) !== null && _repeater$medias !== void 0 ? _repeater$medias : [], repeaterId, \"id\")) === null || _findObject === void 0 ? void 0 : _findObject.value : medias;\n\n    if (arr) {\n      return arr.every(media => {\n        if (media.hasApplyStyle) {\n          if (isMediaImage(component) && isMediaImage(media)) {\n            return isFormatEqual(component.format, media.format) && isStyleEqual(component.value.style, media.value.style) && component.value.option === media.value.option && component.value.isZoom === media.value.isZoom;\n          } else if (isMediaButton(component) && isMediaButton(media)) {\n            return isFormatEqual(component.format, media.format) && isStyleEqual(component.value.style, media.value.style) && component.value.option === media.value.option;\n          } else if (isMediaFlipCard(component) && isMediaFlipCard(media)) {\n            return isFormatEqual(component.format, media.format) && isStyleEqual(component.value.recto.style, media.value.recto.style) && isStyleEqual(component.value.verso.style, media.value.verso.style) && component.value.recto.option === media.value.recto.option && component.value.verso.option === media.value.verso.option;\n          } else if (isMediaStandardVideo(component) && isMediaStandardVideo(media)) {\n            return isFormatEqual(component.format, media.format) && isStyleEqual(component.value.style, media.value.style) && component.value.option === media.value.option;\n          }\n        }\n\n        return true;\n      });\n    }\n  } else if (component.hasApplyStyle && isButtonComponent(component)) {\n    var _findObject2, _repeater$buttons;\n\n    const arr = repeaterId ? (_findObject2 = findObject((_repeater$buttons = repeater.buttons) !== null && _repeater$buttons !== void 0 ? _repeater$buttons : [], repeaterId, \"id\")) === null || _findObject2 === void 0 ? void 0 : _findObject2.value : buttons;\n\n    if (arr) {\n      return arr.every(button => {\n        return button.hasApplyStyle && isStyleEqual(component.value.style, button.value.style) && isFormatEqual(button.buttonOptions.format, component.buttonOptions.format);\n      });\n    }\n  } else if (component.hasApplyStyle && isSoundComponent(component)) {\n    var _findObject3, _repeater$sounds;\n\n    const arr = repeaterId ? (_findObject3 = findObject((_repeater$sounds = repeater.sounds) !== null && _repeater$sounds !== void 0 ? _repeater$sounds : [], repeaterId, \"id\")) === null || _findObject3 === void 0 ? void 0 : _findObject3.value : sounds;\n\n    if (arr) {\n      return arr.every(sound => {\n        return sound.hasApplyStyle && isStyleEqual(component.value.style, sound.value.style);\n      });\n    }\n  }\n\n  return false;\n}\nexport function hasSameActionStyles(actions, styleName) {\n  return actions.every(action => {\n    return action.value && action.value.style === styleName;\n  });\n}","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/src/utils/editor/content.ts"],"names":["isEmail","isURL","i18next","ComponentActionTypes","GotoActionTypes","GlTemplateBuilderStore","isGotoAction","isVideoMarker","isLinkAction","isSimpleContentAction","isReplaceTargetAction","isPopoverAction","isMailAction","isGoto360Action","getMediaTargets","getVideoMarkerTarget","isMediaButton","isMediaExternalVideo","isMediaStandardVideo","isMediaTarget","isMediaVideo","isMediaSlideshow","isMediaHotspot","isMediaImage","isMediaFlipCard","isMediaHotspot360","isMediaHotspotPlain","getRepeaterComponents","isButtonComponent","isMediaComponent","isSoundComponent","findObject","validateContent","template","medias","buttons","repeater","allMedias","allButtons","i","length","media","value","items","forEach","item","clickAction","validateAction","overAction","name","trim","Error","t","id","main","validateHotspot","validateHotspot360","button","hotspot","groups","validateHotspotGroups","validateHotspotItem","enabled","groupId","action","simpleContentId","option","display","url","email","replaceTargetId","replaceId","targets","gotoAction","gotoId","PageScreen","validatePopoverAction","marker","videoMArker","checked","label","None","isFormatEqual","format1","format2","width","height","isTintEqual","tint1","tint2","defaultTint1","defaultTint2","color1","color","color2","alpha1","alpha","alpha2","isStyleEqual","style1","style2","styleItem1","style","getStyleItem","undefined","styleItem2","hasLight","hasDarkOut","hasDarkOver","isShadow","tint","bgTint","tintOut","tintOver","hasSameComponentStyles","component","repeaterId","sounds","hasApplyStyle","arr","every","format","isZoom","recto","verso","buttonOptions","sound","hasSameActionStyles","actions","styleName"],"mappings":"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","sourcesContent":["import isEmail from \"validator/lib/isEmail\";\r\nimport isURL from \"validator/lib/isURL\";\r\nimport i18next from \"i18next\";\r\n\r\nimport {\r\n  ButtonComponent,\r\n  ComponentAction,\r\n  ComponentStyle,\r\n  ContentTemplate,\r\n  MediaComponent,\r\n  MediaFormat,\r\n  MediaHotspot,\r\n  MediaHotspot360,\r\n  MediaHotspotGroups,\r\n  MediaHotspotItem,\r\n  PopoverAction,\r\n  SoundComponent,\r\n  Tint,\r\n} from \"types\";\r\nimport { ComponentActionTypes, GotoActionTypes } from \"editor-constants\";\r\nimport { GlTemplateBuilderStore } from \"template-builders\";\r\nimport {\r\n  isGotoAction,\r\n  isVideoMarker,\r\n  isLinkAction,\r\n  isSimpleContentAction,\r\n  isReplaceTargetAction,\r\n  isPopoverAction,\r\n  isMailAction,\r\n  isGoto360Action,\r\n} from \"./actions\";\r\nimport {\r\n  getMediaTargets,\r\n  getVideoMarkerTarget,\r\n  isMediaButton,\r\n  isMediaExternalVideo,\r\n  isMediaStandardVideo,\r\n  isMediaTarget,\r\n  isMediaVideo,\r\n  isMediaSlideshow,\r\n  isMediaHotspot,\r\n  isMediaImage,\r\n  isMediaFlipCard,\r\n  isMediaHotspot360,\r\n  isMediaHotspotPlain,\r\n} from \"./media\";\r\nimport {\r\n  getRepeaterComponents,\r\n  isButtonComponent,\r\n  isMediaComponent,\r\n  isSoundComponent,\r\n} from \"./component\";\r\nimport { findObject } from \"../core\";\r\n\r\nexport function validateContent(template: ContentTemplate) {\r\n  const { medias, buttons, repeater } = template;\r\n  const allMedias = [...medias, ...getRepeaterComponents(repeater.medias)];\r\n  const allButtons = [...buttons, ...getRepeaterComponents(repeater.buttons)];\r\n\r\n  for (let i = 0; i < allMedias.length; i++) {\r\n    const media = allMedias[i];\r\n\r\n    if (isMediaSlideshow(media)) {\r\n      const {\r\n        value: { items },\r\n      } = media;\r\n\r\n      items.forEach((item) => {\r\n        const { clickAction } = item;\r\n\r\n        validateAction(clickAction, template);\r\n      });\r\n    } else if (isMediaButton(media)) {\r\n      const {\r\n        value: { clickAction, overAction },\r\n      } = media;\r\n\r\n      validateAction(clickAction, template);\r\n      validateAction(overAction, template);\r\n    } else if (isMediaFlipCard(media)) {\r\n      const {\r\n        value: { clickAction, overAction },\r\n      } = media;\r\n      validateAction(clickAction, template);\r\n      validateAction(overAction, template);\r\n    } else if (isMediaTarget(media)) {\r\n      const {\r\n        value: { name, template },\r\n      } = media;\r\n\r\n      if (name.trim() === \"\") {\r\n        throw new Error(i18next.t(\"utils:alert.enter_target\"));\r\n      } else if (!template || template.trim() === \"\") {\r\n        // throw new Error(i18next.t(\"utils:alert.default_temp_target\"));\r\n      }\r\n    } else if (isMediaVideo(media)) {\r\n      throw new Error(i18next.t(\"utils:alert.video_type\"));\r\n    } else if (isMediaExternalVideo(media)) {\r\n      const {\r\n        value: { id },\r\n      } = media;\r\n\r\n      if (!id) {\r\n        throw new Error(i18next.t(\"utils:alert.youtube_vimeo\"));\r\n      }\r\n    } else if (isMediaStandardVideo(media)) {\r\n      const {\r\n        value: { main },\r\n      } = media;\r\n\r\n      if (!main) {\r\n        throw new Error(i18next.t(\"utils:alert.mp4\"));\r\n      }\r\n    } else if (isMediaHotspotPlain(media)) {\r\n      throw new Error(i18next.t(\"utils:alert.hotspot_type\"));\r\n    } else if (isMediaHotspot(media)) {\r\n      validateHotspot(media.value, template);\r\n    } else if (isMediaHotspot360(media)) {\r\n      validateHotspot360(media.value, template);\r\n    }\r\n  }\r\n\r\n  for (let i = 0; i < allButtons.length; i++) {\r\n    const button = allButtons[i];\r\n    const {\r\n      value: { clickAction, overAction },\r\n    } = button;\r\n\r\n    validateAction(clickAction, template);\r\n    validateAction(overAction, template);\r\n  }\r\n}\r\n\r\nexport function validateHotspot(hotspot: MediaHotspot, template: ContentTemplate) {\r\n  const { groups, items } = hotspot;\r\n\r\n  validateHotspotGroups(groups);\r\n\r\n  items.forEach((item) => validateHotspotItem(item, hotspot, template));\r\n}\r\n\r\nexport function validateHotspot360(hotspot: MediaHotspot360, template: ContentTemplate) {\r\n  hotspot.items.forEach((hotspot) => {\r\n    validateHotspot(hotspot, template);\r\n  });\r\n}\r\n\r\nexport function validateHotspotGroups(groups: MediaHotspotGroups) {\r\n  const { enabled, items } = groups;\r\n\r\n  if (enabled) {\r\n    items.forEach((item) => {\r\n      const { name } = item;\r\n\r\n      if (name.trim() === \"\") {\r\n        throw new Error(i18next.t(\"utils:alert.hotspot_group_name\"));\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nexport function validateHotspotItem(\r\n  item: MediaHotspotItem,\r\n  hotspot: MediaHotspot,\r\n  template: ContentTemplate\r\n) {\r\n  const { groups } = hotspot;\r\n  const { name, groupId, clickAction, overAction } = item;\r\n\r\n  if (name.trim() === \"\") {\r\n    throw new Error(i18next.t(\"utils:alert.hotspot_name\"));\r\n  } else if (groups.enabled && !groupId) {\r\n    throw new Error(i18next.t(\"utils:alert.hotspot_group\"));\r\n  }\r\n\r\n  validateAction(clickAction, template);\r\n  validateAction(overAction, template);\r\n}\r\n\r\nexport function validateAction(action: ComponentAction, template: ContentTemplate) {\r\n  if (isSimpleContentAction(action)) {\r\n    const { simpleContentId, option, display } = action.value || {};\r\n\r\n    if (!simpleContentId) {\r\n      throw new Error(i18next.t(\"utils:alert.simplecontent_element\"));\r\n    } else if (option === \"popup\" && !display) {\r\n      throw new Error(i18next.t(\"utils:alert.simplecontent_display\"));\r\n    } else if (option === \"flap\" && !display) {\r\n      throw new Error(i18next.t(\"utils:alert.simplecontent_display\"));\r\n    } else if (option === \"target\" && !display) {\r\n      throw new Error(i18next.t(\"utils:alert.simplecontent_target\"));\r\n    }\r\n  } else if (isLinkAction(action)) {\r\n    const { url = \"\" } = action.value || {};\r\n\r\n    if (!isURL(url)) {\r\n      throw new Error(i18next.t(\"utils:alert.valid_url\"));\r\n    }\r\n  } else if (isMailAction(action)) {\r\n    const { email = \"\" } = action.value || {};\r\n\r\n    if (!isEmail(email)) {\r\n      throw new Error(i18next.t(\"utils:alert.valid_email\"));\r\n    }\r\n  } else if (isReplaceTargetAction(action)) {\r\n    const { replaceTargetId, replaceId } = action.value || {};\r\n    const targets = getMediaTargets(template);\r\n\r\n    if (!replaceTargetId && targets.length !== 1) {\r\n      throw new Error(i18next.t(\"utils:alert.select_target\"));\r\n    } else if (!replaceId) {\r\n      throw new Error(i18next.t(\"utils:alert.select_simplecontent\"));\r\n    }\r\n  } else if (isGotoAction(action)) {\r\n    const { action: gotoAction, gotoId } = action.value || {};\r\n\r\n    if (!gotoAction) {\r\n      throw new Error(i18next.t(\"utils:alert.select_action_goto\"));\r\n    } else if (gotoAction === GotoActionTypes.PageScreen && !gotoId) {\r\n      throw new Error(i18next.t(\"utils:alert.select_element\"));\r\n    }\r\n  } else if (isPopoverAction(action)) {\r\n    validatePopoverAction(action.value, template);\r\n  } else if (isGoto360Action(action)) {\r\n    const { gotoId } = action.value || {};\r\n\r\n    if (!gotoId) {\r\n      throw new Error(i18next.t(\"utils:alert.select_360\"));\r\n    }\r\n  } else if (isVideoMarker(action)) {\r\n    const { marker } = action.value || {};\r\n    const videoMArker = getVideoMarkerTarget(template, action.value);\r\n\r\n    if (videoMArker && marker === \"\") {\r\n      throw new Error(i18next.t(\"utils:alert.marker\"));\r\n    }\r\n  }\r\n}\r\n\r\nexport function validatePopoverAction(\r\n  action: PopoverAction | undefined,\r\n  template: ContentTemplate\r\n) {\r\n  if (!action) {\r\n    throw new Error(i18next.t(\"utils:alert.detail_popover\"));\r\n  } else {\r\n    const { button } = action;\r\n\r\n    if (button) {\r\n      const { checked, label, action } = button;\r\n\r\n      if (checked) {\r\n        if (!label) {\r\n          throw new Error(i18next.t(\"utils:alert.label_popover\"));\r\n        } else if (!action || action.action === ComponentActionTypes.None) {\r\n          throw new Error(i18next.t(\"utils:alert.action_popover\"));\r\n        } else {\r\n          validateAction(action, template);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nfunction isFormatEqual(format1: MediaFormat, format2: MediaFormat) {\r\n  return (\r\n    format1.value === format2.value &&\r\n    format1.width === format2.width &&\r\n    format1.height === format2.height\r\n  );\r\n}\r\n\r\nfunction isTintEqual(tint1?: Tint, tint2?: Tint, defaultTint1?: Tint, defaultTint2?: Tint) {\r\n  var color1 = tint1?.color ?? defaultTint1?.color;\r\n  const color2 = tint2?.color ?? defaultTint2?.color;\r\n  const alpha1 = tint1?.alpha ?? defaultTint1?.alpha ?? 50;\r\n  const alpha2 = tint2?.alpha ?? defaultTint2?.alpha ?? 50;\r\n\r\n  return color1 === color2 && alpha1 === alpha2;\r\n}\r\n\r\nfunction isStyleEqual(style1: ComponentStyle, style2: ComponentStyle) {\r\n  const styleItem1 = style1.style ? GlTemplateBuilderStore.getStyleItem(style1.style) : undefined;\r\n  const styleItem2 = style2.style ? GlTemplateBuilderStore.getStyleItem(style2.style) : undefined;\r\n\r\n  return (\r\n    style1.style === style2.style &&\r\n    style1.hasLight === style2.hasLight &&\r\n    !style1.hasDarkOut === !style2.hasDarkOut &&\r\n    !style1.hasDarkOver === !style2.hasDarkOver &&\r\n    !style1.isShadow === !style2.isShadow &&\r\n    isTintEqual(style1.tint, style2.tint, styleItem1?.tint, styleItem2?.tint) &&\r\n    isTintEqual(style1.bgTint, style2.bgTint, styleItem1?.bgTint, styleItem2?.bgTint) &&\r\n    isTintEqual(style1.tintOut, style2.tintOut, styleItem1?.tintOut, styleItem2?.tintOut) &&\r\n    isTintEqual(style1.tintOver, style2.tintOver, styleItem1?.tintOver, styleItem2?.tintOver)\r\n  );\r\n}\r\n\r\nexport function hasSameComponentStyles(\r\n  template: ContentTemplate,\r\n  component: MediaComponent | ButtonComponent | SoundComponent\r\n) {\r\n  const { repeaterId } = component;\r\n  const { medias, buttons, sounds, repeater } = template;\r\n\r\n  if (component.hasApplyStyle && isMediaComponent(component)) {\r\n    const arr = repeaterId ? findObject(repeater.medias ?? [], repeaterId, \"id\")?.value : medias;\r\n\r\n    if (arr) {\r\n      return arr.every((media) => {\r\n        if (media.hasApplyStyle) {\r\n          if (isMediaImage(component) && isMediaImage(media)) {\r\n            return (\r\n              isFormatEqual(component.format, media.format) &&\r\n              isStyleEqual(component.value.style, media.value.style) &&\r\n              component.value.option === media.value.option &&\r\n              component.value.isZoom === media.value.isZoom\r\n            );\r\n          } else if (isMediaButton(component) && isMediaButton(media)) {\r\n            return (\r\n              isFormatEqual(component.format, media.format) &&\r\n              isStyleEqual(component.value.style, media.value.style) &&\r\n              component.value.option === media.value.option\r\n            );\r\n          } else if (isMediaFlipCard(component) && isMediaFlipCard(media)) {\r\n            return (\r\n              isFormatEqual(component.format, media.format) &&\r\n              isStyleEqual(component.value.recto.style, media.value.recto.style) &&\r\n              isStyleEqual(component.value.verso.style, media.value.verso.style) &&\r\n              component.value.recto.option === media.value.recto.option &&\r\n              component.value.verso.option === media.value.verso.option\r\n            );\r\n          } else if (isMediaStandardVideo(component) && isMediaStandardVideo(media)) {\r\n            return (\r\n              isFormatEqual(component.format, media.format) &&\r\n              isStyleEqual(component.value.style, media.value.style) &&\r\n              component.value.option === media.value.option\r\n            );\r\n          }\r\n        }\r\n\r\n        return true;\r\n      });\r\n    }\r\n  } else if (component.hasApplyStyle && isButtonComponent(component)) {\r\n    const arr = repeaterId ? findObject(repeater.buttons ?? [], repeaterId, \"id\")?.value : buttons;\r\n\r\n    if (arr) {\r\n      return arr.every((button) => {\r\n        return (\r\n          button.hasApplyStyle &&\r\n          isStyleEqual(component.value.style, button.value.style) &&\r\n          isFormatEqual(button.buttonOptions.format, component.buttonOptions.format)\r\n        );\r\n      });\r\n    }\r\n  } else if (component.hasApplyStyle && isSoundComponent(component)) {\r\n    const arr = repeaterId ? findObject(repeater.sounds ?? [], repeaterId, \"id\")?.value : sounds;\r\n\r\n    if (arr) {\r\n      return arr.every((sound) => {\r\n        return sound.hasApplyStyle && isStyleEqual(component.value.style, sound.value.style);\r\n      });\r\n    }\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nexport function hasSameActionStyles(\r\n  actions: (ComponentAction & { value: { style?: string } })[],\r\n  styleName: string\r\n) {\r\n  return actions.every((action) => {\r\n    return action.value && action.value.style === styleName;\r\n  });\r\n}\r\n"]},"metadata":{},"sourceType":"module"}