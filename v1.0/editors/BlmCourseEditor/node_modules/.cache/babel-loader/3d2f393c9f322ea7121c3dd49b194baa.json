{"ast":null,"code":"import { TemplateType, TemplateMenu, CourseDisplay } from \"editor-constants\";\nimport { cloneTemplates, compareVersion, differenceOfObjects, hasSubCategory, isCategory, isTemplate } from \"utils\";\nexport function createCategories(categories, filter) {\n  let result = cloneTemplates(categories);\n\n  if (result && filter.virtualCategory) {\n    result = createVirtualCategory(result, filter.virtualCategory);\n  }\n\n  result = filterItems(result, filter);\n  orderItems(result);\n\n  if (result && filter.showAllCategory) {\n    result = createAllCategory(result);\n  }\n\n  return result;\n}\n\nfunction filterItems(items, filter) {\n  return items.filter(item => {\n    if (isCategory(item)) {\n      item.children = filterItems(item.children, filter);\n      return item.children.length > 0;\n    } else if (isTemplate(item)) {\n      return filterTemplate(item, filter);\n    }\n\n    return false;\n  });\n}\n\nfunction orderItems(items) {\n  items.forEach(item => {\n    if (isCategory(item) && item.children) {\n      orderItems(item.children);\n    }\n  });\n  items.sort(sortItem);\n  return items;\n}\n\nfunction sortItem(item1, item2) {\n  return Number(item1.order) - Number(item2.order);\n}\n\nfunction filterTemplate(template, filter) {\n  const {\n    framework: {\n      min,\n      max\n    },\n    displays,\n    structureContexts,\n    scopes,\n    contexts,\n    themes\n  } = template;\n  const {\n    framework,\n    display,\n    structureContext,\n    scope,\n    context,\n    theme,\n    switchable\n  } = filter || {};\n\n  if ((!framework || min && compareVersion(framework, min) <= 0 && (!max || compareVersion(framework, max) === 1)) && (!display || displays.includes(CourseDisplay.FullResponsive) || displays.includes(display)) && (!structureContext || structureContexts.length === 0 || structureContexts.includes(structureContext)) && (!scope || (!scope.included || scope.included.every(sc => scopes.includes(sc))) && (!scope.excluded || scope.excluded.every(sc => !scopes.includes(sc)))) && (!context && contexts.length === 0 || context && contexts.includes(context)) && (!theme || theme === \"none\" || themes.length === 0 || themes.includes(theme)) && (!switchable || template.switchable)) {\n    return true;\n  }\n\n  return false;\n}\n\nfunction createAllCategory(categories) {\n  const all = {\n    id: \"all\",\n    name: \"all\",\n    description: \"all\",\n    type: TemplateType.CategoryRoot,\n    order: \"0\",\n    info: \"\",\n    helpurl: \"\",\n    menu: TemplateMenu.Left,\n    children: []\n  };\n  const child = { ...all,\n    type: TemplateType.Category\n  };\n  all.children = [child];\n  child.children = getCategoryTemplates(categories);\n  return [all, ...categories];\n}\n\nfunction createVirtualCategory(categories, category) {\n  const virtual = {\n    id: \"virtual\",\n    name: \"Virtual\",\n    description: \"Virtual templates\",\n    type: TemplateType.CategoryRoot,\n    order: \"0\",\n    info: \"\",\n    helpurl: \"\",\n    menu: TemplateMenu.Left,\n    children: []\n  };\n  const suggested = {\n    id: \"suggested1\",\n    name: \"Suggested templates\",\n    description: \"Suggested templates\",\n    type: TemplateType.Category,\n    order: \"0\",\n    info: \"\",\n    helpurl: \"\",\n    menu: TemplateMenu.Left,\n    children: []\n  };\n\n  if (category) {\n    let grandCategory = category;\n\n    do {\n      var _grandCategory;\n\n      grandCategory = (_grandCategory = grandCategory) === null || _grandCategory === void 0 ? void 0 : _grandCategory.parent;\n    } while (grandCategory && grandCategory.menu !== TemplateMenu.Left);\n\n    suggested.children = [...category.children];\n    virtual.children = [suggested];\n\n    if (grandCategory) {\n      const child = { ...grandCategory\n      };\n      const templates = getCategoryTemplates([grandCategory]);\n      child.children = differenceOfObjects(templates, suggested.children, \"id\");\n      virtual.children.push(child);\n    }\n  }\n\n  return [virtual, ...categories];\n}\n\nfunction getCategoryTemplates(items) {\n  const templates = [];\n  items.forEach(item => {\n    if (isCategory(item)) {\n      templates.push(...getCategoryTemplates(item.children));\n    } else {\n      templates.push(item);\n    }\n  });\n  return templates;\n}\n\nexport const getFirstCategory = categories => {\n  for (let i = 0; i < categories.length; i++) {\n    const category = categories[i];\n\n    if (isCategory(category)) {\n      if (hasSubCategory(category)) {\n        return getFirstCategory(category.children);\n      } else {\n        return category;\n      }\n    }\n  }\n};","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/src/components/domain/templates-panel/utils.ts"],"names":["TemplateType","TemplateMenu","CourseDisplay","cloneTemplates","compareVersion","differenceOfObjects","hasSubCategory","isCategory","isTemplate","createCategories","categories","filter","result","virtualCategory","createVirtualCategory","filterItems","orderItems","showAllCategory","createAllCategory","items","item","children","length","filterTemplate","forEach","sort","sortItem","item1","item2","Number","order","template","framework","min","max","displays","structureContexts","scopes","contexts","themes","display","structureContext","scope","context","theme","switchable","includes","FullResponsive","included","every","sc","excluded","all","id","name","description","type","CategoryRoot","info","helpurl","menu","Left","child","Category","getCategoryTemplates","category","virtual","suggested","grandCategory","parent","templates","push","getFirstCategory","i"],"mappings":"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","sourcesContent":["import { TemplateCategory, Template, TemplateFilter } from \"types\";\r\nimport { TemplateType, TemplateMenu, CourseDisplay } from \"editor-constants\";\r\nimport {\r\n  cloneTemplates,\r\n  compareVersion,\r\n  differenceOfObjects,\r\n  hasSubCategory,\r\n  isCategory,\r\n  isTemplate,\r\n} from \"utils\";\r\n\r\nexport function createCategories(categories: TemplateCategory[], filter: TemplateFilter) {\r\n  let result = cloneTemplates(categories);\r\n\r\n  if (result && filter.virtualCategory) {\r\n    result = createVirtualCategory(result, filter.virtualCategory);\r\n  }\r\n\r\n  result = filterItems(result, filter) as TemplateCategory[];\r\n  orderItems(result);\r\n\r\n  if (result && filter.showAllCategory) {\r\n    result = createAllCategory(result);\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nfunction filterItems(\r\n  items: (TemplateCategory | Template)[],\r\n  filter?: TemplateFilter\r\n): TemplateCategory[] | Template[] {\r\n  return items.filter((item) => {\r\n    if (isCategory(item)) {\r\n      item.children = filterItems(item.children, filter);\r\n\r\n      return item.children.length > 0;\r\n    } else if (isTemplate(item)) {\r\n      return filterTemplate(item, filter);\r\n    }\r\n\r\n    return false;\r\n  }) as any[];\r\n}\r\n\r\nfunction orderItems<T extends TemplateCategory[] | Template[]>(items: T): T {\r\n  items.forEach((item: TemplateCategory | Template) => {\r\n    if (isCategory(item) && item.children) {\r\n      orderItems(item.children);\r\n    }\r\n  });\r\n\r\n  items.sort(sortItem);\r\n\r\n  return items;\r\n}\r\n\r\nfunction sortItem<T extends TemplateCategory | Template>(item1: T, item2: T) {\r\n  return Number(item1.order) - Number(item2.order);\r\n}\r\n\r\nfunction filterTemplate(template: Template, filter?: TemplateFilter) {\r\n  const {\r\n    framework: { min, max },\r\n    displays,\r\n    structureContexts,\r\n    scopes,\r\n    contexts,\r\n    themes,\r\n  } = template;\r\n  const { framework, display, structureContext, scope, context, theme, switchable } = filter || {};\r\n\r\n  if (\r\n    (!framework ||\r\n      (min &&\r\n        compareVersion(framework, min) <= 0 &&\r\n        (!max || compareVersion(framework, max) === 1))) &&\r\n    (!display || displays.includes(CourseDisplay.FullResponsive) || displays.includes(display)) &&\r\n    (!structureContext ||\r\n      structureContexts.length === 0 ||\r\n      structureContexts.includes(structureContext)) &&\r\n    (!scope ||\r\n      ((!scope.included || scope.included.every((sc) => scopes.includes(sc))) &&\r\n        (!scope.excluded || scope.excluded.every((sc) => !scopes.includes(sc))))) &&\r\n    ((!context && contexts.length === 0) || (context && contexts.includes(context))) &&\r\n    (!theme || theme === \"none\" || themes.length === 0 || themes.includes(theme)) &&\r\n    (!switchable || template.switchable)\r\n  ) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction createAllCategory(categories: TemplateCategory[]) {\r\n  const all: TemplateCategory = {\r\n    id: \"all\",\r\n    name: \"all\",\r\n    description: \"all\",\r\n    type: TemplateType.CategoryRoot,\r\n    order: \"0\",\r\n    info: \"\",\r\n    helpurl: \"\",\r\n    menu: TemplateMenu.Left,\r\n    children: [],\r\n  };\r\n  const child = { ...all, type: TemplateType.Category };\r\n\r\n  all.children = [child];\r\n  child.children = getCategoryTemplates(categories);\r\n\r\n  return [all, ...categories];\r\n}\r\n\r\nfunction createVirtualCategory(categories: TemplateCategory[], category: TemplateCategory) {\r\n  const virtual: TemplateCategory = {\r\n    id: \"virtual\",\r\n    name: \"Virtual\",\r\n    description: \"Virtual templates\",\r\n    type: TemplateType.CategoryRoot,\r\n    order: \"0\",\r\n    info: \"\",\r\n    helpurl: \"\",\r\n    menu: TemplateMenu.Left,\r\n    children: [],\r\n  };\r\n  const suggested: TemplateCategory = {\r\n    id: \"suggested1\",\r\n    name: \"Suggested templates\",\r\n    description: \"Suggested templates\",\r\n    type: TemplateType.Category,\r\n    order: \"0\",\r\n    info: \"\",\r\n    helpurl: \"\",\r\n    menu: TemplateMenu.Left,\r\n    children: [],\r\n  };\r\n\r\n  if (category) {\r\n    let grandCategory: TemplateCategory | undefined = category;\r\n\r\n    do {\r\n      grandCategory = grandCategory?.parent;\r\n    } while (grandCategory && grandCategory.menu !== TemplateMenu.Left);\r\n\r\n    suggested.children = [...(category.children as Template[])];\r\n    virtual.children = [suggested];\r\n\r\n    if (grandCategory) {\r\n      const child = { ...grandCategory };\r\n      const templates = getCategoryTemplates([grandCategory]);\r\n\r\n      child.children = differenceOfObjects(templates, suggested.children, \"id\");\r\n      virtual.children.push(child);\r\n    }\r\n  }\r\n\r\n  return [virtual, ...categories];\r\n}\r\n\r\nfunction getCategoryTemplates(items: TemplateCategory[] | Template[]) {\r\n  const templates: Template[] = [];\r\n\r\n  items.forEach((item: TemplateCategory | Template) => {\r\n    if (isCategory(item)) {\r\n      templates.push(...getCategoryTemplates(item.children));\r\n    } else {\r\n      templates.push(item);\r\n    }\r\n  });\r\n\r\n  return templates;\r\n}\r\n\r\nexport const getFirstCategory = (\r\n  categories: TemplateCategory[] | Template[]\r\n): TemplateCategory | undefined => {\r\n  for (let i = 0; i < categories.length; i++) {\r\n    const category = categories[i];\r\n\r\n    if (isCategory(category)) {\r\n      if (hasSubCategory(category)) {\r\n        return getFirstCategory(category.children);\r\n      } else {\r\n        return category;\r\n      }\r\n    }\r\n  }\r\n};\r\n"]},"metadata":{},"sourceType":"module"}