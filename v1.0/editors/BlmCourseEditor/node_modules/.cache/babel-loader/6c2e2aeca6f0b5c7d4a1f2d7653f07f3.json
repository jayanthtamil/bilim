{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Rajesh\\\\Downloads\\\\bilim (2)\\\\bilim\\\\v1.0\\\\editors\\\\BlmCourseEditor\\\\src\\\\components\\\\shared\\\\media-editor\\\\components\\\\top-timeline\\\\cue\\\\BlmTopCue.tsx\";\nimport React, { useMemo } from \"react\";\nimport clamp from \"lodash/clamp\";\nimport { MediaCueActions } from \"editor-constants\";\nimport { BlmTransformComponent, DragGeometry, MovementConstraint, SizeConstraint } from \"shared\";\nimport { convertTimeToXPos, convertXPosToTime } from \"../../../utils\";\nimport { useMediaEditorContext } from \"../../context\";\nimport \"./styles.scss\";\nexport function BlmTopCue(props) {\n  const {\n    data,\n    index,\n    wavesurfer,\n    minTime,\n    maxTime,\n    onChange,\n    onDelete,\n    onTimeChange,\n    onContextMenu\n  } = props;\n  const {\n    topOffset,\n    topMinWidth\n  } = useMediaEditorContext();\n  const {\n    startTime,\n    endTime,\n    action\n  } = data;\n  const {\n    scrollTime,\n    duration,\n    pxPerSec\n  } = wavesurfer;\n  const minimum = minTime !== undefined ? minTime + topOffset : 0;\n  const maximum = maxTime !== undefined ? maxTime - topOffset : duration;\n  const isPauseContent = action === MediaCueActions.ScrollVPauseC;\n  const hasEnd = !isNaN(endTime);\n  const model = useMemo(() => {\n    const startX = convertTimeToXPos(startTime, pxPerSec, scrollTime);\n    const endX = isPauseContent ? convertTimeToXPos(endTime, pxPerSec, scrollTime) : startX;\n    const result = new DragGeometry(startX, 0, endX - startX, 22);\n    return result;\n  }, [startTime, endTime, isPauseContent, pxPerSec, scrollTime]);\n  const constraints = useMemo(() => {\n    const move = new MovementConstraint(NaN, 0, NaN, 0);\n    const size = new SizeConstraint();\n    move.minX = convertTimeToXPos(minimum, pxPerSec, scrollTime);\n    move.maxX = convertTimeToXPos(maximum, pxPerSec, scrollTime);\n    size.minWidth = convertTimeToXPos(topMinWidth, pxPerSec);\n    return isPauseContent ? [move, size] : [move];\n  }, [minimum, maximum, isPauseContent, topMinWidth, pxPerSec, scrollTime]);\n\n  const updateChange = newData => {\n    if (onChange) {\n      onChange(data, newData);\n    }\n  };\n\n  const updateTime = time => {\n    if (onTimeChange) {\n      onTimeChange(time);\n    }\n  };\n\n  const updateDelete = () => {\n    if (onDelete) {\n      onDelete(data);\n    }\n  };\n\n  const handleChange = newModel => {\n    const {\n      x,\n      width\n    } = newModel;\n    const newData = { ...data\n    };\n    newData.startTime = convertXPosToTime(x, pxPerSec, scrollTime);\n\n    if (hasEnd) {\n      if (isPauseContent) {\n        newData.endTime = convertXPosToTime(x + width, pxPerSec, scrollTime);\n      } else {\n        const timeDiff = endTime - startTime;\n        newData.endTime = Math.min(newData.startTime + timeDiff, Math.max(maximum, newData.startTime + 0.1));\n      }\n    }\n\n    updateChange(newData);\n  };\n\n  const handleClick = () => {\n    updateTime(startTime + 0.001);\n  };\n\n  const handleKeyDown = event => {\n    const keyCode = event.keyCode;\n\n    switch (keyCode) {\n      case 37:\n        updateChange({ ...data,\n          startTime: clamp(startTime - 0.1, minimum, maximum),\n          endTime: hasEnd ? clamp(endTime - 0.1, minimum, maximum) : NaN\n        });\n        updateTime(startTime - 0.1);\n        break;\n\n      case 39:\n        updateChange({ ...data,\n          startTime: clamp(startTime + 0.1, minimum, maximum),\n          endTime: hasEnd ? clamp(endTime + 0.1, minimum, maximum) : NaN\n        });\n        updateTime(startTime + 0.1);\n        break;\n\n      case 8:\n      case 46:\n        updateDelete();\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  const handleContextMenu = event => {\n    if (onContextMenu) {\n      onContextMenu(event, data);\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(BlmTransformComponent, {\n    tabIndex: index,\n    data: model,\n    hanldes: isPauseContent ? \"e\" : undefined,\n    constraints: constraints,\n    className: \"top-cue-wrapper\",\n    onChange: handleChange,\n    onClick: handleClick,\n    onKeyDown: handleKeyDown,\n    onContextMenu: handleContextMenu,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 5\n    }\n  });\n}\nexport default BlmTopCue;","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/src/components/shared/media-editor/components/top-timeline/cue/BlmTopCue.tsx"],"names":["React","useMemo","clamp","MediaCueActions","BlmTransformComponent","DragGeometry","MovementConstraint","SizeConstraint","convertTimeToXPos","convertXPosToTime","useMediaEditorContext","BlmTopCue","props","data","index","wavesurfer","minTime","maxTime","onChange","onDelete","onTimeChange","onContextMenu","topOffset","topMinWidth","startTime","endTime","action","scrollTime","duration","pxPerSec","minimum","undefined","maximum","isPauseContent","ScrollVPauseC","hasEnd","isNaN","model","startX","endX","result","constraints","move","NaN","size","minX","maxX","minWidth","updateChange","newData","updateTime","time","updateDelete","handleChange","newModel","x","width","timeDiff","Math","min","max","handleClick","handleKeyDown","event","keyCode","handleContextMenu"],"mappings":"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","sourcesContent":["import React, { KeyboardEvent, MouseEvent, useMemo } from \"react\";\r\nimport clamp from \"lodash/clamp\";\r\n\r\nimport { MediaTrackCue, MediaWavesurfer } from \"types\";\r\nimport { MediaCueActions } from \"editor-constants\";\r\nimport { BlmTransformComponent, DragGeometry, MovementConstraint, SizeConstraint } from \"shared\";\r\nimport { convertTimeToXPos, convertXPosToTime } from \"../../../utils\";\r\nimport { useMediaEditorContext } from \"../../context\";\r\nimport \"./styles.scss\";\r\n\r\nexport interface TopCueProps {\r\n  data: MediaTrackCue;\r\n  index: number;\r\n  wavesurfer: MediaWavesurfer;\r\n  minTime?: number;\r\n  maxTime?: number;\r\n  onChange?: (oldData: MediaTrackCue, newData: MediaTrackCue) => void;\r\n  onDelete?: (data: MediaTrackCue) => void;\r\n  onTimeChange?: (time: number) => void;\r\n  onContextMenu?: (event: MouseEvent, data: MediaTrackCue) => void;\r\n}\r\n\r\nexport function BlmTopCue(props: TopCueProps) {\r\n  const {\r\n    data,\r\n    index,\r\n    wavesurfer,\r\n    minTime,\r\n    maxTime,\r\n    onChange,\r\n    onDelete,\r\n    onTimeChange,\r\n    onContextMenu,\r\n  } = props;\r\n  const { topOffset, topMinWidth } = useMediaEditorContext();\r\n  const { startTime, endTime, action } = data;\r\n  const { scrollTime, duration, pxPerSec } = wavesurfer;\r\n  const minimum = minTime !== undefined ? minTime + topOffset : 0;\r\n  const maximum = maxTime !== undefined ? maxTime - topOffset : duration;\r\n  const isPauseContent = action === MediaCueActions.ScrollVPauseC;\r\n  const hasEnd = !isNaN(endTime);\r\n\r\n  const model = useMemo(() => {\r\n    const startX = convertTimeToXPos(startTime, pxPerSec, scrollTime);\r\n    const endX = isPauseContent ? convertTimeToXPos(endTime, pxPerSec, scrollTime) : startX;\r\n    const result = new DragGeometry(startX, 0, endX - startX, 22);\r\n\r\n    return result;\r\n  }, [startTime, endTime, isPauseContent, pxPerSec, scrollTime]);\r\n\r\n  const constraints = useMemo(() => {\r\n    const move = new MovementConstraint(NaN, 0, NaN, 0);\r\n    const size = new SizeConstraint();\r\n\r\n    move.minX = convertTimeToXPos(minimum, pxPerSec, scrollTime);\r\n    move.maxX = convertTimeToXPos(maximum, pxPerSec, scrollTime);\r\n\r\n    size.minWidth = convertTimeToXPos(topMinWidth, pxPerSec);\r\n\r\n    return isPauseContent ? [move, size] : [move];\r\n  }, [minimum, maximum, isPauseContent, topMinWidth, pxPerSec, scrollTime]);\r\n\r\n  const updateChange = (newData: MediaTrackCue) => {\r\n    if (onChange) {\r\n      onChange(data, newData);\r\n    }\r\n  };\r\n\r\n  const updateTime = (time: number) => {\r\n    if (onTimeChange) {\r\n      onTimeChange(time);\r\n    }\r\n  };\r\n\r\n  const updateDelete = () => {\r\n    if (onDelete) {\r\n      onDelete(data);\r\n    }\r\n  };\r\n\r\n  const handleChange = (newModel: DragGeometry) => {\r\n    const { x, width } = newModel;\r\n    const newData = { ...data };\r\n\r\n    newData.startTime = convertXPosToTime(x, pxPerSec, scrollTime);\r\n\r\n    if (hasEnd) {\r\n      if (isPauseContent) {\r\n        newData.endTime = convertXPosToTime(x + width, pxPerSec, scrollTime);\r\n      } else {\r\n        const timeDiff = endTime - startTime;\r\n\r\n        newData.endTime = Math.min(\r\n          newData.startTime + timeDiff,\r\n          Math.max(maximum, newData.startTime + 0.1)\r\n        );\r\n      }\r\n    }\r\n\r\n    updateChange(newData);\r\n  };\r\n\r\n  const handleClick = () => {\r\n    updateTime(startTime + 0.001);\r\n  };\r\n\r\n  const handleKeyDown = (event: KeyboardEvent) => {\r\n    const keyCode = event.keyCode;\r\n\r\n    switch (keyCode) {\r\n      case 37:\r\n        updateChange({\r\n          ...data,\r\n          startTime: clamp(startTime - 0.1, minimum, maximum),\r\n          endTime: hasEnd ? clamp(endTime - 0.1, minimum, maximum) : NaN,\r\n        });\r\n        updateTime(startTime - 0.1);\r\n        break;\r\n      case 39:\r\n        updateChange({\r\n          ...data,\r\n          startTime: clamp(startTime + 0.1, minimum, maximum),\r\n          endTime: hasEnd ? clamp(endTime + 0.1, minimum, maximum) : NaN,\r\n        });\r\n        updateTime(startTime + 0.1);\r\n        break;\r\n      case 8:\r\n      case 46:\r\n        updateDelete();\r\n        break;\r\n      default:\r\n        break;\r\n    }\r\n  };\r\n\r\n  const handleContextMenu = (event: MouseEvent) => {\r\n    if (onContextMenu) {\r\n      onContextMenu(event, data);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <BlmTransformComponent\r\n      tabIndex={index}\r\n      data={model}\r\n      hanldes={isPauseContent ? \"e\" : undefined}\r\n      constraints={constraints}\r\n      className=\"top-cue-wrapper\"\r\n      onChange={handleChange}\r\n      onClick={handleClick}\r\n      onKeyDown={handleKeyDown}\r\n      onContextMenu={handleContextMenu}\r\n    />\r\n  );\r\n}\r\n\r\nexport default BlmTopCue;\r\n"]},"metadata":{},"sourceType":"module"}