{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Rajesh\\\\Downloads\\\\bilim (2)\\\\bilim\\\\v1.0\\\\editors\\\\BlmCourseEditor\\\\src\\\\components\\\\shared\\\\media-editor\\\\components\\\\ruler\\\\BlmRuler.tsx\";\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\nimport clamp from \"lodash/clamp\";\nimport { convertXPosToTime } from \"../../utils\";\nimport \"./styles.scss\";\nconst initDrag = {\n  status: false,\n  startX: 0,\n  endX: 0\n};\n\nfunction BlmRuler(props) {\n  const {\n    type,\n    isPlaying,\n    wavesurfer,\n    onAdd\n  } = props;\n  const containerRef = useRef(null);\n  const [dragging, setDragging] = useState(initDrag);\n  const [dragged, setDragged] = useState();\n  const {\n    status,\n    startX,\n    endX\n  } = dragging;\n  const {\n    scrollTime,\n    pxPerSec,\n    duration\n  } = wavesurfer;\n  useEffect(() => {\n    if (dragged) {\n      const {\n        startX,\n        endX\n      } = dragged;\n      const startTime = clamp(convertXPosToTime(startX, pxPerSec, scrollTime), 0, duration);\n      const endTime = clamp(convertXPosToTime(endX, pxPerSec, scrollTime), 0, duration);\n\n      if (startTime >= 0 && endTime > 0 && endTime - startTime >= 0.2) {\n        onAdd && onAdd(type, startTime, endTime);\n        setDragged(undefined);\n      }\n    }\n  }, [type, dragged, pxPerSec, scrollTime, duration, onAdd]);\n\n  const handleMouseDown = event => {\n    if (containerRef.current && !isPlaying) {\n      const rect = containerRef.current.getBoundingClientRect();\n      const xPos = event.clientX - rect.x;\n      setDragging({\n        status: true,\n        startX: xPos,\n        endX: xPos\n      });\n      document.addEventListener(\"mouseup\", handleDocumentMouseUp);\n    }\n  };\n\n  const handleMouseMove = event => {\n    if (dragging.status && containerRef.current && !isPlaying) {\n      const rect = containerRef.current.getBoundingClientRect();\n      const xPos = event.clientX - rect.x;\n      setDragging(state => ({ ...state,\n        endX: xPos\n      }));\n    }\n  };\n\n  const handleDocumentMouseUp = useCallback(event => {\n    setDragging(state => {\n      setDragged(state);\n      return { ...initDrag\n      };\n    });\n    document.removeEventListener(\"mouseup\", handleDocumentMouseUp);\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: containerRef,\n    className: \"ruler-wrapper\",\n    onMouseDown: handleMouseDown,\n    onMouseMove: handleMouseMove,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 5\n    }\n  }, !isPlaying && status && startX && endX && endX > startX ? /*#__PURE__*/React.createElement(\"div\", {\n    style: {\n      left: startX,\n      width: endX - startX\n    },\n    className: \"ruler-selection-wrapper\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }) : null);\n}\n\nexport default BlmRuler;","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/src/components/shared/media-editor/components/ruler/BlmRuler.tsx"],"names":["React","useCallback","useEffect","useRef","useState","clamp","convertXPosToTime","initDrag","status","startX","endX","BlmRuler","props","type","isPlaying","wavesurfer","onAdd","containerRef","dragging","setDragging","dragged","setDragged","scrollTime","pxPerSec","duration","startTime","endTime","undefined","handleMouseDown","event","current","rect","getBoundingClientRect","xPos","clientX","x","document","addEventListener","handleDocumentMouseUp","handleMouseMove","state","removeEventListener","left","width"],"mappings":";AAAA,OAAOA,KAAP,IAEEC,WAFF,EAGEC,SAHF,EAIEC,MAJF,EAKEC,QALF,QAMO,OANP;AAOA,OAAOC,KAAP,MAAkB,cAAlB;AAGA,SAASC,iBAAT,QAAkC,aAAlC;AACA,OAAO,eAAP;AAgBA,MAAMC,QAAmB,GAAG;AAAEC,EAAAA,MAAM,EAAE,KAAV;AAAiBC,EAAAA,MAAM,EAAE,CAAzB;AAA4BC,EAAAA,IAAI,EAAE;AAAlC,CAA5B;;AAEA,SAASC,QAAT,CAAkBC,KAAlB,EAAoC;AAClC,QAAM;AAAEC,IAAAA,IAAF;AAAQC,IAAAA,SAAR;AAAmBC,IAAAA,UAAnB;AAA+BC,IAAAA;AAA/B,MAAyCJ,KAA/C;AACA,QAAMK,YAAY,GAAGd,MAAM,CAAiB,IAAjB,CAA3B;AACA,QAAM,CAACe,QAAD,EAAWC,WAAX,IAA0Bf,QAAQ,CAACG,QAAD,CAAxC;AACA,QAAM,CAACa,OAAD,EAAUC,UAAV,IAAwBjB,QAAQ,EAAtC;AACA,QAAM;AAAEI,IAAAA,MAAF;AAAUC,IAAAA,MAAV;AAAkBC,IAAAA;AAAlB,MAA2BQ,QAAjC;AACA,QAAM;AAAEI,IAAAA,UAAF;AAAcC,IAAAA,QAAd;AAAwBC,IAAAA;AAAxB,MAAqCT,UAA3C;AAEAb,EAAAA,SAAS,CAAC,MAAM;AACd,QAAIkB,OAAJ,EAAa;AACX,YAAM;AAAEX,QAAAA,MAAF;AAAUC,QAAAA;AAAV,UAAmBU,OAAzB;AACA,YAAMK,SAAS,GAAGpB,KAAK,CAACC,iBAAiB,CAACG,MAAD,EAASc,QAAT,EAAmBD,UAAnB,CAAlB,EAAkD,CAAlD,EAAqDE,QAArD,CAAvB;AACA,YAAME,OAAO,GAAGrB,KAAK,CAACC,iBAAiB,CAACI,IAAD,EAAOa,QAAP,EAAiBD,UAAjB,CAAlB,EAAgD,CAAhD,EAAmDE,QAAnD,CAArB;;AAEA,UAAIC,SAAS,IAAI,CAAb,IAAkBC,OAAO,GAAG,CAA5B,IAAiCA,OAAO,GAAGD,SAAV,IAAuB,GAA5D,EAAiE;AAC/DT,QAAAA,KAAK,IAAIA,KAAK,CAACH,IAAD,EAAOY,SAAP,EAAkBC,OAAlB,CAAd;AACAL,QAAAA,UAAU,CAACM,SAAD,CAAV;AACD;AACF;AACF,GAXQ,EAWN,CAACd,IAAD,EAAOO,OAAP,EAAgBG,QAAhB,EAA0BD,UAA1B,EAAsCE,QAAtC,EAAgDR,KAAhD,CAXM,CAAT;;AAaA,QAAMY,eAAe,GAAIC,KAAD,IAA4B;AAClD,QAAIZ,YAAY,CAACa,OAAb,IAAwB,CAAChB,SAA7B,EAAwC;AACtC,YAAMiB,IAAI,GAAGd,YAAY,CAACa,OAAb,CAAqBE,qBAArB,EAAb;AACA,YAAMC,IAAI,GAAGJ,KAAK,CAACK,OAAN,GAAgBH,IAAI,CAACI,CAAlC;AAEAhB,MAAAA,WAAW,CAAC;AAAEX,QAAAA,MAAM,EAAE,IAAV;AAAgBC,QAAAA,MAAM,EAAEwB,IAAxB;AAA8BvB,QAAAA,IAAI,EAAEuB;AAApC,OAAD,CAAX;AAEAG,MAAAA,QAAQ,CAACC,gBAAT,CAA0B,SAA1B,EAAqCC,qBAArC;AACD;AACF,GATD;;AAWA,QAAMC,eAAe,GAAIV,KAAD,IAA4B;AAClD,QAAIX,QAAQ,CAACV,MAAT,IAAmBS,YAAY,CAACa,OAAhC,IAA2C,CAAChB,SAAhD,EAA2D;AACzD,YAAMiB,IAAI,GAAGd,YAAY,CAACa,OAAb,CAAqBE,qBAArB,EAAb;AACA,YAAMC,IAAI,GAAGJ,KAAK,CAACK,OAAN,GAAgBH,IAAI,CAACI,CAAlC;AAEAhB,MAAAA,WAAW,CAAEqB,KAAD,KAAY,EACtB,GAAGA,KADmB;AAEtB9B,QAAAA,IAAI,EAAEuB;AAFgB,OAAZ,CAAD,CAAX;AAID;AACF,GAVD;;AAYA,QAAMK,qBAAqB,GAAGrC,WAAW,CAAE4B,KAAD,IAAuB;AAC/DV,IAAAA,WAAW,CAAEqB,KAAD,IAAW;AACrBnB,MAAAA,UAAU,CAACmB,KAAD,CAAV;AAEA,aAAO,EAAE,GAAGjC;AAAL,OAAP;AACD,KAJU,CAAX;AAMA6B,IAAAA,QAAQ,CAACK,mBAAT,CAA6B,SAA7B,EAAwCH,qBAAxC;AACD,GARwC,EAQtC,EARsC,CAAzC;AAUA,sBACE;AACE,IAAA,GAAG,EAAErB,YADP;AAEE,IAAA,SAAS,EAAC,eAFZ;AAGE,IAAA,WAAW,EAAEW,eAHf;AAIE,IAAA,WAAW,EAAEW,eAJf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAMG,CAACzB,SAAD,IAAcN,MAAd,IAAwBC,MAAxB,IAAkCC,IAAlC,IAA0CA,IAAI,GAAGD,MAAjD,gBACC;AACE,IAAA,KAAK,EAAE;AACLiC,MAAAA,IAAI,EAAEjC,MADD;AAELkC,MAAAA,KAAK,EAAEjC,IAAI,GAAGD;AAFT,KADT;AAKE,IAAA,SAAS,EAAC,yBALZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IADD,GAQG,IAdN,CADF;AAkBD;;AAED,eAAeE,QAAf","sourcesContent":["import React, {\r\n  MouseEvent as ReactMouseEvent,\r\n  useCallback,\r\n  useEffect,\r\n  useRef,\r\n  useState,\r\n} from \"react\";\r\nimport clamp from \"lodash/clamp\";\r\n\r\nimport { MediaWavesurfer } from \"types\";\r\nimport { convertXPosToTime } from \"../../utils\";\r\nimport \"./styles.scss\";\r\nimport { MediaTrackTypes } from \"editor-constants\";\r\n\r\nexport interface CompProps {\r\n  type: MediaTrackTypes;\r\n  isPlaying: boolean;\r\n  wavesurfer: MediaWavesurfer;\r\n  onAdd?: (type: MediaTrackTypes, startTime: number, endTime: number) => void;\r\n}\r\n\r\ninterface DragState {\r\n  status: boolean;\r\n  startX: number;\r\n  endX: number;\r\n}\r\n\r\nconst initDrag: DragState = { status: false, startX: 0, endX: 0 };\r\n\r\nfunction BlmRuler(props: CompProps) {\r\n  const { type, isPlaying, wavesurfer, onAdd } = props;\r\n  const containerRef = useRef<HTMLDivElement>(null);\r\n  const [dragging, setDragging] = useState(initDrag);\r\n  const [dragged, setDragged] = useState<DragState>();\r\n  const { status, startX, endX } = dragging;\r\n  const { scrollTime, pxPerSec, duration } = wavesurfer;\r\n\r\n  useEffect(() => {\r\n    if (dragged) {\r\n      const { startX, endX } = dragged;\r\n      const startTime = clamp(convertXPosToTime(startX, pxPerSec, scrollTime), 0, duration);\r\n      const endTime = clamp(convertXPosToTime(endX, pxPerSec, scrollTime), 0, duration);\r\n\r\n      if (startTime >= 0 && endTime > 0 && endTime - startTime >= 0.2) {\r\n        onAdd && onAdd(type, startTime, endTime);\r\n        setDragged(undefined);\r\n      }\r\n    }\r\n  }, [type, dragged, pxPerSec, scrollTime, duration, onAdd]);\r\n\r\n  const handleMouseDown = (event: ReactMouseEvent) => {\r\n    if (containerRef.current && !isPlaying) {\r\n      const rect = containerRef.current.getBoundingClientRect();\r\n      const xPos = event.clientX - rect.x;\r\n\r\n      setDragging({ status: true, startX: xPos, endX: xPos });\r\n\r\n      document.addEventListener(\"mouseup\", handleDocumentMouseUp);\r\n    }\r\n  };\r\n\r\n  const handleMouseMove = (event: ReactMouseEvent) => {\r\n    if (dragging.status && containerRef.current && !isPlaying) {\r\n      const rect = containerRef.current.getBoundingClientRect();\r\n      const xPos = event.clientX - rect.x;\r\n\r\n      setDragging((state) => ({\r\n        ...state,\r\n        endX: xPos,\r\n      }));\r\n    }\r\n  };\r\n\r\n  const handleDocumentMouseUp = useCallback((event: MouseEvent) => {\r\n    setDragging((state) => {\r\n      setDragged(state);\r\n\r\n      return { ...initDrag };\r\n    });\r\n\r\n    document.removeEventListener(\"mouseup\", handleDocumentMouseUp);\r\n  }, []);\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef}\r\n      className=\"ruler-wrapper\"\r\n      onMouseDown={handleMouseDown}\r\n      onMouseMove={handleMouseMove}\r\n    >\r\n      {!isPlaying && status && startX && endX && endX > startX ? (\r\n        <div\r\n          style={{\r\n            left: startX,\r\n            width: endX - startX,\r\n          }}\r\n          className=\"ruler-selection-wrapper\"\r\n        />\r\n      ) : null}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default BlmRuler;\r\n"]},"metadata":{},"sourceType":"module"}