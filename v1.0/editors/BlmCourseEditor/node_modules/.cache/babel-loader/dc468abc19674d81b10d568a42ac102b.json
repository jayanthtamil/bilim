{"ast":null,"code":"import { CourseStructure, CourseElement, ElementConnection, AssociatedTemplate } from \"types\";\nimport { ElementType } from \"editor-constants\";\nimport { forEachStructure, isValidLinkedElement, toBoolean, toJSONObject } from \"utils\";\nexport function createCourseStructureModel(response) {\n  const {\n    starting,\n    structure,\n    annexes\n  } = response;\n  const result = new CourseStructure();\n  const linkedIds = [];\n  result.starting = starting && starting.length ? createElementModels(starting, linkedIds)[0] : new CourseElement(\"\", \"Starting\", ElementType.Starting);\n  result.structure = structure && structure.length ? createElementModels(structure, linkedIds)[0] : new CourseElement(\"\", \"Structrues\", ElementType.Structure);\n  result.annexes = annexes && annexes.length ? createElementModels(annexes, linkedIds)[0] : new CourseElement(\"\", \"Annexes\", ElementType.Annexes);\n\n  if (result) {\n    forEachStructure(result, item => {\n      if (isValidLinkedElement(item)) {\n        item.isLinked = linkedIds.includes(item.id);\n      }\n    });\n  }\n\n  return result;\n}\n\nfunction createElementModels(responses, linkedIds, root, parent, level = 0) {\n  const elements = [];\n\n  if (responses) {\n    for (let response of responses) {\n      var _element$htmlJSON;\n\n      const element = new CourseElement(response.id, response.name, response.type);\n      element.level = level;\n      element.theme = response.theme_ref;\n      element.isDirectEvaluation = toBoolean(response.direct_evaluation);\n      element.isEvaluation = toBoolean(response.isevaluation);\n      element.hasFeedback = toBoolean(response.hasfeedback);\n      element.hasAssociateContent = toBoolean(response.hasassociatecontent);\n      element.isSummary = toBoolean(response.summary);\n      element.styleSummary = response.styleSummary ? toBoolean(response.styleSummary) : true;\n      element.templateType = response.template_type;\n      element.template = createTemplateModel(response.template);\n      element.connections = createConnectionModel(response.connections);\n      element.root = root;\n      element.parent = parent;\n      element.children = createElementModels(response.children, linkedIds, root !== null && root !== void 0 ? root : element, element, level + 1);\n      element.propsJSON = toJSONObject(response.props_param);\n      element.htmlJSON = toJSONObject(response.htmlParam);\n\n      if (element.propsJSON) {\n        var _element$propsJSON$li, _element$propsJSON$li2;\n\n        if ((_element$propsJSON$li = element.propsJSON.linkedElements) === null || _element$propsJSON$li === void 0 ? void 0 : (_element$propsJSON$li2 = _element$propsJSON$li.evaluations) === null || _element$propsJSON$li2 === void 0 ? void 0 : _element$propsJSON$li2.length) {\n          linkedIds.push(...element.propsJSON.linkedElements.evaluations);\n        }\n      }\n\n      if ((_element$htmlJSON = element.htmlJSON) === null || _element$htmlJSON === void 0 ? void 0 : _element$htmlJSON.linkedElements) {\n        var _element$htmlJSON$lin, _element$htmlJSON$lin2;\n\n        if ((_element$htmlJSON$lin = element.htmlJSON.linkedElements.actions) === null || _element$htmlJSON$lin === void 0 ? void 0 : _element$htmlJSON$lin.length) {\n          linkedIds.push(...element.htmlJSON.linkedElements.actions);\n        }\n\n        if ((_element$htmlJSON$lin2 = element.htmlJSON.linkedElements.components) === null || _element$htmlJSON$lin2 === void 0 ? void 0 : _element$htmlJSON$lin2.length) {\n          linkedIds.push(...element.htmlJSON.linkedElements.components);\n        }\n      }\n\n      elements.push(element);\n    }\n  }\n\n  return elements;\n}\n\nfunction createTemplateModel(response) {\n  if (typeof response === \"object\" && response.id) {\n    const template = new AssociatedTemplate(response.id);\n    template.interaction = toBoolean(response.interaction);\n    template.theme = response.theme;\n    template.framework = {\n      min: response.framework_min || undefined,\n      max: response.framework_max || undefined\n    };\n    template.course_context = response.course_context;\n    return template;\n  }\n}\n\nfunction createConnectionModel(responses) {\n  if (responses) {\n    var connections = [];\n\n    for (let response of responses) {\n      connections.push(new ElementConnection(response.value));\n    }\n\n    return connections;\n  }\n\n  return null;\n}","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/src/redux/course/structure/utils/index.ts"],"names":["CourseStructure","CourseElement","ElementConnection","AssociatedTemplate","ElementType","forEachStructure","isValidLinkedElement","toBoolean","toJSONObject","createCourseStructureModel","response","starting","structure","annexes","result","linkedIds","length","createElementModels","Starting","Structure","Annexes","item","isLinked","includes","id","responses","root","parent","level","elements","element","name","type","theme","theme_ref","isDirectEvaluation","direct_evaluation","isEvaluation","isevaluation","hasFeedback","hasfeedback","hasAssociateContent","hasassociatecontent","isSummary","summary","styleSummary","templateType","template_type","template","createTemplateModel","connections","createConnectionModel","children","propsJSON","props_param","htmlJSON","htmlParam","linkedElements","evaluations","push","actions","components","interaction","framework","min","framework_min","undefined","max","framework_max","course_context","value"],"mappings":"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","sourcesContent":["import { CourseStructure, CourseElement, ElementConnection, AssociatedTemplate } from \"types\";\r\nimport { ElementType, ConnectionType, TemplateTypes } from \"editor-constants\";\r\nimport { forEachStructure, isValidLinkedElement, toBoolean, toJSONObject } from \"utils\";\r\nimport {\r\n  CourseStructureResponse,\r\n  ElementResponse,\r\n  ConnectionResponse,\r\n  BaseAssociatedTemplateResponse,\r\n} from \"../types\";\r\n\r\nexport function createCourseStructureModel(response: CourseStructureResponse) {\r\n  const { starting, structure, annexes } = response;\r\n  const result = new CourseStructure();\r\n  const linkedIds: string[] = [];\r\n\r\n  result.starting =\r\n    starting && starting.length\r\n      ? createElementModels(starting, linkedIds)[0]\r\n      : new CourseElement(\"\", \"Starting\", ElementType.Starting);\r\n  result.structure =\r\n    structure && structure.length\r\n      ? createElementModels(structure, linkedIds)[0]\r\n      : new CourseElement(\"\", \"Structrues\", ElementType.Structure);\r\n  result.annexes =\r\n    annexes && annexes.length\r\n      ? createElementModels(annexes, linkedIds)[0]\r\n      : new CourseElement(\"\", \"Annexes\", ElementType.Annexes);\r\n\r\n  if (result) {\r\n    forEachStructure(result, (item) => {\r\n      if (isValidLinkedElement(item)) {\r\n        item.isLinked = linkedIds.includes(item.id);\r\n      }\r\n    });\r\n  }\r\n\r\n  return result;\r\n}\r\n\r\nfunction createElementModels(\r\n  responses: ElementResponse[],\r\n  linkedIds: string[],\r\n  root?: CourseElement,\r\n  parent?: CourseElement,\r\n  level: number = 0\r\n) {\r\n  const elements: CourseElement[] = [];\r\n\r\n  if (responses) {\r\n    for (let response of responses) {\r\n      const element = new CourseElement(response.id, response.name, response.type as ElementType);\r\n      element.level = level;\r\n      element.theme = response.theme_ref;\r\n      element.isDirectEvaluation = toBoolean(response.direct_evaluation);\r\n      element.isEvaluation = toBoolean(response.isevaluation);\r\n      element.hasFeedback = toBoolean(response.hasfeedback);\r\n      element.hasAssociateContent = toBoolean(response.hasassociatecontent);\r\n      element.isSummary = toBoolean(response.summary);\r\n      element.styleSummary = response.styleSummary ? toBoolean(response.styleSummary) : true;\r\n      element.templateType = response.template_type as TemplateTypes;\r\n      element.template = createTemplateModel(response.template);\r\n      element.connections = createConnectionModel(response.connections);\r\n      element.root = root;\r\n      element.parent = parent;\r\n      element.children = createElementModels(\r\n        response.children,\r\n        linkedIds,\r\n        root ?? element,\r\n        element,\r\n        level + 1\r\n      );\r\n      element.propsJSON = toJSONObject(response.props_param);\r\n      element.htmlJSON = toJSONObject(response.htmlParam);\r\n\r\n      if (element.propsJSON) {\r\n        if (element.propsJSON.linkedElements?.evaluations?.length) {\r\n          linkedIds.push(...element.propsJSON.linkedElements.evaluations);\r\n        }\r\n      }\r\n\r\n      if (element.htmlJSON?.linkedElements) {\r\n        if (element.htmlJSON.linkedElements.actions?.length) {\r\n          linkedIds.push(...element.htmlJSON.linkedElements.actions);\r\n        }\r\n        if (element.htmlJSON.linkedElements.components?.length) {\r\n          linkedIds.push(...element.htmlJSON.linkedElements.components);\r\n        }\r\n      }\r\n\r\n      elements.push(element);\r\n    }\r\n  }\r\n\r\n  return elements;\r\n}\r\n\r\nfunction createTemplateModel(response?: BaseAssociatedTemplateResponse) {\r\n  if (typeof response === \"object\" && response.id) {\r\n    const template = new AssociatedTemplate(response.id);\r\n    template.interaction = toBoolean(response.interaction);\r\n    template.theme = response.theme;\r\n    template.framework = {\r\n      min: response.framework_min || undefined,\r\n      max: response.framework_max || undefined,\r\n    };\r\n    template.course_context = response.course_context;\r\n\r\n    return template;\r\n  }\r\n}\r\n\r\nfunction createConnectionModel(responses: ConnectionResponse[] | null) {\r\n  if (responses) {\r\n    var connections: ElementConnection[] = [];\r\n\r\n    for (let response of responses) {\r\n      connections.push(new ElementConnection(response.value as ConnectionType));\r\n    }\r\n\r\n    return connections;\r\n  }\r\n  return null;\r\n}\r\n"]},"metadata":{},"sourceType":"module"}