{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Rajesh\\\\Downloads\\\\bilim (2)\\\\bilim\\\\v1.0\\\\editors\\\\BlmCourseEditor\\\\src\\\\components\\\\properties\\\\controls\\\\completion-prerequisite\\\\BlmCompletionPrerequisiteProps.tsx\";\nimport React, { Fragment, useMemo } from \"react\";\nimport clsx from \"clsx\";\nimport { RadioGroup, FormGroup, FormControlLabel, Checkbox, Radio } from \"@material-ui/core\";\nimport { useTranslation } from \"react-i18next\";\nimport { CompletionType, ElementType } from \"editor-constants\";\nimport { getPreviousElements } from \"utils\";\nimport { BlmSubscriptInput } from \"shared\";\nimport \"./styles.scss\";\n\nfunction BlmCompletionPrerequisiteProps(props) {\n  const {\n    type,\n    course,\n    element,\n    data,\n    onChange\n  } = props;\n  const {\n    isCompletion\n  } = data;\n  const crsCompletion = course === null || course === void 0 ? void 0 : course.completion;\n  const crsNavigation = course === null || course === void 0 ? void 0 : course.navigation;\n  const completion = data.completionJSON;\n  const prerequisite = data.prerequisiteJSON;\n  const siblings = useMemo(() => getPreviousElements(element), [element]);\n  const isPartPage = element.type === ElementType.PartPage;\n  const {\n    t\n  } = useTranslation(\"properties\");\n  const completionJSON = useMemo(() => {\n    if (completion.completion === CompletionType.None && (crsCompletion === null || crsCompletion === void 0 ? void 0 : crsCompletion.completion)) {\n      return { ...completion,\n        completion: crsCompletion.completion,\n        actions: { ...completion.actions,\n          ...crsCompletion.actions\n        }\n      };\n    }\n\n    return completion;\n  }, [crsCompletion, completion]);\n  const prerequisiteJSON = useMemo(() => {\n    var _prerequisite$sibling;\n\n    const ids = siblings.map(element => element.id);\n    return { ...prerequisite,\n      checked: siblings.length > 0 && prerequisite.checked,\n      siblings: !prerequisite.siblings && (crsNavigation === null || crsNavigation === void 0 ? void 0 : crsNavigation.prerequisite) && ids.length ? [ids[ids.length - 1]] : ((_prerequisite$sibling = prerequisite.siblings) === null || _prerequisite$sibling === void 0 ? void 0 : _prerequisite$sibling.filter(id => ids.includes(id))) || []\n    };\n  }, [crsNavigation, prerequisite, siblings]);\n\n  const updateChange = newData => {\n    if (onChange) {\n      onChange(newData);\n    }\n  };\n\n  const handleChange = event => {\n    const target = event.target;\n    const value = target.type === \"checkbox\" ? target.checked : target.value;\n    const name = target.name;\n    const newData = { ...data,\n      completionJSON,\n      prerequisiteJSON\n    };\n\n    if (name === \"completion-chk\") {\n      newData.isCompletion = value;\n    } else if (name === \"prerequisite_chk\") {\n      newData.prerequisiteJSON = { ...prerequisiteJSON,\n        checked: value\n      };\n    } else if (name === \"siblings_chk\") {\n      const id = target.value;\n      const newSiblings = [...(prerequisiteJSON.siblings || [])];\n      const ind = newSiblings.indexOf(id);\n\n      if (value && ind === -1) {\n        newSiblings.push(id);\n      } else if (!value && ind !== -1) {\n        newSiblings.splice(ind, 1);\n      }\n\n      newData.prerequisiteJSON = { ...prerequisiteJSON,\n        siblings: newSiblings\n      };\n    } else if (completionJSON.actions.hasOwnProperty(name)) {\n      newData.completionJSON = { ...completionJSON,\n        actions: { ...completionJSON.actions,\n          [name]: value\n        }\n      };\n    } else {\n      newData.completionJSON = { ...completionJSON,\n        [name]: value\n      };\n    }\n\n    updateChange(newData);\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: clsx(\"completion-prerequisite-props-container\", type),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }\n  }, type !== \"prerequisite\" && /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FormControlLabel, {\n    name: \"completion-chk\",\n    label: t(\"completion.title\"),\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 22\n      }\n    }),\n    checked: isCompletion,\n    className: \"completion-chk-ctrl-lbl\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 11\n    }\n  }), isCompletion && /*#__PURE__*/React.createElement(Fragment, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(RadioGroup, {\n    name: \"completion\",\n    value: completionJSON.completion,\n    className: \"completion-radio-group\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(FormControlLabel, {\n    label: t(\"completion.screen_displayed\"),\n    control: /*#__PURE__*/React.createElement(Radio, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 28\n      }\n    }),\n    value: CompletionType.ScreenDisplayed,\n    className: \"completion-form-ctrl-lbl\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    label: t(\"completion.screen_undisplayed\"),\n    control: /*#__PURE__*/React.createElement(Radio, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 28\n      }\n    }),\n    value: CompletionType.ScreenUndisplayed,\n    className: \"completion-form-ctrl-lbl\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    label: t(\"completion.action\"),\n    control: /*#__PURE__*/React.createElement(Radio, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 28\n      }\n    }),\n    value: CompletionType.ByAction,\n    className: \"completion-form-ctrl-lbl\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  })), completionJSON.completion === CompletionType.ByAction && /*#__PURE__*/React.createElement(FormGroup, {\n    className: \"completion-form-group\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(FormControlLabel, {\n    name: \"all_button_clicked\",\n    label: t(\"completion.all_button\"),\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 30\n      }\n    }),\n    checked: completionJSON.actions.all_button_clicked,\n    className: \"completion-form-ctrl-lbl\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    name: \"video_complete\",\n    label: t(\"completion.video_complete\"),\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 30\n      }\n    }),\n    checked: completionJSON.actions.video_complete,\n    className: \"completion-form-ctrl-lbl\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    name: \"sound_complete\",\n    label: t(\"completion.sound_complete\"),\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 30\n      }\n    }),\n    checked: completionJSON.actions.sound_complete,\n    className: \"completion-form-ctrl-lbl\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    name: \"animation_complete\",\n    label: t(\"completion.animation_complete\"),\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 30\n      }\n    }),\n    checked: completionJSON.actions.animation_complete,\n    className: \"completion-form-ctrl-lbl\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    name: \"interaction_complete\",\n    label: t(\"completion.interaction_complete\"),\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 30\n      }\n    }),\n    checked: completionJSON.actions.interaction_complete,\n    className: \"completion-form-ctrl-lbl\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(FormControlLabel, {\n    name: \"timer\",\n    label: t(\"completion.timer\"),\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 30\n      }\n    }),\n    checked: completionJSON.actions.timer,\n    className: \"completion-form-ctrl-lbl\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 19\n    }\n  }), completionJSON.actions.timer && /*#__PURE__*/React.createElement(BlmSubscriptInput, {\n    name: \"timer_duration\",\n    label: t(\"completion.timer_info\"),\n    min: 0,\n    max: 60,\n    value: completionJSON.actions.timer_duration,\n    className: \"completion-timer-duration-input\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 21\n    }\n  })))), !isPartPage && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(FormControlLabel, {\n    name: \"prerequisite_chk\",\n    label: t(\"prerequisite.title\"),\n    control: /*#__PURE__*/React.createElement(Checkbox, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 22\n      }\n    }),\n    checked: prerequisiteJSON.checked,\n    disabled: siblings.length === 0,\n    className: \"prerequisite-chk-ctrl-lbl\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 11\n    }\n  }), prerequisiteJSON.checked && /*#__PURE__*/React.createElement(FormGroup, {\n    className: \"prerequisite-form-group\",\n    onChange: handleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 13\n    }\n  }, siblings.map(element => {\n    var _prerequisiteJSON$sib;\n\n    return /*#__PURE__*/React.createElement(FormControlLabel, {\n      key: element.id,\n      name: \"siblings_chk\",\n      label: element.name,\n      control: /*#__PURE__*/React.createElement(Checkbox, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 237,\n          columnNumber: 28\n        }\n      }),\n      checked: (_prerequisiteJSON$sib = prerequisiteJSON.siblings) === null || _prerequisiteJSON$sib === void 0 ? void 0 : _prerequisiteJSON$sib.includes(element.id),\n      value: element.id,\n      className: \"prerequisite-form-ctrl-lbl\",\n      onChange: handleChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 17\n      }\n    });\n  }))));\n}\n\nexport default BlmCompletionPrerequisiteProps;","map":{"version":3,"sources":["C:/Users/Rajesh/Downloads/bilim (2)/bilim/v1.0/editors/BlmCourseEditor/src/components/properties/controls/completion-prerequisite/BlmCompletionPrerequisiteProps.tsx"],"names":["React","Fragment","useMemo","clsx","RadioGroup","FormGroup","FormControlLabel","Checkbox","Radio","useTranslation","CompletionType","ElementType","getPreviousElements","BlmSubscriptInput","BlmCompletionPrerequisiteProps","props","type","course","element","data","onChange","isCompletion","crsCompletion","completion","crsNavigation","navigation","completionJSON","prerequisite","prerequisiteJSON","siblings","isPartPage","PartPage","t","None","actions","ids","map","id","checked","length","filter","includes","updateChange","newData","handleChange","event","target","value","name","newSiblings","ind","indexOf","push","splice","hasOwnProperty","ScreenDisplayed","ScreenUndisplayed","ByAction","all_button_clicked","video_complete","sound_complete","animation_complete","interaction_complete","timer","timer_duration"],"mappings":"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","sourcesContent":["import React, { ChangeEvent, Fragment, useMemo } from \"react\";\r\nimport clsx from \"clsx\";\r\nimport { RadioGroup, FormGroup, FormControlLabel, Checkbox, Radio } from \"@material-ui/core\";\r\nimport { useTranslation } from \"react-i18next\";\r\n\r\nimport {\r\n  CompletionProps,\r\n  CourseElement,\r\n  CourseElementProps,\r\n  ElementPropsComponent,\r\n  PrerequisiteProps,\r\n} from \"types\";\r\nimport { CompletionType, ElementType } from \"editor-constants\";\r\nimport { getPreviousElements } from \"utils\";\r\nimport { BlmSubscriptInput, SubscriptInputChangeEvent } from \"shared\";\r\nimport { ContainerProps } from \"./container\";\r\nimport \"./styles.scss\";\r\n\r\nexport interface CompProps extends ElementPropsComponent, ContainerProps {\r\n  element: CourseElement;\r\n  type?: \"prerequisite\";\r\n}\r\n\r\nfunction BlmCompletionPrerequisiteProps(props: CompProps) {\r\n  const { type, course, element, data, onChange } = props;\r\n  const { isCompletion } = data;\r\n  const crsCompletion = course?.completion;\r\n  const crsNavigation = course?.navigation;\r\n  const completion = data.completionJSON!;\r\n  const prerequisite = data.prerequisiteJSON!;\r\n  const siblings = useMemo(() => getPreviousElements(element), [element]);\r\n  const isPartPage = element.type === ElementType.PartPage;\r\n  const { t } = useTranslation(\"properties\");\r\n\r\n  const completionJSON: CompletionProps = useMemo(() => {\r\n    if (completion.completion === CompletionType.None && crsCompletion?.completion) {\r\n      return {\r\n        ...completion,\r\n        completion: crsCompletion.completion,\r\n        actions: {\r\n          ...completion.actions,\r\n          ...crsCompletion.actions,\r\n        },\r\n      };\r\n    }\r\n\r\n    return completion;\r\n  }, [crsCompletion, completion]);\r\n\r\n  const prerequisiteJSON: PrerequisiteProps = useMemo(() => {\r\n    const ids = siblings.map((element) => element.id);\r\n\r\n    return {\r\n      ...prerequisite,\r\n      checked: siblings.length > 0 && prerequisite.checked,\r\n      siblings:\r\n        !prerequisite.siblings && crsNavigation?.prerequisite && ids.length\r\n          ? [ids[ids.length - 1]]\r\n          : prerequisite.siblings?.filter((id) => ids.includes(id)) || [],\r\n    };\r\n  }, [crsNavigation, prerequisite, siblings]);\r\n\r\n  const updateChange = (newData: CourseElementProps) => {\r\n    if (onChange) {\r\n      onChange(newData);\r\n    }\r\n  };\r\n\r\n  const handleChange = (event: ChangeEvent<{}> | SubscriptInputChangeEvent) => {\r\n    const target = event.target as HTMLInputElement;\r\n    const value = target.type === \"checkbox\" ? target.checked : target.value;\r\n    const name = target.name;\r\n    const newData: CourseElementProps = {\r\n      ...data,\r\n      completionJSON,\r\n      prerequisiteJSON,\r\n    };\r\n\r\n    if (name === \"completion-chk\") {\r\n      newData.isCompletion = value as boolean;\r\n    } else if (name === \"prerequisite_chk\") {\r\n      newData.prerequisiteJSON = { ...prerequisiteJSON, checked: value as boolean };\r\n    } else if (name === \"siblings_chk\") {\r\n      const id = target.value;\r\n      const newSiblings = [...(prerequisiteJSON.siblings || [])];\r\n      const ind = newSiblings.indexOf(id);\r\n\r\n      if (value && ind === -1) {\r\n        newSiblings.push(id);\r\n      } else if (!value && ind !== -1) {\r\n        newSiblings.splice(ind, 1);\r\n      }\r\n\r\n      newData.prerequisiteJSON = { ...prerequisiteJSON, siblings: newSiblings };\r\n    } else if (completionJSON.actions.hasOwnProperty(name)) {\r\n      newData.completionJSON = {\r\n        ...completionJSON,\r\n        actions: {\r\n          ...completionJSON.actions,\r\n          [name]: value,\r\n        },\r\n      };\r\n    } else {\r\n      newData.completionJSON = {\r\n        ...completionJSON,\r\n        [name]: value,\r\n      };\r\n    }\r\n\r\n    updateChange(newData);\r\n  };\r\n\r\n  return (\r\n    <div className={clsx(\"completion-prerequisite-props-container\", type)}>\r\n      {type !== \"prerequisite\" && (\r\n        <Fragment>\r\n          <FormControlLabel\r\n            name=\"completion-chk\"\r\n            label={t(\"completion.title\")}\r\n            control={<Checkbox />}\r\n            checked={isCompletion}\r\n            className=\"completion-chk-ctrl-lbl\"\r\n            onChange={handleChange}\r\n          />\r\n          {isCompletion && (\r\n            <Fragment>\r\n              <RadioGroup\r\n                name=\"completion\"\r\n                value={completionJSON.completion}\r\n                className=\"completion-radio-group\"\r\n                onChange={handleChange}\r\n              >\r\n                <FormControlLabel\r\n                  label={t(\"completion.screen_displayed\")}\r\n                  control={<Radio />}\r\n                  value={CompletionType.ScreenDisplayed}\r\n                  className=\"completion-form-ctrl-lbl\"\r\n                />\r\n                <FormControlLabel\r\n                  label={t(\"completion.screen_undisplayed\")}\r\n                  control={<Radio />}\r\n                  value={CompletionType.ScreenUndisplayed}\r\n                  className=\"completion-form-ctrl-lbl\"\r\n                />\r\n                <FormControlLabel\r\n                  label={t(\"completion.action\")}\r\n                  control={<Radio />}\r\n                  value={CompletionType.ByAction}\r\n                  className=\"completion-form-ctrl-lbl\"\r\n                />\r\n              </RadioGroup>\r\n              {completionJSON.completion === CompletionType.ByAction && (\r\n                <FormGroup className=\"completion-form-group\">\r\n                  <FormControlLabel\r\n                    name=\"all_button_clicked\"\r\n                    label={t(\"completion.all_button\")}\r\n                    control={<Checkbox />}\r\n                    checked={completionJSON.actions.all_button_clicked}\r\n                    className=\"completion-form-ctrl-lbl\"\r\n                    onChange={handleChange}\r\n                  />\r\n                  <FormControlLabel\r\n                    name=\"video_complete\"\r\n                    label={t(\"completion.video_complete\")}\r\n                    control={<Checkbox />}\r\n                    checked={completionJSON.actions.video_complete}\r\n                    className=\"completion-form-ctrl-lbl\"\r\n                    onChange={handleChange}\r\n                  />\r\n                  <FormControlLabel\r\n                    name=\"sound_complete\"\r\n                    label={t(\"completion.sound_complete\")}\r\n                    control={<Checkbox />}\r\n                    checked={completionJSON.actions.sound_complete}\r\n                    className=\"completion-form-ctrl-lbl\"\r\n                    onChange={handleChange}\r\n                  />\r\n                  <FormControlLabel\r\n                    name=\"animation_complete\"\r\n                    label={t(\"completion.animation_complete\")}\r\n                    control={<Checkbox />}\r\n                    checked={completionJSON.actions.animation_complete}\r\n                    className=\"completion-form-ctrl-lbl\"\r\n                    onChange={handleChange}\r\n                  />\r\n                  <FormControlLabel\r\n                    name=\"interaction_complete\"\r\n                    label={t(\"completion.interaction_complete\")}\r\n                    control={<Checkbox />}\r\n                    checked={completionJSON.actions.interaction_complete}\r\n                    className=\"completion-form-ctrl-lbl\"\r\n                    onChange={handleChange}\r\n                  />\r\n                  <FormControlLabel\r\n                    name=\"timer\"\r\n                    label={t(\"completion.timer\")}\r\n                    control={<Checkbox />}\r\n                    checked={completionJSON.actions.timer}\r\n                    className=\"completion-form-ctrl-lbl\"\r\n                    onChange={handleChange}\r\n                  />\r\n                  {completionJSON.actions.timer && (\r\n                    <BlmSubscriptInput\r\n                      name=\"timer_duration\"\r\n                      label={t(\"completion.timer_info\")}\r\n                      min={0}\r\n                      max={60}\r\n                      value={completionJSON.actions.timer_duration}\r\n                      className=\"completion-timer-duration-input\"\r\n                      onChange={handleChange}\r\n                    />\r\n                  )}\r\n                </FormGroup>\r\n              )}\r\n            </Fragment>\r\n          )}\r\n        </Fragment>\r\n      )}\r\n      {!isPartPage && (\r\n        <>\r\n          <FormControlLabel\r\n            name=\"prerequisite_chk\"\r\n            label={t(\"prerequisite.title\")}\r\n            control={<Checkbox />}\r\n            checked={prerequisiteJSON.checked}\r\n            disabled={siblings.length === 0}\r\n            className=\"prerequisite-chk-ctrl-lbl\"\r\n            onChange={handleChange}\r\n          />\r\n          {prerequisiteJSON.checked && (\r\n            <FormGroup className=\"prerequisite-form-group\" onChange={handleChange}>\r\n              {siblings.map((element) => (\r\n                <FormControlLabel\r\n                  key={element.id}\r\n                  name=\"siblings_chk\"\r\n                  label={element.name}\r\n                  control={<Checkbox />}\r\n                  checked={prerequisiteJSON.siblings?.includes(element.id)}\r\n                  value={element.id}\r\n                  className=\"prerequisite-form-ctrl-lbl\"\r\n                  onChange={handleChange}\r\n                />\r\n              ))}\r\n            </FormGroup>\r\n          )}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default BlmCompletionPrerequisiteProps;\r\n"]},"metadata":{},"sourceType":"module"}